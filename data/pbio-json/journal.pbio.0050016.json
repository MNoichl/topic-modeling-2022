{
  "schema": "https://data.sciveyor.com/schema",
  "version": 5,
  "id": "doi:10.1371/journal.pbio.0050016",
  "doi": "10.1371/journal.pbio.0050016",
  "externalIds": [
    "pii:06-PLBI-RA-0500R3",
    "sici:plbi-05-03-23",
    "pmid:17355171",
    "pmcid:PMC1821046"
  ],
  "license": "This is an open-access article distributed under the terms\n        of the Creative Commons Attribution License, which permits unrestricted use, distribution,\n        and reproduction in any medium, provided the original author and source are\n        credited.",
  "licenseUrl": "https://creativecommons.org/licenses/by/4.0/",
  "dataSource": "Public Library of Science",
  "dataSourceUrl": "https://data.sciveyor.com/source/plos",
  "dataSourceVersion": 1,
  "type": "article",
  "title": "The Sorcerer II Global Ocean Sampling Expedition: Expanding\n          the Universe of Protein Families",
  "authors": [
    {
      "name": "Shibu Yooseph",
      "first": "Shibu",
      "last": "Yooseph",
      "affiliation": "J. Craig Venter Institute, Rockville, Maryland, United States of America"
    },
    {
      "name": "Granger Sutton",
      "first": "Granger",
      "last": "Sutton",
      "affiliation": "J. Craig Venter Institute, Rockville, Maryland, United States of America"
    },
    {
      "name": "Douglas B Rusch",
      "first": "Douglas B",
      "last": "Rusch",
      "affiliation": "J. Craig Venter Institute, Rockville, Maryland, United States of America"
    },
    {
      "name": "Aaron L Halpern",
      "first": "Aaron L",
      "last": "Halpern",
      "affiliation": "J. Craig Venter Institute, Rockville, Maryland, United States of America"
    },
    {
      "name": "Shannon J Williamson",
      "first": "Shannon J",
      "last": "Williamson",
      "affiliation": "J. Craig Venter Institute, Rockville, Maryland, United States of America"
    },
    {
      "name": "Karin Remington",
      "first": "Karin",
      "last": "Remington",
      "affiliation": "J. Craig Venter Institute, Rockville, Maryland, United States of America"
    },
    {
      "name": "Jonathan A Eisen",
      "first": "Jonathan A",
      "last": "Eisen",
      "affiliation": "J. Craig Venter Institute, Rockville, Maryland, United States of America; University of California, Davis, California, United States of America"
    },
    {
      "name": "Karla B Heidelberg",
      "first": "Karla B",
      "last": "Heidelberg",
      "affiliation": "J. Craig Venter Institute, Rockville, Maryland, United States of America"
    },
    {
      "name": "Gerard Manning",
      "first": "Gerard",
      "last": "Manning",
      "affiliation": "Razavi-Newman Center for Bioinformatics, Salk Institute for Biological Studies,\n          La Jolla, California, United States of America"
    },
    {
      "name": "Weizhong Li",
      "first": "Weizhong",
      "last": "Li",
      "affiliation": "Burnham Institute for Medical Research, La Jolla, California, United States of\n          America"
    },
    {
      "name": "Lukasz Jaroszewski",
      "first": "Lukasz",
      "last": "Jaroszewski",
      "affiliation": "Burnham Institute for Medical Research, La Jolla, California, United States of\n          America"
    },
    {
      "name": "Piotr Cieplak",
      "first": "Piotr",
      "last": "Cieplak",
      "affiliation": "Burnham Institute for Medical Research, La Jolla, California, United States of\n          America"
    },
    {
      "name": "Christopher S Miller",
      "first": "Christopher S",
      "last": "Miller",
      "affiliation": "University of California Los Angeles–Department of\n        Energy Institute for Genomics and Proteomics, Los Angeles, California, United States of\n        America"
    },
    {
      "name": "Huiying Li",
      "first": "Huiying",
      "last": "Li",
      "affiliation": "University of California Los Angeles–Department of\n        Energy Institute for Genomics and Proteomics, Los Angeles, California, United States of\n        America"
    },
    {
      "name": "Susan T Mashiyama",
      "first": "Susan T",
      "last": "Mashiyama",
      "affiliation": "University of California Berkeley, Berkeley, California, United States of\n          America"
    },
    {
      "name": "Marcin P Joachimiak",
      "first": "Marcin P",
      "last": "Joachimiak",
      "affiliation": "University of California Berkeley, Berkeley, California, United States of\n          America"
    },
    {
      "name": "Christopher van Belle",
      "first": "Christopher",
      "last": "van Belle",
      "affiliation": "University of California Berkeley, Berkeley, California, United States of\n          America"
    },
    {
      "name": "John-Marc Chandonia",
      "first": "John-Marc",
      "last": "Chandonia",
      "affiliation": "University of California Berkeley, Berkeley, California, United States of\n          America; Physical Biosciences Division, Lawrence Berkeley National Laboratory, Berkeley,\n          California, United States of America"
    },
    {
      "name": "David A Soergel",
      "first": "David A",
      "last": "Soergel",
      "affiliation": "University of California Berkeley, Berkeley, California, United States of\n          America"
    },
    {
      "name": "Yufeng Zhai",
      "first": "Yufeng",
      "last": "Zhai",
      "affiliation": "Razavi-Newman Center for Bioinformatics, Salk Institute for Biological Studies,\n          La Jolla, California, United States of America"
    },
    {
      "name": "Kannan Natarajan",
      "first": "Kannan",
      "last": "Natarajan",
      "affiliation": "University of California San Diego, San Diego, California, United States of\n          America"
    },
    {
      "name": "Shaun Lee",
      "first": "Shaun",
      "last": "Lee",
      "affiliation": "University of California San Diego, San Diego, California, United States of\n          America"
    },
    {
      "name": "Benjamin J Raphael",
      "first": "Benjamin J",
      "last": "Raphael",
      "affiliation": "Brown University, Providence, Rhode Island, United States of America"
    },
    {
      "name": "Vineet Bafna",
      "first": "Vineet",
      "last": "Bafna",
      "affiliation": "University of California San Diego, San Diego, California, United States of\n          America"
    },
    {
      "name": "Robert Friedman",
      "first": "Robert",
      "last": "Friedman",
      "affiliation": "J. Craig Venter Institute, Rockville, Maryland, United States of America"
    },
    {
      "name": "Steven E Brenner",
      "first": "Steven E",
      "last": "Brenner",
      "affiliation": "University of California Berkeley, Berkeley, California, United States of\n          America"
    },
    {
      "name": "Adam Godzik",
      "first": "Adam",
      "last": "Godzik",
      "affiliation": "Burnham Institute for Medical Research, La Jolla, California, United States of\n          America"
    },
    {
      "name": "David Eisenberg",
      "first": "David",
      "last": "Eisenberg",
      "affiliation": "University of California Los Angeles–Department of\n        Energy Institute for Genomics and Proteomics, Los Angeles, California, United States of\n        America"
    },
    {
      "name": "Jack E Dixon",
      "first": "Jack E",
      "last": "Dixon",
      "affiliation": "University of California San Diego, San Diego, California, United States of\n          America"
    },
    {
      "name": "Susan S Taylor",
      "first": "Susan S",
      "last": "Taylor",
      "affiliation": "University of California San Diego, San Diego, California, United States of\n          America"
    },
    {
      "name": "Robert L Strausberg",
      "first": "Robert L",
      "last": "Strausberg",
      "affiliation": "J. Craig Venter Institute, Rockville, Maryland, United States of America"
    },
    {
      "name": "Marvin Frazier",
      "first": "Marvin",
      "last": "Frazier",
      "affiliation": "J. Craig Venter Institute, Rockville, Maryland, United States of America"
    },
    {
      "name": "J. Craig Venter",
      "first": "J. Craig",
      "last": "Venter",
      "affiliation": "J. Craig Venter Institute, Rockville, Maryland, United States of America"
    }
  ],
  "journal": "PLoS Biology",
  "date": "2007-03",
  "dateElectronic": "2007-03-13",
  "dateAccepted": "2006-08-15",
  "dateReceived": "2006-03-24",
  "volume": "5",
  "number": "3",
  "pages": "e16",
  "tags": [
    "Discipline/Computational Biology",
    "Discipline/Evolutionary Biology",
    "Discipline/Genetics and Genomics",
    "Discipline/Molecular Biology",
    "System Taxonomy/Eubacteria",
    "System Taxonomy/Viruses",
    "Type/Research Article"
  ],
  "abstract": "Metagenomics projects based on shotgun sequencing of populations of micro-organisms yield\n          insight into protein families. We used sequence similarity clustering to explore proteins\n          with a comprehensive dataset consisting of sequences from available databases together\n          with 6.12 million proteins predicted from an assembly of 7.7 million Global Ocean Sampling\n          (GOS) sequences. The GOS dataset covers nearly all known prokaryotic protein families. A\n          total of 3,995 medium- and large-sized clusters consisting of only GOS sequences are\n          identified, out of which 1,700 have no detectable homology to known families. The GOS-only\n          clusters contain a higher than expected proportion of sequences of viral origin, thus\n          reflecting a poor sampling of viral diversity until now. Protein domain distributions in\n          the GOS dataset and current protein databases show distinct biases. Several protein\n          domains that were previously categorized as kingdom specific are shown to have GOS\n          examples in other kingdoms. About 6,000 sequences (ORFans) from the literature that\n          heretofore lacked similarity to known proteins have matches in the GOS data. The GOS\n          dataset is also used to improve remote homology detection. Overall, besides nearly\n          doubling the number of current proteins, the predicted GOS proteins also add a great deal\n          of diversity to known protein families and shed light on their evolution. These\n          observations are illustrated using several protein families, including phosphatases,\n          proteases, ultraviolet-irradiation DNA damage repair enzymes, glutamine synthetase, and\n          RuBisCO. The diversity added by GOS data has implications for choosing targets for\n          experimental structure characterization as part of structural genomics efforts. Our\n          analysis indicates that new families are being discovered at a rate that is linear or\n          almost linear with the addition of new sequences, implying that we are still far from\n          discovering all protein families in nature.",
  "fullText": "Introduction\n      \nDespite many efforts to classify and organize proteins [1–6]\n        from both structural and functional perspectives, we are far from a clear understanding of\n        the size and diversity of the protein universe [7–9].\n        Environmental shotgun sequencing projects, in which genetic sequences are sampled from\n        communities of microorganisms [10–14], are poised to make a dramatic impact\n        on our understanding of proteins and protein families. These studies are not limited to\n        culturable organisms, and there are no selection biases for protein classes or organisms.\n        These studies typically provide a gene-centric (as opposed to an organism-centric) view of\n        the environment and allow the examination of questions related to protein family evolution\n        and diversity. The protein predictions from some of these studies are characterized both by\n        their sheer number and diversity. For instance, the recent Sargasso Sea study [10] resulted in 1.2 million protein\n        predictions and identified new subfamilies for several known protein families.\n\nProtein exploration starts by clustering proteins into groups or families\n        of evolutionarily related sequences. The notion of a protein family, while biologically very\n        relevant, is hard to realize precisely in mathematical terms, thereby making the large-scale\n        computational clustering and classification problem nontrivial. Techniques for these\n        problems typically rely on sequence similarity to group sequences. Proteins\n        can be grouped into families based on the highly conserved structural units, called\n          domains, that they contain [15,16]. Alternatively,\n        proteins are grouped into families based on their full sequence [17,18]. Many of these classifications, together with various expert-curated databases\n          [19] such as Swiss-Prot [20], Pfam [15,21], and TIGRFAM [22,23], or integrated efforts such as Uniprot\n          [24] and InterPro [25], provide rich resources for protein\n        annotation. However, a vast number of protein predictions remain unclassified both in terms\n        of structure and function. Given varying rates of evolution, there is unlikely to be a\n        single similarity threshold or even a small set of thresholds that can be used to define\n        every protein family in nature. Consequently, estimates of the number of families that exist\n        in nature vary considerably based on the different thresholds used and assumptions made in\n        the classification process [26–29].\n\nIn this study, we explored proteins using a comprehensive dataset of publicly available\n        sequences together with environmental sequence data generated by the Sorcerer\n          II Global Ocean Sampling (GOS) expedition [30]. We used a novel clustering technique based on\n        full-length sequence similarity both to predict proteins and to group related sequences. The\n        goals were to understand the rate of discovery of protein families with the increasing\n        number of protein predictions, explore novel families, and assess the impact of the\n        environmental sequences from the expedition on known proteins and protein families. We used\n        hidden Markov model (HMM) profiling to examine the relative biases in protein domain\n        distributions in the GOS data and existing protein databases. This profiling was also used\n        to assess the impact of the GOS data on target selection for protein structure\n        characterization efforts. We carried out in-depth analyses on several protein families to\n        validate our clustering approach and to understand the diversity and evolutionary\n        information that the GOS data added; the families included ultraviolet (UV) irradiation DNA\n        damage repair enzymes, phosphatases, proteases, and the metabolic enzymes glutamine\n        synthetase and RuBisCO.\n\n      Results/Discussion\n      \n        Data Generation, Sequence Clustering, and HMM Profiling\n        \nWe used the following publicly available datasets in this study (Table 1)—the National Center for Biotechnology\n          Information (NCBI)'s nonredundant protein database (NCBI-nr) [31,32], NCBI Prokaryotic Genomes (PG) [31,33], TIGR Gene Indices (TGI-EST) [34], and Ensembl (ENS) [35,36]. The rationale for\n          including these datasets is discussed in Materials and\n            Methods. All datasets were downloaded on February 10, 2005.\n\nNone of the above-mentioned databases contained sequences from the Sargasso Sea study\n            [10], the largest environmental\n          survey to date, and so we pooled reads from the Sargasso Sea study with the reads from the\n            Sorcerer II GOS expedition [30], creating a combined set that we call the GOS\n          dataset. The GOS dataset was assembled using the Celera Assembler [37] as described in [30] (see Materials and\n            Methods). The GOS dataset was primarily generated from the 0.1 μm to 0.8 μm size\n          filters and thus is expected to be mostly microbial [30]. The data also included a small set of sequences from\n          a viral size (&lt;0.1 μm) fraction (Table 1).\n\nWe identified open reading frames (ORFs) from the DNA sequences in the PG, TGI-EST, and\n          GOS datasets. An ORF is commonly defined as a translated DNA sequence that begins with a\n          start codon and ends with a stop codon. To accommodate partial DNA sequences, we extended\n          this definition to allow an ORF to be bracketed by either a start codon or the start of\n          the DNA sequence, and by either a stop codon or the end of the DNA sequence. ORFs were\n          generated by considering translations of the DNA sequence in all six frames. For ORFs from\n          the PG and TGI-EST datasets, we used the appropriate codon usage table for the known\n          organism. For GOS ORFs from the assembled sequences, we used translation table 11 (the\n          code for bacteria, archaea, and prokaryotic viruses) [31]. We did not include alternate codon translations in\n          this analysis. For all datasets, only ORFs containing at least 60 amino acids (aa) were\n          considered. Not all ORFs are proteins. In this paper, ORFs that have reasonable evidence\n          for being proteins are called predicted proteins; other ORFs are called\n            spurious ORFs.\n\nIn summary, the total input data for this study (Table 1) consisted of 28,610,994 sequences from NCBI-nr,\n          PG, TGI-EST, ENS, and GOS. All data and analysis results will be made publicly available\n          (see Materials and Methods).\n\nWe used a sequence similarity clustering to group related sequences and subsequently\n          predicted proteins from this grouping. This approach of protein prediction was adopted for\n          two reasons. First, the GOS data make up a major portion of the dataset being analyzed,\n          and a large fraction of GOS ORFs are fragmentary sequences. Traditional annotation\n          pipelines/gene finders, which presume complete or near-complete genomic data, perform\n          unsatisfactorily on this type of data. Second, protein prediction based on the comparison\n          of ORFs to known protein sequences imposes limits on the protein families that can be\n          explored. In particular, novel proteins that belong to known families will not be detected\n          if they are sufficiently distant from known members of that family. This is the case even\n          though there may be other novel proteins that can transitively link them to the known\n          proteins. Similarly, truly novel protein families will also not be detected.\n\nAs the primary input to our clustering process, we computed the pairwise sequence\n          similarity of the 28.6 million aa sequences in our dataset using an all-against-all BLAST\n          search [38]. This required more than\n          1 million CPU hours on two large compute clusters (see Materials and Methods). The sequences were clustered in four steps (see Materials and Methods). In the first step, we identified\n          a nonredundant set of sequences from the entire dataset using only pairwise matches with\n          ≥98% similarity and involving ≥95% of the length of the shorter sequence. This step served\n          the dual role of identifying highly conserved groups of sequences (where each group was\n          represented by a nonredundant sequence) and removing redundancy in the\n          dataset due to identical and near-identical sequences. Only nonredundant sequences were\n          considered for further steps in our clustering procedure. In the second step, we\n          identified core sets of similar sequences using only matches between two\n          sequences involving ≥80% of the length of the longer sequence. We used a graph-theoretic\n          procedure to identify dense subgraphs (the core sets) within a graph defined by these\n          matches. While the match parameters we used in this step were more relaxed than those in\n          the first step, we chose them to reduce the grouping of unrelated sequences while\n          simultaneously reducing the unnecessary splitting of families. In the third step, these\n          core sets were transformed into profiles, and we used a profile–profile method [39] to merge related core sets into\n          larger groups. In the final step, we recruited sequences to core sets using\n          sequence-profile matching (PSI-BLAST [40]) and BLAST matches to core set members. We required the match to involve\n          ≥60% of the length of the sequence being recruited.\n\nWe identified and removed clusters containing likely spurious ORFs using two filters (see\n            Materials and Methods). The first filter identified\n          clusters containing shadow ORFs. The second filter identified clusters containing\n          conserved but noncoding sequences, as indicated by a lack of selection at the codon level.\n          Only clusters that remained after the two filtering steps and contained at least two\n          nonredundant sequences are reported in this analysis.\n\nWe examined the distribution of known protein domains in the full dataset using profile\n          HMMs [41] from the Pfam [15] and TIGRFAM [22] databases (see Materials and Methods).\n\nWe labeled sequences that end up in clusters (containing at least two nonredundant\n          sequences) or that have HMM matches as predicted proteins. The inclusion\n          of the PG ORF set allowed for the evaluation of protein prediction using our clustering\n          approach. A comparison of proteins predicted in the PG ORF set by our clustering against\n          PG ORFs annotated as proteins by whole-genome annotation techniques revealed that our\n          protein prediction method via clustering has a sensitivity of 83% and a specificity of 86%\n          (see Materials and Methods). The HMM profiling\n          allowed for the evaluation of our clustering technique's grouping of sequences. We used\n          Pfam models in two different ways for this assessment (see Materials and Methods) and make three observations. First, using a simple Pfam\n          domain architecture-based evaluation, these clusters are mostly consistent as reflected by\n          93% of clusters having less than 2% unrelated pairs of sequences in them. Second, these\n          clusters are quite conservative and can split domain families, with 58% of domain\n          architectures being confined to single clusters and 88% of domain architectures having\n          more than half of their occurrences in a single cluster. Third, the size distribution of\n          these clusters is quite similar to the size distribution of clusters induced by Pfams.\n\n        Protein Prediction\n        \nOf the initial 28,610,944 sequences, we labeled 9,978,637 sequences (35%) as predicted\n          proteins based on the clustering, of which nearly 60% are from GOS (Table 2). The HMM profiling labeled only an additional\n          226,743 (0.8%) sequences as predicted proteins, for a total of 10,205,380 predicted\n          proteins. This indicates that our clustering method captures most of the sequences found\n          by profile HMMs. For sequences both in clusters and with HMM matches, (on average) 73.5%\n          of their length is covered by HMM matches. For sequences not in clusters but with HMM\n          matches, this value is only 45.3%. Furthermore, while 64% of sequences in clusters have\n          HMM matches, there are 3,550,901 sequences that are grouped into clusters but do not have\n          HMM matches. Most of these clusters correspond either to families lacking profile HMMs or\n          contain sequences that are too remote to match above the cutoffs used. The latter is an\n          indication of the diversity added to known families that is not picked up by current\n          profile HMMs.\n\nUsing our method, the predicted proteins constitute different fractions of the totals for\n          the five datasets, with 87% for NCBI-nr, nearly 20% for both PG ORFs and TGI-EST ORFs, 92%\n          for ENS, and 35% for GOS. The high rate of prediction for ENS is a reflection of the high\n          degree of conservation of proteins across the metazoan genomes, whereas the prediction\n          rates for PG ORFs and TGI-EST ORFs are similar to rates seen in other protein prediction\n          approaches. The 13% of NCBI-nr sequences that we marked as spurious may constitute\n          contaminants in the form of false predictions or organism-specific proteins. Nearly\n          two-thirds of these sequences are labeled “hypotheticals,” “unnamed,” or “unknown.” This\n          is more than twice the fraction of similarly labeled sequences (30%) in the full NCBI-nr\n          dataset. Of the remaining one-third, half of them are less than 100 aa in length. This\n          suggests that they are either fast-evolving short peptides, spurious predictions, or\n          proteins that failed to meet the length-based thresholds in the clustering.\n\nBased on the clustering and the HMM profiling, there is evidence for 6,123,395 proteins\n          in the GOS dataset (Table 2). Given\n          the fragmentary nature of the GOS ORFs (as a result of the GOS assembly [10,30]), it is not surprising that the average length of a\n          GOS-predicted protein (199 aa) is smaller than the average length of predicted proteins in\n          NCBI-nr (359 aa), PG ORFs (325 aa), TGI-EST ORFs (207 aa), and ENS (489 aa). The ratio of\n          clustered ORFs to total ORFs is significantly higher for the GOS ORFs (34%) compared to PG\n          ORFs (19%). This could be due to a large number of false-positive protein predictions in\n          the GOS dataset. However, this is unlikely for a variety of reasons. Nearly 4.64 million\n          GOS ORFs (26.6%) have significant BLAST matches (with an E-value ≤1 ×\n            10−10) to NCBI-nr sequences. The PG ORFs do not have a high false-positive\n          rate compared to the submitted annotation for the prokaryotic genomes (see Materials and Methods). Most importantly, based on the\n          fragmentary nature of GOS sequencing compared to PG sequencing, the number of shadow\n          (spurious) ORFs ≥60 aa is significantly reduced (see Materials and Methods).\n\nSome pairs of GOS-predicted proteins that belong to the same cluster are adjacent in the\n          GOS assembly. While some of them correspond to tandem duplicate genes, an overwhelming\n          fraction of the pairs are on mini-scaffolds [10], indicating that they are potentially pieces of the same protein (from the\n          same clone) that we split into fragments. We estimate that this effect applies to 3% of\n          GOS-predicted proteins. Sequencing errors and the use of the wrong translation table can\n          also result in the ORF generation process producing split ORF fragments.\n\nThe combined set of predicted proteins in NCBI-nr, PG, TGI-EST, and ENS, as expected, has\n          a lot of redundancy. For instance, most of the PG protein predictions are in NCBI-nr.\n          Removing exact substrings of longer sequences (i.e., 100% identity) reduces this combined\n          set to 3,167,979 predicted proteins. When we perform the same filtering on the GOS\n          dataset, 5,654,638 predicted proteins remain. Thus, the GOS-predicted protein set is 1.8\n          times the size of the predicted protein set from current publicly available datasets. We\n          used a simple BLAST based scheme to assign kingdoms for the GOS sequences (see Materials and Methods). Of the sequences that we could\n          annotate by kingdom, 63% of the sequences in the public datasets are from the eukaryotic\n          kingdom, and 90.8% of the sequences in the GOS set are from the bacterial kingdom (Figure 1).\n\n        Protein Clustering\n        \nThe 9,978,637 protein sequences predicted by our clustering method are grouped into\n          297,254 clusters of size two or more, where size of a cluster is defined\n          to be the number of nonredundant sequences in the cluster. There are 280,187 small\n          clusters (size &lt; 20), 12,992 medium clusters (size between 20 and 200), and 4,075\n          large clusters (size &gt; 200). While the 17,067 medium- and large-sized clusters\n          constitute only 6% of the total number of clusters, they account for 85% of all the\n          sequences that are clustered (Table\n            3). Many of the largest clusters correspond to families that have functionally\n          diversified and expanded (Table 4).\n          While some large families, such as the HIV envelope glycoprotein family and the\n          immunoglobulins, also reflect biases in sequence databases, many more, including ABC\n          transporters, kinases, and short-chain dehydrogenases, reflect their expected abundance in\n          nature.\n\n        Rate of Discovery of Protein Families\n        \nWe examined the rate of discovery of protein families using our clustering method to\n          determine whether our sampling of the protein universe is reaching saturation. We find\n          that for the present number of sequences there is an approximately linear trend in the\n          rate of discovery of clusters with the addition of new (i.e., nonredundant) sequences\n            (Figure 2). Moreover, the observed\n          distribution of cluster sizes is well approximated by a power law [42,43], and this observed power law can be used to predict the rate of growth of\n          the number of clusters of a given size (see Materials and\n            Methods). This rate is dependent on the value of the power law exponent and\n          decreases with increasing cluster sizes. We find good agreement between the observed and\n          predicted growth rates for different cluster sizes. The approximately linear relationship\n          between the number of clusters and the number of protein sequences indicates that there\n          are likely many more protein families (either novel or subfamilies distantly related to\n          known families) remaining to be discovered.\n\n        GOS versus Known Prokaryotic versus Known Nonprokaryotic\n        \nWe also examined the GOS coverage of known proteins and protein families. Based on the\n          cell-size filtering performed while collecting the GOS samples, we expected that the\n          sample would predominantly be a size-limited subset of prokaryotic organisms [30]. We studied the content of the 17,067\n          medium- and large-sized clusters across three groupings: (1) GOS, (2) known prokaryotic\n          (PG together with bacterial and archaeal portions of NCBI-nr), and (3) known\n          nonprokaryotic (TGI-EST and ENS together with viral and eukaryotic portions of NCBI-nr).\n          The Venn diagram in Figure 3 shows the\n          breakdown of these clusters by content (see Materials and\n            Methods). The largest section contains GOS-only clusters (23.40%) emphasizing the\n          significant novelty provided by the GOS data. The next section consists of clusters\n          containing sequences from only the known nonprokaryotic grouping (20.78%), followed\n          closely by the section containing clusters with sequences from all three groupings\n          (20.23%). The large known nonprokaryotic–only grouping shows that our current GOS sampling\n          methodology will not cover all protein families, and perhaps misses some protein families\n          that are exclusive to higher eukaryotes. The large section of clusters that include all\n          three groupings indicates a large core of well-conserved protein families across all\n          domains of life. In contrast, the known prokaryotic protein families are almost entirely\n          covered by the GOS data.\n\n        Novelty Added by GOS Data\n        \nThere are 3,995 medium and large clusters that contain only sequences from the GOS\n          dataset. Some are divergent members of known families that failed to be merged by the\n          clustering parameters used, or are too divergent to be detected by any current homology\n          detection methods. The remaining clusters are completely novel families. In exploring the\n          3,995 GOS-only clusters, 44.9% of them contain sequences that have HMM matches, or BLAST\n          matches to sequences in a more recent snapshot of NCBI-nr (downloaded in August 2005) than\n          was used in this study. The recent NCBI-nr matches include phage sequences from\n          cyanophages (P-SSM2 and P-SSM4) [44]\n          and sequences from the SAR-11 genome (Candidatus pelagibacter ubique\n          HTCC1062) [45]. We used\n          profile–profile searches [39] to show\n          that an additional 12.5% of the GOS-only clusters can be linked to profiles built from\n          Protein Data Bank (PDB), COG, or Pfam. The 2,295 clusters with detected homology are\n          referred to as Group I clusters. The remaining 1,700 (42.6%) GOS-only clusters with no\n          detectable homology to known families are labeled as Group II clusters.\n\nWe applied a guilt-by-association operon method to annotate the GOS-only clusters with a\n          strategy that did not rely on direct sequence homology to known families. Function was\n          inferred for the GOS-only clusters by examining their same-strand neighbors on the\n          assembly (see Materials and Methods). Similar\n          strategies have been successfully used to infer protein function in finished microbial\n          genomes [46–48]. Despite minimal assembly of GOS reads, many\n          scaffolds and mini-scaffolds contain at least partial fragments of more than one predicted\n          ORF, thereby making this approach feasible. For 90 (5.3%) of the Group II clusters, and\n          for 214 (9.3%) of the Group I clusters, at least one Gene Ontology (GO) [49] biological process term at\n            p-value ≤0.05 can be inferred. The inferred functions and neighbors of\n          some of these GOS-only clusters are highlighted in Table 5. We observed that for Group I clusters, the\n          neighbor-inferred function is often bolstered by some information from weak homology to\n          known sequences. While neighboring clusters as a whole are of diverse function, a number\n          of GOS-only clusters seem to be next to clusters implicated in photosynthesis or electron\n          transport. These GOS-only clusters could be of viral origin, as cyanophage genomes contain\n          and express some photosynthetic genes that appear to be derived from their hosts [44,50,51]. In support of these observations, we identified five photosynthesis-related\n          clusters containing hundreds to thousands of viral sequences, including psbA, psbD, petE,\n          SpeD, and hli in the GOS data; furthermore, our nearest-neighbor analysis of these\n          sequences reveals the presence of multiple viral proteins (unpublished data).\n\nAlthough the majority of GOS-only sequences are bacterial, a higher than expected\n          proportion of the GOS-only clusters are predicted to be of viral origin, implying that\n          viral sequences and families are poorly explored relative to other microbes. To assign a\n          kingdom to the GOS-only clusters, we first inferred the kingdom of neighboring sequences\n          based on the taxonomy of the top four BLAST matches to the NCBI-nr database (see Materials and Methods). A possible kingdom was assigned\n          to the GOS-only cluster if more than 50% of assignable neighboring sequences belong to the\n          same kingdom. Viewed in this way, 11.8% of Group I clusters and 17.3% of Group II clusters\n          with at least one kingdom-assigned neighbor have more than 50% viral neighbors (Figure 4). Only 3.3% and 3.4% of random\n          samples of clusters with size distributions matching that of Group I and Group II clusters\n          have more than 50% viral neighbors, while 7.7% of all clusters pass this criterion. A\n          total of 547 GOS-only clusters contain sequences collected from the viral size fraction\n          included in the GOS dataset. For these clusters, 38.9% of the Group I subset and 27.5% of\n          the Group II subset with one or more kingdom-assigned neighbors would be inferred as\n          viral, based on the conservative criteria of having more than 50% viral assignable\n          neighbors. Several alternative kingdom assignment methods were tried (see Materials and Methods) and provide for a similar\n          conclusion.\n\nThe GOS-only clusters also tend to be more AT-rich than sequences from a random\n          size-matched sample of clusters (35.9% ± 8% GC content for Group II clusters versus 49.5%\n          ± 11% GC content for sample). Phage genomes with a Prochlorococcus host\n            [44] are also AT rich (37% average\n          GC content). Our analysis of the graph constructed based on inferred operon linkages\n          between all clusters indicates that the GOS-only clusters may constitute large sets of\n          cotranscribed genes (see Materials and Methods).\n\nThe high proportion of potentially viral novel clusters observed here is reasonable, as\n          60%–80% of the ORFs in most finished marine phage genomes are not homologous to known\n          protein sequences [52]. Viral\n          metagenomics projects have reported an equally high fraction of novel ORFs [53], and a recent marine metagenomics\n          project estimated that up to 21% of photic zone sequences could be of viral origin [51]. It has also been reported that 40%\n          of ORFans (sequences that lack similarity to known proteins and predicted proteins) exist\n          in close spatial proximity to each other in bacterial genomes, and this combined with\n          proximity to integration signals has been used to suggest a viral horizontally transferred\n          origin for many bacterial ORFans [54]. Others have noted a clustering of ORFans in genome islands and suggested they\n          derive from a phage-related gene pool [55]. A recent analysis of genome islands from related\n            Prochlorococcus found that phage-like genes and novel genes cohabit\n          these dynamic areas of the genome [56]. In our GOS-only clusters, 37 of the 1,700 clusters with no detectable\n          similarity (2.2%) have at least ten bacterial-classified and ten viral-classified\n          neighboring ORFs. This is 6.2-fold higher than the rate seen for the size-matched sample\n          of all clusters (six clusters, 0.35%). This would seem to add more support to a phage\n          origin for at least some ORFans found in bacterial genomes.\n\nIf a sizable portion of the novel families in the GOS data are in fact of viral origin,\n          it suggests that we are far from fully exploring the molecular diversity of viruses, a\n          conclusion echoed in previous studies of viral metagenomes [53,57,58]. In studies of\n          bacterial genomes, discovery of new ORFans shows no sign of reaching saturation [59]. Coverage of many phage families in\n          the GOS data may be low, given that there are inherent differences in the abundance of\n          their presumed bacterial hosts. These GOS-only clusters were operationally defined as\n          having at least 20 nonredundant sequences. Reducing this threshold to ten nonredundant\n          sequences adds 7,241 additional clusters. Whether this vast diversity represents new\n          families or is a reflection of the inability to detect distant homology will require\n          structural and biochemical studies, as well as continued development of computational\n          methods to identify remotely related sequences.\n\n        Comparison of Domain Profiles in GOS and PG Datasets\n        \nWe used HMM profiling to address the question of which biochemical and biological\n          functions are expanded or contracted in GOS compared to the largely terrestrial genomes in\n          PG. Significant differences are seen in 68% of domains (4,722 out of the 6,975 domains\n          that match either GOS or PG; p-value &lt;0.001, chi-square test).\n          These differences reflect several factors, including differing biochemical needs of\n          oceanic life and taxonomic biases in the two datasets. An initial comparison of these\n          domain profiles helps shed light on these factors. 91% (964/1,056) of GOS-only domains are\n          viral and/or eukaryotic specific (by Pfam annotation). Most of the remaining 92 domains\n          are rare (63 domains have less than ten copies in GOS), are predominantly\n          eukaryotic/viral, or are specific to narrow bacterial taxa without completed genome\n          sequences. Most of the 879 PG-only domains are also rare (444 have ten or less members),\n          and/or are restricted to tight lineages, such as Mycoplasma (104 matches\n          to five domains) or largely extremeophile archaeal-specific domains (1,254 matches to 99\n          domains). Highly PG-enriched domains also tend to belong in these categories. Many\n          moderately skewed domains reflect the taxonomic skew between PG and GOS. For instance, we\n          found that a set of six sarcosine oxidase-related domains are 4.8-fold enriched in GOS\n            (Table 6). They are mostly found\n          in α- and γ-proteobacteria, which are widespread in GOS. Normalizing to the taxonomic\n          class level predicts a 1.8-fold enrichment in GOS, indicating that taxonomy alone cannot\n          fully explain the prevalence of these proteins in oceanic bacteria.\n\n        Mysterious Lack of Characteristic Gram-Positive Domains\n        \nGram-positive bacteria (Firmicutes and Actinobacteria)\n          represent 26.7% of PG and ~12% of GOS [30]. Given the larger size of the GOS dataset, one might predict\n          Gram-positive–specific domains to be ~2.4-fold enriched in GOS. Instead, the opposite is\n          consistently seen. Of 15 firmicute-specific spore-associated domains, PG has 503 members,\n          but GOS has none. For another 22 firmicute-restricted domains of varying or unknown\n          function, the PG/GOS ratio is 1797:77 (Table 6). Hence, it appears that GOS Gram-positive lineages lack most of their\n          characteristic protein domains. Two sequenced marine Gram-positives (Oceanobacillus\n            iheyensis [60] and\n            Bacillus\n            sp. NRRL B-14911) have a large complement of these domains. However,\n          another recently assembled genome from Sargasso sea surface waters, the actinomycete\n            Janibacter\n            sp. HTCC2649, has just two of these domains, and may reveal a\n          whole-genome context for this curious loss of characteristic domains.\n\n        Flagellae and Pili Are Selectively Lost from Oceanic Species\n        \nFlagellum components from both eubacteria and archaea are significantly underrepresented\n          in the GOS dataset by about 2-fold (Table\n            6). Ironically, at a bacterial scale, swimming may be worthwhile on an almost dry\n          surface, but not in open water. The chemotaxis (che) operon that often directs flagellar\n          activity is also rare in GOS. Another directional appendage, the pilus, is even more\n          reduced, though its taxonomic distribution (mostly in proteobacteria, predominantly\n          γ-proteobacteria) would have predicted enrichment.\n\n        Skew in Core Cellular Pathways\n        \nWhile taxonomically specialized domains are likely to be skewed by taxonomic differences,\n          core pathways found in many or all organisms paint a different picture. We used GO term\n          mapping and text mining to group domains into major functions and to look for consistent\n          skews across several domains. Several core functions, including DNA-associated proteins\n          (DNA polymerase, gyrase, topoisomerase), ribosomal subunits shared by all three kingdoms,\n          marker proteins such as recA and dnaJ, and TCA cycle enzymes all tend to be GOS enriched.\n          This suggests that oceanic genomes may be more compact than sequenced genomes and so have\n          a higher proportion of core pathways.\n\n        Characteristics and Kingdom Distribution of Known Protein Domains\n        \nA decade ago, databases were highly biased towards proteins of known function. Today,\n          whole-genome sequencing and structural genomics efforts have presumably reduced the biases\n          that are a result of targeted protein sequencing. We used the Pfam database to compare the\n          characteristics and kingdom distribution of known protein domains in the GOS dataset to\n          that of proteins in the publicly available datasets (NCBI-nr, PG, TGI-EST, and ENS). Such\n          an effort can be used to assess biases in these datasets, help direct future sampling\n          efforts (of underrepresented organisms, proteins, and protein families), make more\n          informed generalizations about the protein universe, and provide important context for\n          determination of protein evolutionary relationships (as biased sampling could indicate\n          expected but missing sequences).\n\nFor this analysis we used the nonredundant datasets (at 100% identity) discussed in Figure 1. We refer to the set of 3,167,979\n          nonredundant sequences from NCBI-nr, PG, TGI-EST, and ENS as the public-100 set and the\n          similarly filtered set of 5,654,638 sequences from the GOS data as the GOS-100\n            set.\n\nAbout 70% of public-100 sequences and 56% of GOS-100 sequences significantly match at\n          least one Pfam model. The most obvious difference between the sets is that the vast\n          majority of GOS sequences are bacterial, and this has to be taken into account when\n          comparing the numbers. Since different Pfam families appear with different frequencies in\n          the kingdoms, we considered the results for each kingdom separately (Figure 5). We then evaluated all kingdoms together, with\n          results normalized by relative abundance of members from the different kingdoms. A domain\n          found commonly and exclusively in eukaryotes and abundant in public-100 would be expected\n          to be found rarely in GOS-100. We used a conservative BLAST-based kingdom assignment\n          method to assign kingdoms to the GOS sequences (see Materials and Methods).\n\nIn each kingdom, sequences in GOS-100 are less likely to match a Pfam family than those\n          in public-100 (Figure 5). For the\n          cellular kingdoms, these differences are comparatively modest. While diversity of the GOS\n          data accounts for some of this difference, it might also be explained in part by the\n          fragmentary nature of the GOS sequences. Viruses tell a dramatic and different story. Of\n          public-100 viral sequences, 89.1% match a Pfam domain, while only 27.5% of GOS-100 viral\n          sequences have a match. This tremendous difference appears to be due to heavy enrichment\n          of the public data for minor variants of a few protein families, indicated by the sizes of\n          the ten most populous Pfams in each kingdom (Figure 5). Sequences from three Pfam families (envelope glycoprotein GP120,\n          reverse transcriptase, and retroviral aspartyl protease) account for a third of all public\n          viral sequences. By contrast, the most populous three families in the GOS-100 data\n          (bacteriophage T4-like capsid assembly protein [Gp20], major capsid protein Gp23, and\n          phage tail sheath protein) account for only about 7% of public-100 sequences. Such a\n          difference may be due to intentional oversampling of proteins that come from\n          disease-causing organisms in the public dataset.\n\nWhile the total proportion of proteins with a Pfam hit is fairly similar between\n          public-100 (70%) and GOS-100 (56%) datasets, there are considerable differences with\n          regard to the distributions of protein families within these two datasets. The most highly\n          represented Pfam families in GOS-100 compared to public-100 are shown in Table 7. Notably, we found that while\n          many known viral families are absent in GOS-100, viral protein families dominate the list\n          of the families more highly represented in GOS-100; this is presumably because of biases\n          in the collection of previously known viral sequences. Surprisingly few bacterial families\n          were among the most represented in GOS-100 compared with public-100. By contrast, we also\n          observed that those families found more rarely in GOS-100 than public-100 were frequently\n          bacterial (Table 7). This appears to\n          be a result of the large number of key bacterial and viral pathogen proteins in public-100\n          that are comparatively less abundant in the oceanic samples and/or less intensively\n          sampled.\n\n        GOS-100 Data Suggest That a Number of “Kingdom-Specific” Pfams Actually Are\n          Represented in Multiple Kingdoms\n        \nOf the 7,868 Pfam models in Pfam 17.0, 4,050 match proteins from only a single kingdom in\n          public-100. The additional sequences from GOS-100 reveal that some of these families\n          actually have representatives in multiple kingdoms. Table 8 shows 12 families that have a Pfam match to at\n          least one GOS-100 protein with an E-value ≤ 1 × 10−10, and\n          which we confidently assigned to a kingdom different from that of all the public-100\n          matches. Because our criteria for a “confident” kingdom assignment are conservative, there\n          are only one or a few confident assignments for each Pfam domain to a “new” kingdom. Our\n          “confident” criteria are especially difficult to meet in the case of kingdom-crossing, due\n          to the votes contributed by the crossing protein (see Materials and Methods). Thus, many scaffolds have no confident kingdom\n          assignment. Our examination of each of the scaffolds responsible for a determination of\n          kingdom-crossing confirms that each one had both a highly significant match to the Pfam\n          model in question and an overwhelming number of votes for the unexpected kingdom. These\n          scaffold assemblies were also manually inspected. No clear anomalies were observed. In\n          most instances, the assemblies in question were composed of a single unitig, and as such\n          are high-confidence assemblies. Mate pair coverage and consistent depth of coverage\n          provide further support for the correctness of those assemblies that are built from\n          multiple unitigs. Examples of kingdom-crossing families include indoleamine\n          2,3-dioxygenase (IDO), MAM domain, and MYND finger [15], which have previously only been seen in eukaryotes,\n          but we find them also to be present in bacteria. These Pfams now cross kingdoms, due\n          either to their being more ancient than previously realized or to lateral transfer.\n\nWe explored the IDO family further. This family has representatives in vertebrates,\n          invertebrates, and multiple fungal lineages [15,61] in public-100.\n          Members of the IDO family are heme-binding, and mammalian IDOs catalyze the rate-limiting\n          step in the catabolic breakdown of tryptophan [62], while family members in mollusks have a myoglobin\n          function [63]. In mammals, IDO also\n          appears to have a role in the immune system [62,64–66]. The IDO Pfam has matches to 66 proteins in\n          public-100, all of which are eukaryotic. However, it also has matches to ten GOS-100\n          sequences that we confidently labeled as bacterial proteins and matches to 206 GOS-100\n          sequences for which a confident kingdom assignment could not be made (many of these are\n          likely bacterial sequences due to the GOS sampling bias). To reconstruct a phylogeny of\n          the IDO family, we searched a recent version of NCBI-nr (March 5, 2006) for IDO proteins\n          that were not included in the public-100 dataset. The search identified two bacterial\n          proteins from the whole genomes of the marine bacteria Erythrobacter litoralis\n          and Nitrosococcus oceani, and 24 eukaryotic proteins (see Materials and Methods). The phylogeny shown in Figure 6 shows 54% bootstrap support for a\n          separation of the clade containing exclusively public-100 and NCBI-nr 2006 eukaryotic\n          sequences from a clade with the GOS-100 sequences as well as the two NCBI-nr\n            E.\n            litoralis and N. oceani sequences. We confirmed this feature of\n          the tree topology with multiple other phylogeny reconstruction methods. Curiously, there\n          is considerable intermixing of bacterial and eukaryotic sequences in the clade of GOS-100\n          sequences and the two NCBI-nr bacteria. A manual inspection of the scaffolds that contain\n          the ten GOS-100 sequences (containing the IDO domain) that we confidently labeled as\n          bacterial, overwhelmingly supports the kingdom assignment. However, a manual inspection of\n          the scaffolds that contain the ten GOS-100 sequences (containing the IDO domain) that we\n          confidently labeled as eukaryotes presents a less convincing picture. These scaffolds are\n          short, with most of them containing only two voting ORFs. Since the NCBI-nr version used\n          in the public-100 set has IDO from eukaryotes only, the ORF with the IDO domain itself\n          would cast four votes for eukaryotes. Thus, these GOS-100 eukaryotic labelings are not\n          nearly as confident as the ones labeled bacterial.\n\n        Structural Genomics Implications\n        \nKnowledge about global protein distributions can be used to inform priorities in related\n          fields such as structural genomics. Structural genomics is an international effort to\n          determine the 3-D shapes of all important biological macromolecules, with a primary focus\n          on proteins [67–72]. Previous studies have shown that an efficient\n          strategy for covering the protein structure universe is to choose protein targets for\n          experimental structure characterization from among the largest families with unknown\n          structure [73,74]. If the structure of one family member is determined,\n          it may be used to accurately infer the fold of other family members, even if the sequence\n          similarity between family members is too low to enable accurate structural modeling [75]. Therefore, large families are a\n          focus of the production phase of the Protein Structure Initiative (PSI), the National\n          Institutes of Health–funded structural genomics project that commenced in October 2005\n            [76].\n\nIn March 2005, 2,729 (36%) of 7,677 Pfam families had at least one member of known\n          structure; these families could be used to infer folds for approximately 51% of all\n          pre-GOS prokaryotic proteins (covering 44% of residues) [74]. The Pfam5000 strategy is to solve one structure from\n          each of the largest remaining families, until a total of 5,000 families have at least one\n          member with known structure [73]. As\n          this strategy is similar to that being used at PSI centers to choose targets, projections\n          based on the Pfam5000 should reflect PSI results. Completion of the Pfam5000, a tractable\n          goal within the production phase of PSI, would enable accurate fold assignment for\n          approximately 65% of all pre-GOS prokaryotic proteins. In the GOS-100 dataset, we observed\n          that 46% of the proteins might currently be assigned a fold based on Pfam families of\n          known structure (see Materials and Methods).\n          Completion of the Pfam5000 would increase this coverage to 55%.\n\nThe GOS sequences will affect Pfam in two ways: some will be classified in existing\n          protein families, thus increasing the size of these families; others may eventually be\n          classified into new GOS-specific families. Both of these will alter the relative sizes of\n          different families, and thus their prioritization for structural genomics studies. We\n          calculated the sizes for all Pfam families based on the number of occurrences of each\n          family in the public-100 dataset. Proteins in GOS-100 were then added and the family sizes\n          were recalculated. A total of 190 families that are not in the Pfam5000 based on\n          public-100 are moved into the Pfam5000 after addition of the GOS data. The 30 largest such\n          families are shown in Table 9. As 20\n          of the 30 families are annotated as domains of unknown function in Pfam, structural\n          characterization might be helpful in identifying their cellular or molecular functions.\n          Reshuffling the Pfam5000 to prioritize these 190 families would improve structural\n          coverage of GOS sequences after completion of the Pfam5000 by almost 1% relative to the\n          original Pfam5000 (from 55.4% to 56.1%), with only a small decrease in coverage of\n          public-100 sequences (from 67.7% to 67.5%).\n\nThe Pfam5000 would be further reprioritized by the classification of clusters of GOS\n          sequences into Pfam. Assuming each cluster of pooled GOS-100 and public-100 sequences\n          without a current Pfam match would be classified as a single Pfam family, 885 such\n          families would replace existing families in the Pfam5000. These 885 clusters contain a\n          total of 383,019 proteins in GOS-100 and public-100. The reprioritized Pfam5000 would also\n          retain 1,183 families of unknown structure from the current Pfam5000; these families\n          comprise a total of 1,040,330 proteins in GOS-100 and public-100.\n\n        Known Protein Families and Increased Diversity Due to GOS Data\n        \nSeveral protein families serve as examples to further highlight the diversity added by\n          the GOS dataset. In this paper, we examined UV irradiation DNA damage repair enzymes,\n          phosphatases, proteases, and the metabolic enzymes glutamine synthetase and RuBisCO (Table 10). The RecA family (unpublished\n          data) and the kinase family [77] have\n          also been explored in the context of the GOS data. There are more than 5,000 RecA and\n          RecA-like sequences in the GOS dataset (Table 10). An analysis of the RecA phylogeny including the GOS data reveals\n          several completely new RecA subfamilies. A detailed study of kinases in the GOS dataset\n          demonstrated the power of additional sequence diversity in defining and exploring protein\n          families [77]. The discovery of\n          16,248 GOS protein kinase–like enzymes enabled the definition and analysis of 20 distinct\n          kinase-like families. The diverse sequences allowed the definition of key residues for\n          each family, revealing novel core motifs within the entire superfamily, and predicted\n          structural adaptations in individual families. This data enabled the fusion of choline and\n          aminoglycoside kinases into a single family, whose sequence diversity is now seen to be at\n          least as great as the eukaryotic protein kinases themselves.\n\n        Proteins Involved in the Repair of UV-Induced DNA Damage\n        \nMuch of the attention in studies of the microbes in the world's oceans has justifiably\n          focused on phototrophy, such as that carried out by the proteorhodopsin proteins.\n          Previously, in the Sargasso Sea study [10] it was shown that shotgun sequencing reveals a much greater diversity of\n          proteorhodopsin-like proteins than was previously known from cloning and PCR studies.\n          However, along with the potential benefits of phototrophy come many risks, such as the\n          damage caused to cells by exposure to solar irradiation, especially the UV wavelengths.\n          Organisms deal with the potential damage from UV irradiation in several ways, including\n          protection (e.g., UV absorption), tolerance, and repair [78]. Our examination of the protein family clusters\n          reveals that the GOS data provides an order of magnitude increase in the diversity (in\n          both numbers and types) of homologs of proteins known to be involved in pathways\n          specifically for repairing UV damage.\n\nOne aspect of the diversity of UV repair genes is seen in the overrepresentation of\n          photolyase homologs in the GOS data (see Table 10). Photolyases are enzymes that chemically reverse the UV-generated\n          inappropriate covalent bonds in cyclobutane pyrimidine dimers and 6–4 photoproducts [79]. The massive numbers of homologs of\n          these proteins in the GOS data (11,569 GOS proteins in four clusters; see Table 10) is likely a reflection of\n          their presence in diverse species and the existence of novel functions in this family. New\n          repair functions could include repair of other forms of UV dimers (e.g., involving altered\n          bases), use of novel wavelengths of light to provide the energy for repair, repair of RNA,\n          or repair in different sequence contexts. In addition, some of these proteins may be\n          involved in regulating circadian rhythms, as seen for photolyase homologs in various\n          species. Our findings are consistent with the recent results of a comparative metagenomic\n          survey of microbes from different depths that found an overabundance of photolyase-like\n          proteins at the surface [51].\n\nA good deal was known about the functions and diversity of photolyases prior to this\n          project. However, much less is known about other UV damage–specific repair enzymes, and\n          examination of the GOS data reveals a remarkable diversity of each of these. For example,\n          prior to this project, there were only some 25 homologs of UV dimer endonucleases (UVDEs)\n          available [80], and most of these\n          were from the Bacillus species. There are 420 homologs of UVDE (cluster\n          6239) in the GOS data representing many new subfamilies (Figure 7A and Materials and\n            Methods). A similar pattern is seen for spore lyases (which repair a UV lesion\n          specific to spores [81]) and the\n          pyrimidine dimer endonuclease (DenV, which was originally identified in T4 phage [82]). We believe this will also be true\n          for UV dimer glycosylases [83], but\n          predictions of function for homologs of these genes are difficult since they are in a\n          large superfamily of glycosylases.\n\nOur analysis of the kingdom classification assignments suggests that the diversity of\n          UV-specific repair pathways is seen for all types of organisms in the GOS samples. This\n          apparently extends even to the viral world (e.g., 51 of the UVDE homologs are assigned\n          putatively to viruses), suggesting that UV damage repair may be a critical function that\n          phages provide for themselves and their hosts in ocean surface environments. Based on the\n          sheer numbers of genes, their sequence diversity, and the diversity of types of organisms\n          in which they are apparently found, we conclude that many novel UV damage–repair processes\n          remain to be discovered in organisms from the ocean surface water.\n\n        Evidence of Reversible Phosphorylation in the Oceans\n        \nReversible phosphorylation of proteins represents a major mechanism for cellular\n          processes, including signal transduction, development, and cell division [84]. The activity of protein kinases and\n          phosphatases serve as antagonistic regulators of the cellular response. Protein\n          phosphatases are divided into three major groups based on substrate specificity [85]. The Mg2+- or\n            Mn2+-dependent phosphoserine/phosphothreonine protein phosphatase family,\n          exemplified by the human protein phosphatase 2C (PP2C), represents the smallest group in\n          number. An understanding of their physiological roles has only recently begun to emerge.\n          In eukaryotes, one of the major roles of PP2C activity is to reverse stress-induced kinase\n          cascades [86–89].\n\nWe identified 613 PP2C-like sequences in the GOS dataset, and they are grouped into two\n          clusters (Table 10). These sequences\n          contain at least seven motifs known to be important for phosphatase structure and function\n            [90,91]. Invariant residues involved in metal binding\n          (aspartate in motifs I, II, VIII) and phosphate ion binding (arginine in motif I) are\n          highly conserved among the GOS sequences.\n\nUsing the catalytic domain portion of these sequences we constructed a phylogeny showing\n          that despite the overall conserved structure of the PP2C family of proteins, the known\n          bacterial PP2C-like sequences group together with the GOS bacterial PP2C-like sequences\n            (Figure 7B, Materials and Methods). Furthermore, the eukaryotic PP2Cs display a much\n          greater degree of sequence divergence compared to the bacterial PP2C sequences.\n\nWe also examined the combined dataset of PP2C-like phosphatases further for potential\n          differences in amino acid composition between the bacterial and eukaryotic groups. We\n          observed a striking distinction between the eukaryotic and bacterial PP2C-like\n          phosphatases in motif II, where a histidine residue (His62 in human PP2Ca) is conserved in\n          more than 90% of sequences, but not observed in the bacterial group. The bacterial PP2C\n          group contains a methionine (at the corresponding position) in the majority of the cases\n          (70%). This histidine residue is involved in the formation of a beta hairpin in the\n          crystal structure of human PP2C [91].\n          Furthermore, His62 is proposed to act as a general acid for PP2C catalysis [92]. Both amino acids lie in the\n          proximity of the phosphate-binding domain, but at this time it is unclear how the\n          difference at this position would contribute to the overall structure and function of the\n          two PP2C groups. Nonetheless, the large number of diverse PP2C-like phosphatases in this\n          dataset allowed us to identify a previously unrecognized key difference between bacterial\n          and eukaryotic PP2Cs.\n\nBacterial genes that perform closely related functions can be organized in close\n          proximity to each other and often in functional units. Linked Ser/Thr kinase-phosphatase\n          genetic units have been described in several bacterial species, including\n            Streptococcus pneumoniae, Bacillus subtilis, and Mycobacterium\n            tuberculosis [93–96]. Two major neighboring clusters are\n          found to be associated with the set of PP2C-like phosphatases in the GOS bacterial group.\n          We observed that one of these clusters contained a protein serine/threonine kinase domain\n          as its most common Pfam domain. An additional neighboring cluster found to be associated\n          with the GOS set of bacterial PP2Cs was identified as a set of sequences containing a\n          PASTA (penicillin-binding protein and serine/threonine kinase–associated) domain. This\n          domain is unique to bacterial species, and is believed to play important roles in\n          regulating cell wall biosynthesis [97].\n\nOur identification of a conserved group of unique PP2C-like phosphatases in the GOS\n          dataset significantly increases the number and diversity of this enzyme family. This\n          analysis of the NCBI-nr, PG ORFs, TGI-EST ORFs, and ENS datasets along with the sequences\n          obtained from the GOS dataset significantly increases the overall number of PP2C-like\n          sequences from that estimated just a year ago [98]. The presence of genes encoding bacterial\n          serine/threonine kinase domains located adjacent to PP2Cs in the GOS data supports the\n          notion that the process of reversible phosphorylation on Ser/Thr residues controls\n          important physiological processes in bacteria.\n\n        Proteases in GOS Data\n        \nProteases are a group of enzymes that degrades other proteins and, as such, plays\n          important roles in all organisms [99]. On the basis of their catalysis mechanism, proteases are divided into six\n          distinct catalytic types: aspartic, cysteine, metallo, serine, threonine, and glutamic\n          proteases [99]. They differ from each\n          other by the presence of specific amino acids in the active site and by their mode of\n          action. The MEROPS database [100] is\n          a comprehensive source of information for this large divergent group of sequences and\n          provides a widely accepted classification of proteases into families, based on the amino\n          acid sequence comparison, and then into clans based on the similarity of their 3-D\n          structures.\n\nWe identified 222,738 potential proteases in the GOS dataset based on similarity to\n          sequences in MEROPS (see Materials and Methods).\n          According to our clustering method, 95% of these sequences are grouped into 190 clusters,\n          with each cluster on the average containing more than 1,100 GOS sequences. These sequences\n          were compared to proteases in NCBI-nr. There are groups of proteases in NCBI-nr that are\n          highly redundant. For example, there are a large number of viral proteases from HIV-1 and\n          hepatitis C viruses that dominate the NCBI-nr protease set. Thus, we computed a\n          nonredundant set of NCBI-nr proteases and, for the sake of consistency, a nonredundant set\n          of proteases from the GOS set using the same parameters. The majority of proteases in both\n          sets are dominated by cysteine, metallo, and serine proteases. The GOS dataset is\n          dominated by proteases belonging to the bacterial kingdom. That is not surprising, given\n          the filter sizes used to collect the samples. In NCBI-nr the proteases are more evenly\n          distributed between the bacterial and the eukaryotic kingdoms.\n\nOur comparison of the protease clan distribution of the bacterial sequences in the\n          NCBI-nr and GOS sets reveals that the distribution of clans is very similar for metallo-\n          and serine proteases. However, the distribution of clans in aspartic and cysteine\n          proteases is different in the two datasets. Among aspartic proteases, the most visible\n          difference is the increased ratio of proteases of the AC clan and the decreased ratio in\n          the AD clan. Proteases in the former clan are involved in bacterial cell wall production,\n          while those in the latter clan are involved in pilin maturation and toxin secretion [99]. Among cysteine proteases, the most\n          apparent is the decrease in the CA clan and an increase in the number of proteases from\n          the PB(C) clan. Bacterial members of the CA clan are mostly involved in degradation of\n          bacterial cell wall components and in various aspects of biofilm formation [99]. It is possible that both activities\n          are less important for marine bacteria present in surface water. Proteases from the PB(C)\n          clan are involved in activation (including self-activation) of enzymes from\n          acetyltransferase family. In fungi this family is involved in penicillin synthesis, while\n          their function in bacteria is unknown [99].\n\nWe were unable to detect any caspases (members of the CD clan) in the GOS data. This is\n          consistent with the apoptotic cell death mechanism being present only in multicellular\n          eukaryotes, which, based on the filter sizes, are expected to be very rare in the GOS\n          dataset.\n\n        Metabolic Enzymes in the GOS Data\n        \nTo gain insights into the diversity of metabolism of the organisms in the sea, we studied\n          the abundance and diversity of glutamine synthetase (GS) and ribulose 1,5-bisphosphate\n          carboxylase/oxygenase (RuBisCO), two key enzymes in nitrogen and carbon metabolism.\n\nGS is the central player of nitrogen metabolism in all organisms on earth. It is one of\n          the oldest enzymes in evolution [101]. It converts ammonia and glutamate into glutamine that can be utilized by\n          cells. GS can be classified into three types based on sequence [101]. Type I has been found only in bacteria, and it\n          forms a dodecameric structure [102,103]. Type II has been\n          found mainly in eukaryotes, and in some bacteria. Type III GS is less well studied, but\n          has been found in some anaerobic bacteria and cyanobacteria. There are 18 active site\n          residues in both bacterial and eukaryotic GS that play important roles in binding\n          substrates and catalyzing the enzymatic reactions [104].\n\nWe found 9,120 GS and GS-like sequences in the GOS data (Table 10). Using profile HMMs [41,105] constructed from known GS sequences of different types, we were able to\n          classify 4,350 sequences as type I GS, 1,021 sequences as type II GS, and 469 sequences as\n          type III GS (see Materials and Methods).\n\nThe number of type II GS sequences found in the GOS data is surprisingly high, since\n          previously type II GS were considered to be mainly eukaryotic and very few eukaryotic\n          organisms were expected to be included in the GOS sequencing (Figure 7C and Materials and\n            Methods). We used gene neighbor analysis to classify the origin of GS genes by\n          the nature of other proteins found on the same scaffold. Using this approach, most of the\n          neighboring genes of the type II GS in the GOS data are identified as bacterial genes. The\n          neighboring genes of the type II GS include nitrogen regulatory protein PII, signal\n          transduction histidine kinase, NH3-dependent NAD+ synthetase,\n          A/G-specific adenine glycosylase, coenzyme PQQ synthesis protein c, pyridoxine\n          biosynthesis enzyme, aerobic-type carbon monoxide dehydrogenase, etc. We were able to\n          assign more than 90% of the type II GS sequences in the GOS data to bacterial scaffolds\n          based on a BLAST-based kingdom assignment method (see Materials and Methods). Both neighboring genes and kingdom assignments suggest\n          that most of the type II GS sequences in the GOS data come from bacterial organisms. In\n          comparison, the same type II GS profile HMM detects only 12 putative type II GS sequences\n          from the PG dataset of 222 prokaryotic genomes. Within these, there are only seven unique\n          type II GS sequences and six unique bacterial species represented. The reason why bacteria\n          in the ocean have so many type II GS genes is unclear.\n\nTwo hypotheses have been raised to explain the origin of type II GS in bacterial genomes:\n          lateral gene transfer from eukaryotic organisms [106] and gene duplication prior to the divergence of\n          prokaryotes and eukaryotes [101]. The\n          type II GS sequences in the predominantly bacterial GOS data are not only abundant, but\n          also diverse and divergent from most of known eukaryotic GS sequences (Figure 7C). This makes the hypothesis of\n          lateral gene transfer less favorable. If the GS gene duplication preceded the\n          prokaryote–eukaryote divergence according to the gene duplication hypothesis, it is\n          possible that many oceanic organisms retained type II GS genes during evolution.\n\nInterestingly, we found 19 cases where a type I GS gene is adjacent to a type II GS gene\n          on the same scaffold. Both GS genes seem to be functional based on the high degree of\n          conservation of active site residues. The same gene arrangement was observed previously in\n            Frankia\n            alni CpI1 [107].\n          The functional significance of maintaining two types of GS genes adjacent to one another\n          in the genome remains to be elucidated. Most of the sequences of these GS genes are highly\n          similar. We examined the geographic distribution of these adjacent GS sequences across all\n          the GOS samples. They are mainly found in the samples taken from two sites. Their\n          geographic distribution is significantly different from the distributions of types I and\n          II GS across the samples. The high sequence similarity among the adjacent GS pairs and\n          their geographic distribution suggest that these adjacent GS sequences may come from only\n          a few closely related organisms. This is consistent with the protein sequence tree of type\n          II GS, where the type II GS sequences from the GS gene pairs mainly reside in two distinct\n          branches (Figure 7C).\n\nThe active site residues are very well conserved in all GS sequences in the GOS data,\n          except one residue, Y179, which coordinates the ammonium-binding pocket. We observed\n          substitutions of Y179 to phenylalanine in about half of the type II GS sequences. The\n          activity of type I GS in some bacteria is regulated by adenylylation at residue Tyr397. In\n          the GOS data, Tyr397 is relatively conserved in type I GS, with variations to\n          phenylalanine and tryptophan in about half of the sequences. This indicates that the\n          activity of some of the type I GS is not regulated by adenylylation, as shown previously\n          in some Gram-positive bacteria [108,109].\n\nRuBisCO is the key enzyme in carbon fixation. It is the most abundant enzyme on earth\n            [110] and plays an important role\n          in carbon metabolism and CO2 cycle. RuBisCO can be classified into four forms.\n          Form I has been found in both plants and bacteria, and has an octameric structure. Form II\n          has been found in many bacteria, and it forms a dimer in Rhodospirillum\n            rubrum. Form III is mainly found in archaea, and forms various oligomers. Form\n          IV, also called the RuBisCO-like protein (RLP), has been recently discovered from\n          bacterial genome-sequencing projects [111,112]. RLP represents a\n          group of proteins that do not have RuBisCO activity, but resemble RuBisCO in both sequence\n          and structure [111,113]. The functions of RLPs are largely\n          unknown and seem to differ from each other.\n\nContrary to the large number of GS sequences, we identified only 428 sequences homologous\n          to the RuBisCO large subunit in the GOS data. The small number of RuBisCO sequences may\n          partly be due to the fact that larger-sized bacterial organisms were not included in the\n          sequencing because of size filtering. However, it could also indicate that CO2\n          is not the major carbon source for these sequenced ocean organisms.\n\nThe RuBisCO homologs in the GOS data are more diverse than the currently known RuBisCOs\n            (Figure 7D, Materials and Methods). Six of 19 active site residues—N123, K177, D198,\n          F199, H327, and G404—are not well conserved in all sequences, suggesting that the proteins\n          with these mutations may have evolved to have new functions, such as in the case of RLPs.\n          From the studies of the RLPs from Chlorobium tepidum and B. subtilis [111,114], it has been shown that the active site of RuBisCO\n          can accommodate different substrates and is potentially capable of evolving new catalytic\n          functions [113,114]. On the other hand, two sequence motifs, helices αB\n          and α8, that are not involved in substrate binding and catalytic activity are well\n          conserved in the GOS RuBisCO sequences. The higher degree of conservation of these\n          nonactive site residues than that of active site residues suggests that these motifs are\n          important for their structure, function, or interaction with other proteins.\n\nWe found 47 (31 at 90% identity filtering) GOS sequences in the branch with known RLP\n          sequences in a phylogenetic tree of RuBisCO (Figure 7D). In this phylogenetic tree, in addition to the clades for each of the\n          four forms of RuBisCO, there are also new groups of 65 (58 at 90% identity filtering) GOS\n          sequences that do not cluster with any known RuBisCO sequences. This indicates that there\n          could be more than one type of RuBisCO-like protein existing in organisms. The novel\n          groups of RuBisCO homologs in the GOS data also suggest that we have not fully explored\n          the entire RuBisCO family of proteins (Figure\n            7D).\n\n        GOS Data and Remote Homology Detection\n        \nThe addition of GOS sequences may help greatly in defining the range and diversity of\n          many known protein families, both by addition of many new sequences and by the increased\n          diversity of GOS sequences. Our comparison of HMM scores for GOS sequences with those from\n          the other four datasets shows that GOS sequences consistently tend to have lower scores,\n          which indicates additional diversity from that captured in the original HMM (Figure 8). The addition of GOS data into\n          domain profiles may broaden the profile and allow it to detect additional remote family\n          members in both GOS and other datasets. As a trial, we rebuilt the Pfam model PF01396,\n          which describes a zinc finger domain within bacterial DNA topoisomerase. The original\n          model finds 821 matches to 481 proteins in NCBI-nr. Our model that includes GOS sequences\n          reveals 1,497 matches to 722 sequences, an increase of 50% in sequences and 82% in domains\n          (most topoisomerases have three such domains, of which one is divergent and difficult to\n          detect). Of these new matches, 104 are validated by the presence of additional\n          topoisomerase domains, or they are annotated as topoisomerase, while most others are\n          unannotated or similar to other DNA-modifying enzymes not previously thought to have zinc\n          finger domains.\n\nHMM profiles can be further exploited by using matches beyond the conservative trusted\n          cutoff (TC) used in this study. For instance, the Pfam for the poxvirus A22 protein family\n          has no GOS matches above the TC, but 137 matches with E-values of 1 ×\n            10−3 to 1 × 10−10, containing a short conserved motif overlap with\n          A22 proteins. Alignment of these matches shows an additional two short motifs in common\n          with A22, establishing their homology, and using a profile HMM, we found a total of 269\n          family members in GOS and eight family members in NCBI-nr. Many members of this new family\n          are surrounded by other novel clusters, or are in putative viral scaffolds, suggesting\n          that these weak matches are an entry point into a new clade of viruses.\n\n        ORFans with Matches in GOS Data\n        \nFurther evidence of the diversity added by GOS sequences is provided by their matches to\n          ORFans. ORFans are sequences in current protein databases that do not have any\n          recognizable homologs [117]. ORFan\n          sequences (discounting those that may be spurious gene predictions) represent genes with\n          organism-specific functions or very remote homologs of known families. They have the\n          potential to shed light on how new proteins emerge and how old ones diversify.\n\nWe identified 84,911 ORFans (5,538 archaea, 35,292 bacteria, 37,427 eukaryotic, 5,314\n          virus, and 1,340 unclassified) from the NCBI-nr dataset using CD-HIT [116,117] and BLAST (see Materials and Methods). Of these, 6,044 have matches to GOS sequences using\n          BLAST (E-value ≤1 × 10−6). Figure 9 shows the distribution of the matched ORFans\n          grouped by organisms, number of their GOS matches, and the lowest E-value\n          of the matches. We found matches to GOS sequences for 13%, 6.3%, 0.89%, and 8.9% of\n          bacterial, archaeal, eukaryotic, and viral ORFans, respectively. While most of these\n          ORFans have very few GOS matches, 626 of them have ≥20 GOS matches. The similarities\n          between GOS sequences and eukaryotic ORFans are much weaker than those between GOS\n          sequences and noneukaryotic ORFans. The average sequence identity between eukaryotic\n          ORFans and their closest GOS matches is 38%. This is 6% lower than the identity between\n          noneukaryotic ORFans and their closest GOS matches.\n\nThe ORFans that match GOS sequences are from approximately 600 organisms. Table 11 lists the 20 most populated\n          organisms. Out of the 6,044 matched ORFans, approximately 2,000 are from these 20\n          organisms. For example, Rhodopirellula baltica SH 1, a marine bacterium, has 7,325 proteins\n          deposited in NCBI-nr. We identified 1,418 ORFans in this organism, of which 322 have GOS\n          matches. Another interesting example in this list is Escherichia coli.\n          Although there are &gt;20 different strains sequenced, 168 ORFans are identified in\n          strain CFT073, and 67 of them have GOS matches. The only eukaryotic organism in this list\n          is Candida\n            albicans SC5314, a fungal human pathogen, which has 49 ORFans with GOS\n          matches.\n\nWe examined a small but interesting subset of the ORFans that have 3-D structures\n          deposited in PDB. Out of 65 PDB ORFans, GOS matches for eight of them are found (see\n          Supporting Information for their PDB identifiers and names). They include four restriction\n          endonucleases, three hypothetical proteins, and a glucosyltransferase.\n\nGOS sequences can play an important role in identifying the functions of existing ORFans\n          or in confirming protein predictions. For example, we found that the hypothetical protein\n          AF1548, which is a PDB ORFan, has matches to 16 GOS sequences. A PSI-BLAST search with\n          AF1548 as the query against a combined set of GOS and NCBI-nr identified several\n          significant restriction endonucleases after three iterations. With the support of 3-D\n          structure and multiple sequence alignment of AF1548 and its GOS matches, we predict that\n          AF1548 along with its GOS homologs are restriction endonucleases (Figure 10). When combined with an established consensus\n          of active sites of the related endonucleases families [118], we predicted three catalytic residues.\n\n        Genome Sequencing Projects and Protein Exploration\n        \nWith respect to protein exploration and novel family discovery, microbial sequencing\n          offers more promise compared to sequencing more mammalian genomes. This is illustrated by\n            Figure 11, where the\n          number of clusters that protein predictions from various finished mammalian genomes fall\n          into was compared to the number of clusters that similar-sized random subsets of microbial\n          sequences fall into (see Materials and Methods). As\n          the figure shows, the rate of protein family discovery is higher for microbes than for\n          mammals. Indeed, the rate of new family discovery is plateauing for mammalian sequences.\n          This is not surprising, as mammalian divergence from a common ancestor is much more recent\n          than microbial divergence from a common ancestor, which suggests that mammals will share a\n          larger core set of less-diverged proteins. Microbial sequencing is also more cost\n          effective than mammalian sequencing for acquiring protein sequences because microbial\n          protein density is typically 80%–90% versus 1%–2% for mammals. This could be addressed\n          with mammalian mRNA sequencing, but issues with acquiring rarely expressed mRNAs would\n          need to be considered. There are, of course, other reasons to sequence mammalian genomes,\n          such as understanding mammalian evolution and mammalian gene regulation.\n\n        Conclusions\n        \nThe rate of protein family discovery is approximately linear in the (current) number of\n          protein sequences. Additional sequencing, especially of microbial environments, is\n          expected to reveal many more protein families and subfamilies. The potential for\n          discovering new protein families is also supported by the GOS diversity seen at the\n          nucleotide level across the different sampling sites [30]. Averaged over the sites, 14% of the GOS sequence\n          reads from a site are unique (at 70% nucleotide identity) to that site [30].\n\nThe GOS data provides almost complete coverage of known prokaryotic protein families. In\n          addition, it adds a great deal of diversity to many known families and offers new insights\n          into the evolution of these families. This is illustrated using several protein families,\n          including UV damage–repair enzymes, phosphatases, proteases, glutamine synthetase,\n          RuBisCO, RecA (unpublished data), and kinases [77]. Only a handful of protein families have been\n          examined thus far, and many thousands more remain to be explored.\n\nThe protein analysis presented indicates that we are far from exploring the diversity of\n          viruses. This is reflected in several of the analyses. The GOS-only clusters show an\n          overrepresentation of sequences of viral origin. In addition, our domain analysis using\n          HMM profiling shows a lower Pfam coverage of the GOS sequences in the viral kingdom\n          compared to the other kingdoms. At least two of the protein families we explored in detail\n          (UV repair enzymes and glutamine synthetase) contain abundant new viral additions. The\n          extraordinary diversity of viruses in a variety of environmental settings is only now\n          beginning to be understood [57,119–121]. A separate analysis of GOS microbial and viral\n          sequences (unpublished data) shows that multiple viral protein clusters contain\n          significant numbers of host-derived proteins, suggesting that viral acquisition of host\n          genes is quite widespread in the oceans.\n\nData generated by this GOS study and similar environmental shotgun sequencing studies\n          present their own analysis challenges. Methods for various analyses (e.g., sequence\n          alignment, profile construction, phylogeny inference, etc.) are generally designed and\n          optimized to work with full sequences. They have to be tailored to analyze the mostly\n          fragmentary sequences that are generated by these projects. Nevertheless, these data are a\n          valuable source of new discoveries. These data have the potential to refine old hypotheses\n          and make new observations about proteins and their evolution. Our preliminary exploration\n          of the GOS data identified novel protein families and also showed that many ORFan\n          sequences from current databases have homologs in these data. The diversity added by GOS\n          data to protein families also allows for the building of better profile models and thereby\n          improves remote homology detection. The discovery of kingdom-crossing protein families\n          that were previously thought to be kingdom-specific presents evidence that the GOS project\n          has excavated proteins of more ancient lineage than that previously known, or that have\n          undergone lateral gene transfer. This is another example of how metagenomics studies are\n          changing our understanding of protein sequences, their evolution, and their distribution\n          across the various forms of life and environments. Biases in the currently published\n          databases due to oversampling of some proteins or organisms are illuminated by\n          environmental surveys that lack such biases. Such knowledge can help us make better\n          predictions of the real distribution patterns of proteins in the natural world and\n          indicate where increased sampling would be likely to uncover new families or family\n          members of tremendous diversity (such as in the viral kingdom).\n\nThese data have other significant implications for the fields of protein evolution and\n          protein structure prediction. Having several hundreds or even tens of thousands of diverse\n          proteins from a family or examples of a specific protein fold should provide new\n          approaches for developing protein structure prediction models. Development of algorithms\n          that consider the alignments of all these family members/protein folds and analyze how\n          amino acid sequence can vary without significantly altering the tertiary structure or\n          function may provide insights that can be used to develop new ab inito methods for\n          predicting protein structures. These same datasets could also be used to begin to\n          understand how a protein evolves a new function. Finally, this large database of amino\n          acid sequence data could help to better understand and predict the molecular interactions\n          between proteins. For example, they may be used to predict the protein–protein\n          interactions so critical for the formation of specific functional complexes within\n          cells.\n\nThe GOS data also have implications for nearly all computational methods relying on\n          sequence data. The increase in the number of known protein sequences presents challenges\n          to many algorithms due to the increased volume of sequences. In most cases this increase\n          in sequence data can be compensated for with additional CPU cycles, but it is also a\n          foreshadowing of times to come as the pace of large-scale sequence-collecting accelerates.\n          A related challenge is the increase in the diversity of protein families, with many new\n          divergent clades present. With more protein similarity relationships falling into the\n          twilight zone overlapping with random sequence similarity, the number of false positives\n          for homology detection methods increases, making the true relationships more difficult to\n          identify. Nevertheless, a deeper knowledge of protein sequence and family diversity\n          introduces unprecedented opportunities to mine similarity relationships for clues on\n          molecular function and molecular interactions as well as providing much expanded data for\n          all methods utilizing homologous sequence information data.\n\nThe GOS dataset has demonstrated the usefulness of large-scale environmental shotgun\n          sequencing projects in exploring proteins. These projects offer an unbiased view of\n          proteins and protein families in an environmental sample. However, it should be noted that\n          the GOS data reported here are limited to mostly ocean surface microbes. Even with this\n          targeted sampling a tremendous amount of diversity is added to known families, and there\n          is evidence for a large number of novel families. Additional data from larger filter sizes\n          (that will sample more eukaryotes) coupled with metagenomic studies of different\n          environments like soil, air, deep sea, etc. will help to achieve the ultimate goal of a\n          whole-earth catalog for proteins.\n\n      Materials and Methods\n      \n        Data description.\n        \nNCBI-nr [31,32] is the single largest publicly available protein\n          resource and includes protein sequences submitted to SWISS-PROT (curated protein database)\n            [122], PDB (a database of amino\n          acid sequences with solved structures) [123], PIR (Protein Information Resource) [124], and PRF (Protein Research Foundation). In addition,\n          NCBI-nr also contains protein predictions from DNA sequences from both finished and\n          unfinished genomes in GenBank [125],\n          EMBL [126], and DNA Databank of Japan\n          (DDBJ) [127]. The nonredundancy in\n          NCBI-nr is only to the level of distinct sequences, and any two sequences of the same\n          length and content are merged into a single entry. NCBI-nr contains partial protein\n          sequences and is not a fully curated database. Therefore it also contains contaminants in\n          the form of sequences that are falsely predicted to be proteins.\n\nExpressed sequence tag (EST) databases also provide the potential to add a great deal of\n          information to protein exploration and contain information that is not well represented in\n          NCBI-nr. To this end, assemblies of EST sequences from the TIGR Gene Indices [34], an EST database, were included in\n          this study. To minimize redundancy, only EST assemblies from those organisms for which the\n          full genome is not yet known, were included. The protein predictions on metazoan genomes\n          that are fully sequenced and annotated were obtained by including the Ensembl database\n            [35,36] in this study.\n\nBoth finished and unfinished sequences from prokaryotic genome projects submitted to NCBI\n          were included. The protein predictions from the individual sequencing projects are\n          submitted to NCBI-nr. Nevertheless, these genomes were included in this dataset both for\n          the purpose of evaluating our approach and also for the purpose of identifying any\n          proteins that were missed by the annotation process used in these projects.\n\nThus, for this study the following publicly available datasets, all downloaded on\n          February 10, 2005—NCBI-nr, PG, TGI-EST, and ENS—were used. The organisms in the PG set and\n          the TGI-EST set are listed in Protocol S1.\n\n        Assembly of the GOS dataset.\n        \nInitial assembly (construction of “unitigs”) was performed so that only overlaps of at\n          least 98% DNA sequence identity and no conflicts with other overlaps were accepted. False\n          assemblies at this phase of the assembler are extremely rare, even in the presence of\n          complex datasets [37,128]. Paired-end (also known as\n          mate-pair) data were then used to order, orient, and merge unitigs into the final\n          assemblies, but only when two mate pairs or a single mate pair and an overlap between\n          unitigs implied the same layout. In one respect, mate pair data was used more aggressively\n          than is typical in assembly of a single genome in that depth-of-coverage information was\n          largely ignored [10]. This\n          potentially allows chimeric assemblies through a repeat within a genome or through an\n          ortholog between genomes. Thus, a conclusion that relies on the correctness of a single\n          assembly involving multiple unitigs should be considered tentative until the assembly can\n          be confirmed in some way. Assemblies involved in key results in this paper were subjected\n          to expert manual review based on thickness of overlaps, presence of well-placed mate pairs\n          across thin overlaps or across gaps between contigs, and consistency of depth of\n          coverage.\n\n        Data release and availability.\n        \nAll the GOS protein predictions will be submitted to GenBank. In addition, all the data\n          supporting this paper, including the clustering and the various analyses, will be made\n          publicly available via the CAMERA project (Community Cyberinfrastructure for Advanced\n          Marine Microbial Ecology Research and Analysis; http://camera.calit2.net), which is funded by the Gordon and Betty Moore\n          Foundation.\n\n        All-against-all BLASTP search.\n        \nWe used two sets of computer resources. At the J. Craig Venter Institute, 125 dual\n          3.06-GHz Xeon processor systems with 2 Gb of memory per system were used. Each system had\n          80 GB local storage and was connected by GBit ethernet with storage area network (SAN) I/O\n          of ~24 GBit/sec and network attached storage (NAS) I/O of ~16 GBit/sec. A total of 466,366\n          CPU hours was used on this system. In addition, access to the National Energy Research\n          Scientific Computing Center (NERSC) Seaborg computer cluster was available, including 380\n          nodes each with sixteen 375-MHz Power3 processors. The systems had between 16 GB and 64 GB\n          of memory. Only 128 nodes were used at a time. A total of 588,298 CPU hours was used on\n          this system. The dataset of 28.6 million sequences was searched against itself in a\n          half-matrix using NCBI BLAST [38]\n          with the following parameters: -F “m L” -U T -p blastp -e 1 × 10−10 -z 3 ×\n            109 -b 8000 -v 10. In this paper, similarity of an alignment\n          is defined to be the fraction of aligned residues with a positive score according to the\n          BLOSUM62 substitution matrix [129]\n          used in the BLAST searches.\n\n        Identification of nonredundant sequences.\n        \nGiven a set of sequences S and a threshold T, a\n          nonredundant subset S′ of S was identified by first\n          partitioning S (using the threshold T) and then picking\n          a representative from each partition. The set of representatives constitutes the\n          nonredundant set S′. The process was implemented using the following\n          graph-theoretic approach. A directed graph G = (V, E) is\n          constructed with vertex set V and edge set E. Each\n          vertex in V represents a sequence from S. A directed\n          edge (u,v) ∈ E if sequence\n            u is longer than sequence v and their sequence\n          comparison satisfies the threshold T; for sequences of identical length,\n          the sequence with the lexicographically larger id is considered the longer of the two.\n          Note that G does not have any cycles. Source vertices (i.e., vertices\n          with no in-degree) are sorted in decreasing order of their out-degrees and (from largest\n          out-degree to smallest) processed in this order. A source vertex u is\n          processed as follows: mark all vertices that have not been seen before and are reachable\n          from vertex u as being redundant and mark vertex u as\n          their representative.\n\nWe used two thresholds in this paper, 98% similarity and 100% identity. The former was\n          used in the first stage of the clustering and the later was used in the HMM profile\n          analysis. For the 98% similarity threshold, two sequences satisfy the threshold if the\n          following three criteria are met: (1) similarity of the match is at least 98%; (2) at\n          least 95% of the shorter sequence is covered by the match; and (3) (match score)/(self\n          score of shorter sequence) ≥ 95%.\n\nFor the 100% identity threshold, two sequences satisfy the threshold if their match\n          identity is 100%.\n\n        Description of the clustering algorithm.\n        \nThe starting point for the clustering was the set of pairwise sequence similarities\n          identified using the all-against-all BLASTP compute. Because of both the volume and nature\n          of the data, the clustering was carried out in four steps: redundancy removal, core set\n          identification, core set merging, and final recruitment.\n\nA set of nonredundant sequences (at 98% similarity) was identified using the procedure\n          given in Materials and Methods (Identification of\n          nonredundant sequences). Only the nonredundant sequences were considered in further steps\n          of the clustering process.\n\nThe aim of the core set identification step was to identify core sets of\n          highly related sequences. In graph-theoretic terms, this involves looking for dense\n          subgraphs in a graph where the vertices correspond to sequences and an edge exists between\n          two sequences if their sequence match satisfies some reasonable threshold (for instance,\n          40% similarity match over 80% of at least one sequence and are clearly homologous based on\n          the BLAST threshold). Dense subgraphs were identified by using a heuristic. This approach\n          utilizes long edges. These are edges where the match threshold is\n          computed relative to the longer sequence. This was done to prevent, as much as possible,\n          unrelated proteins from being put into the same core set. If all the sequences were full\n          length, using long edges would have offered a good solution to keeping unrelated proteins\n          apart. However, the situation here is complicated by the presence of a large amount of\n          fragmentary sequence data of varying lengths. This was dealt with somewhat by working with\n          rather stringent match thresholds and a two-stage process to identify the core sets. We\n          used the concept of strict long edges and weak long\n          edges. A strict long edge exists between two vertices (sequences) if their match has the\n          following properties: (1) 90% of the longer sequence is involved in the match; (2) the\n          match has 70% similarity; and (3) the score of the match is at least 60% of the self-score\n          of the longer sequence. A weak long edge exists between two vertices (sequences) if their\n          match has the following properties: (1) 80% of the longer sequence is involved in the\n          match; (2) the match has 40% similarity; and (3) the score of the match is at least 30% of\n          the self-score of the longer sequence. Core set identification had two substages:\n            large core initialization and core extension. The\n          large core initialization step identified sets of sequences where these sets were of a\n          reasonable size and the sequences in them were very similar to each other. Furthermore,\n          these sets could be extended in the core extension step by adding related sequences. In\n          the large core initialization step, a directed graph G was constructed on\n          the sequences using strict long edges, with each long edge being directed from the longer\n          to the shorter sequence. For each vertex v in G, let\n            S(v) denote the friends set of v\n          consisting of v and all neighbors that v has an\n          out-going edge to.\n\nInitially all the vertices in G are unmarked. Consider the set of all friends sets in the\n          decreasing order of their size. For S(v) that is\n          currently being considered, do the following: (1) initialize seed set A =\n            S(v); (2) while there exists some v′\n          such that |S(v) ∩\n          S(v′)| ≥ k, set A =\n            A ∪ S(v′). (Note: k\n          = 10 is chosen); (3) output set A and mark all vertices in\n            A; and (4) update all friends sets to contain only unmarked\n          vertices.\n\nIn the core extension step, we constructed a graph G using weak long\n          edges. All vertices in seed sets (computed from the large core initialization step) were\n          marked and the rest of the vertices unmarked. Each seed set was then greedily extended to\n          be a core set by adding a currently unmarked vertex that has at least k\n          neighbors (k = 10 is chosen) in the set; the added vertex was marked.\n          After this process, a clique-finding heuristic was used to identify smaller cliques (of\n          size at most k − 1) consisting of currently unmarked vertices; these were\n          also extended to become core sets. A final step involved merging the computed core sets on\n          the basis of weak edges connecting them.\n\nIn the core set merging step, we constructed an FFAS (Fold and Function Assignment\n          System) profile [39] for each core\n          set using the longest sequence in the core set as query. FFAS was then used to carry out\n          profile–profile comparisons in order to merge the core sets into larger sets of related\n          sequences. Due to computational constraints imposed by the number of core sets, profiles\n          were built on only core sets containing at least 20 sequences.\n\nFinal recruitment involved constructing a PSI-BLAST profile [40] on core sets of size 20 or more (using the longest\n          sequence in the core set as query) and then using PSI-BLAST (–z 1 × 109, –e 10)\n          to recruit as yet unclustered sequences or small-sized clusters (size less than 20) to the\n          larger core sets. For a sequence to be recruited, the sequence–profile match had to cover\n          at least 60% of the length of the sequence with an E-value ≤ 1 ×\n            10−7. In a final step, unclustered sequences were recruited to the clusters\n          using their BLAST search results. A length-based threshold was used to determine if the\n          sequence is to be recruited.\n\n        Identification of clusters containing shadow ORFs.\n        \nA well-known problem in predicting coding intervals for DNA sequences is shadow ORFs. The\n          key requirement that coding intervals not contain in-frame stop codons requires that\n          coding intervals be subintervals of ORFs. Long ORFs are therefore obvious candidates to be\n          coding intervals. Unfortunately, the constraints on the coding interval to be an ORF often\n          cause subintervals and overlapping intervals of the coding interval to also be ORFS in one\n          of the five other reading frames (two on the same strand and three on the opposite\n          strand). These coincidental ORFs are called shadow ORFs since they are found in the shadow\n          of the coding ORF. In rare cases (and more frequently in certain viruses) coding intervals\n          in different reading frames can overlap but usually only slightly. Overwhelmingly distinct\n          coding intervals do not overlap. However, this constraint is not as strict for ORFs that\n          contain a coding interval, as the exact extent of the coding interval is not known.\n          Prokaryotes predominate in these data and are the focus of the ORF predictions. Their 3′\n          end of an ORF is very likely to be part of the coding interval because a stop codon is a\n          clear signal for the termination of both the ORF and the coding interval (this signal\n          could be obscured by frameshift errors in sequencing). The 5′ end is more problematic\n          because the true start codon is not so easily identified and so the longest ORF with a\n          reasonable start codon is chosen and this may extend the ORF beyond the true coding\n          interval. For this reason different criteria were set for when ORFs have a significant\n          overlap depending on the orientation (or the 5′ or 3′ ends) of the ORFs involved. Two ORFs\n          on the same strand are considered overlapping if their intervals overlap by at least 100\n          bp. Two ORFs that are on the opposite strands are considered overlapping either if their\n          intervals overlap by at least 50 bp and their 3′ ends are within each others intervals, or\n          if their intervals overlap by at least 150 bp and the 5′ end of one is in the interval of\n          the other.\n\nORFs for coding intervals are clustered based on sequence similarity. In most cases this\n          sequence similarity is due to the ORFs evolving from a common ancestral sequence. Due to\n          functional constraints on the protein being coded for by the ORF, some sequence similarity\n          is retained. There are no known explicit constraints on the shadow ORFs to constrain drift\n          from the ancestral sequences. However, the shadow ORFs still tend to cluster together for\n          some obvious reasons. The drift has not yet obliterated the similarity. There are implicit\n          constraints due to the functional constraints on the overlapping coding ORF. There are\n          also other possible unknown functional constraints beyond the coding ORF. At first it was\n          surmised that within shadow ORF clusters the diversity should be higher than for the\n          coding ORF, but this did not prove to be a reliable signal. The apparent problem is that\n          the shadow ORFs tend to be fractured into more clusters due to the introduction of stop\n          codons that are not constrained because the shadow ORFs are noncoding. What rapidly became\n          apparent is that the most reliable signal that a cluster was made up of shadow ORFs is\n          that the cluster was smaller than the coding cluster containing the ORFs overlapping the\n          shadow ORFs.\n\nThe basic rule for labeling a cluster as a shadow ORF cluster is that the size of the\n          shadow ORF cluster is less than the size of another cluster that contained a significant\n          proportion of the overlapping ORFs for the shadow ORF cluster. A specific set of rules was\n          used to label shadow ORF clusters based on comparison to other clusters that contained\n          ORFs overlapping ORFS in the shadow ORF cluster (called the overlapping cluster for this\n          discussion). First, the overlapping cluster cannot be the same cluster as the shadow ORF\n          cluster (there are sometimes overlapping ORFs within the same cluster due to frameshifts).\n          Second, both the redundant and nonredundant sizes of the shadow ORF cluster must be\n          smaller than the corresponding sizes of the overlapping cluster. Third, at least one-third\n          of the shadow ORFs must have overlapping ORFs in the overlapping cluster. Fourth, less\n          than one-half of the shadow ORFs are allowed to contain their overlapping ORFs (this test\n          is rarely needed but did eliminate the vast majority of the very few obvious false\n          positives that were found using these rules). Finally, the majority of the shadow ORFs\n          that overlapped must overlap by more than half their length.\n\nWhen using this rule, 1,274,919 clusters were labeled as shadow ORF clusters, and\n          6,570,824 singletons were labeled as shadow ORFs. The rules need to be somewhat\n          conservative so as not to eliminate coding clusters. To test these rules, clusters\n          containing at least two NCBI-nr sequences were examined. Two sequences were used instead\n          of one because occasional spurious shadow ORFs have been submitted to NCBI-nr. There were\n          989 shadow ORF clusters containing at least two NCBI-nr sequences and with more than\n          one-tenth as many NCBI-nr sequences as the overlapping cluster. This was 0.86% of all\n          clusters (114,331 in total) with at least two NCBI-nr sequences. Of these 989, a few were\n          obvious mistakes, and the others involved very few NCBI-nr sequences of dubious curation,\n          such as “hypothetical.” Just to be conservative, all of these 989 clusters were rescued\n          and not labeled as shadow ORF clusters.\n\n        Ka/Ks test to determine if sequences in a cluster are under selective\n          pressure.\n        \nFor a cluster containing conserved but noncoding sequences, it is expected that there is\n          no selection at the codon level. We checked this by computing the ratio of nonsynonymous\n          to synonymous substitutions (Ka/Ks test) [130,131] on the DNA\n          sequences from which the ORFs in the cluster were derived. For most proteins, Ka/Ks ≪ 1,\n          and for proteins that are under strong positive selection, Ka/Ks ≫ 1. A Ka/Ks value close\n          to 1 is an indication that sequences are under no selective pressure and hence are\n          unlikely to encode proteins [134,135]. Weakly selected\n          but legitimate coding sequences can have a Ka/Ks value close to 1. These were identified\n          to some extent by using a model in which different partitions of the codons experience\n          different levels of selective pressure. A cluster was rejected only if no partition was\n          found to be under purifying selection at the amino acid level.\n\nThe Ka/Ks test [130,131] was run only on those clusters\n          (remaining after the shadow ORF filtering step) that did not contain sequences with HMM\n          matches or have NCBI-nr sequences in them. Only the nonredundant sequences in a cluster\n          were considered. Sequences in each of the clusters were aligned with MUSCLE [134]. For each cluster, a strongly\n          aligning subset of sequences was selected for the Ka/Ks analysis. The codeml program from\n          PAML [135,136] was run using model M0 to calculate an overall\n          (i.e., branch- and position-independent) Ka/Ks value for the cluster. Clusters with Ka/Ks\n          ≤ 0.5, indicating purifying selection and therefore very likely coding, were considered as\n          passing the Ka/Ks filter. In addition, the remaining clusters were examined by running\n          codeml with model M3. This partitioned the positions of the alignment into three classes\n          that may be evolving differently (typically, a few positions may be under positive\n          selection while the remainder of the sequence is conserved). A likelihood ratio test was\n          applied to select clusters for which M3 explained the data significantly better than M0\n            [136]. If a cluster was thus\n          selected, and if one of the resulting partitions had a Ka/Ks ≤ 0.5 and comprised at least\n          10% of the sequence, then that cluster was also considered as passing the Ka/Ks filter.\n          All other clusters were marked as containing spurious ORFs.\n\n        Statistics for the various stages of the clustering process\n        \nThe number of sequences that remain after redundancy removal (at 98% similarity) for each\n          dataset is given in Table 12. Recall\n          that the size of a cluster is the number of nonredundant sequences in it.\n\nNumber of core sets of size two or more totals 1,586,454; number of nonredundant\n          sequences in core sets of size two or more totals 8,337,256; and total number of sequences\n          in core sets of size two or more is 12,797,641.\n\nTotal number of clusters after profile merging and (PSI-BLAST and BLAST) recruitment is\n          1,871,434; number of clusters of size two or more totals 1,388,287; number of nonredundant\n          sequences in clusters of size two or more totals 11,494,078; total number of sequences in\n          clusters of size two or more is 16,565,015.\n\nThe final clustering statistics (after shadow ORF detection and Ka/Ks tests) are as\n          follows: number of clusters of size two or more totals 297,254; number of nonredundant\n          sequences in clusters of size two or more totals 6,212,610; total number of sequences in\n          clusters of size two or more is 9,978,637.\n\nIn the final BLAST recruitment step, a pattern was seen involving highly compositionally\n          biased sequences that recruited unrelated sequences to clusters. This was reflected in the\n          pre- and post-BLAST recruitment numbers, where the postrecruitment sizes were more than\n          three to four times the size of the prerecruitment numbers. There were 75 such clusters,\n          and these were removed.\n\n        Searching sequences using profile HMMs.\n        \nThe full set of 7,868 Pfam release 17 models was used, along with additional nonredundant\n          profiles from TIGRFAM (1,720 of 2,443 profiles; version 4.1). HMM profiling was carried\n          out using a TimeLogic DeCypher system (Active Motif, Inc., http://www.activemotif.com) and took 327 hours in total (on an eight-card\n          machine). A sequence was considered as matching a Pfam (fragment model) if its sequence\n          score was above the TC score for that Pfam and had an E-value ≤ 1 ×\n            10−3. It was considered as matching a TIGRFAM if the match had an\n            E-value ≤ 1 × 10−7.\n\n        Evaluation of protein prediction via clustering.\n        \nOur evaluation of protein prediction via the clustering shows a very favorable comparison\n          to currently used protein prediction methods for prokaryotic genomes. We used the PG\n          dataset for this evaluation (Table\n          2). Of the 3,049,695 PG ORFs, 575,729 sequences (19%) were clustered (the\n            clustered set). Of the 614,100 predictions made by the genome projects,\n          600,911 sequences could be mapped to the PG ORF set (the submitted set);\n          93% of the unmapped sequences were &lt;60 aa (recall that the ORF calling procedure\n          only produced ORFs of length ≥60 aa). The clustered set and submitted set had 493,756 ORFs\n          in common. Of the 107,155 sequences that were only in the submitted set, 24,217 sequences\n          (23%) had HMM matches. As with other unclustered HMM matches, most were weak or partial.\n          These sequences had an average of only 48% of their lengths covered by HMMs. Of the\n          remaining 82,938 sequences that did not have an HMM match, 13,724 (17%) were removed by\n          the filters used, and the rest fell into clusters with only one nonredundant sequence (and\n          thus were not labeled as predicted proteins by the clustering analysis). Based on NCBI-nr\n          sequences in them, these clusters were mostly labeled as “hypothetical,” “unnamed,” or\n          “unknown.” Our clustering method identified 81,973 ORFs not predicted by the genome\n          projects, of which 16,042 (20%) were validated by HMM matches (with average HMM coverage\n          of 69% of sequence length) and an additional 27,120 (33%) had significant BLAST matches\n            (E-value ≤ 1 × 10−10) to sequences in NCBI-nr. Thus, if the\n          submitted set is considered as truth, then protein prediction via clustering produces\n          493,756 true positives (TP), 81,973 false positives (FP), and 107,155 false negatives\n          (FN), thereby having a sensitivity (TP/[TP + FN]) of 83% and specificity (TP/[TP + FP]) of\n          86%. However, if truth is considered as those sequences that are common to both the\n          clustered and submitted sets in addition to those sequences with HMM matches, then our\n          protein prediction method via clustering has 95% sensitivity and 89% specificity, while\n          protein prediction by the prokaryotic genome projects has 97% sensitivity and 86%\n          specificity.\n\n        Evaluation of protein clustering.\n        \nWe used Pfams to evaluate the clustering method in two ways. For both evaluations the\n          clustering was restricted to only those sequences with Pfam matches. It should be kept in\n          mind that there are redundancies among Pfams in that there can be more than one Pfam for a\n          homologous domain family (for instance, the kinase domain Pfams—PF00069 protein kinase\n          domain and PF07714 protein tyrosine kinase), and these redundancies can affect the\n          evaluation statistics reported below.\n\nFor the first evaluation, each sequence was represented by the set of Pfams that match\n          it. This is referred to as the domain architecture for a sequence. While\n          Pfams provide a domain-centric view of proteins, the domain architecture attempts to\n          approximate the full sequence-based approach used here, and thus could be used to shed\n          light on the general performance of the clustering. We measured how often unrelated\n          sequences were present in a given cluster. Two sequences were defined to be unrelated if\n          their domain architectures each had at least one Pfam that was not present in the other's\n          domain architecture. Note that this measure did not penalize the case when the domain\n          architecture of one sequence was a proper subset of the domain architecture of the other\n          sequence. This was done to allow fragmentary sequences in clusters to be included in the\n          evaluation as well (and also because it is not always easy to determine whether an amino\n          acid sequence is fragmentary or not). For each cluster, we computed the percentage of\n          sequence pairs that are unrelated under this measure. A total of 92% of the clusters had\n          at most 2% unrelated pairs. Then we carried out an assessment of how many instances of a\n          given domain architecture appear in a single cluster. A total of 58% of the domain\n          architectures were confined to single clusters (i.e., 100% of their occurence is in one\n          cluster), and 88% of the domain architectures was such that &gt;50% of their\n          occurences is in one cluster.\n\nFor the second evaluation, we selected all sequences with Pfam matches, and each sequence\n          was assigned to the Pfam that matches it with the highest score. With this assignment, the\n          Pfams induce a partition on the sequences. The distribution of the number of sequences in\n          clusters induced by the Pfams was compared to those of clusters from the clustering\n          method. Figure 12A shows comparison as\n          a log–log plot of the number of sequences versus the number of clusters with at least that\n          many sequences for the two cases. The plot shows that cluster size distributions are quite\n          similar, with both the methods having an inflection point around 2,500. The difference\n          between the two curves is that there are more big clusters (and also fewer small clusters)\n          induced by the Pfams as compared to the clustering method. This can be explained by noting\n          that two sequences that are in the same Pfam cluster can nevertheless be put into\n          different clusters by the clustering method if they differ in their remaining\n          portions.\n\nOur clustering also shows a good correspondence with HMM profiling on the phylogenetic\n          markers that we looked at. The clustering identifies 7,423, 12,553, and 13,657 sequences,\n          respectively, for RecA (cluster ID 1146), Hsp70 (cluster ID 197), and RpoB (cluster ID\n          1187). HMM profiling identifies 5,292, 12,298, and 12,165 sequences, respectively, for\n          these families. For each of these families, there are at least 94% of sequences (relative\n          to the smaller set) in common between clustering and HMM profiling.\n\n        Difference in ratio of predicted proteins to total ORFs for the PG set and the GOS\n          set.\n        \nThe ratio of clustered ORFs to total ORFs is significantly higher for the GOS ORFs\n          (0.3471) compared to the PG ORFs (0.1888). This can be explained by the fragmentary nature\n          of the GOS data. For the large majority of the GOS data, the average sequence length is\n          920 bp compared to full-length genomes for the PG data. For the PG data, clustered ORFs\n          have a mean length of 325 aa and a median length of 280 aa. Unclustered ORFs have a mean\n          length of 119 aa and a median length of 87 aa. Assuming that the genomic GOS data has a\n          similar underlying ORF structure to PG data, the effect that GOS fragmentation had on ORF\n          lengths is estimated. Each reading frame will have a mixture of clustered and unclustered\n          ORFs, but on average there will be 2 ORFs per reading frame per 920-bp GOS fragment, and\n          both ORFs will be truncated. Assuming the truncation point for the ORF is uniformly\n          distributed across the ORF, the truncated ORF will drop below the 60-aa threshold to be\n          considered as an ORF with a probability of 60/(length of the ORF). Using the median\n          length, the percentage of clustered ORFs dropping below the threshold due to truncation is\n          21%; for unclustered ORFs, it is 69%. Accounting for this truncation, the expected ratio\n          of clustered ORFs to total ORFs for the GOS ORFs based on the PG ORFs would be 0.3708,\n          which is very close to the observed value.\n\n        Kingdom assignment strategy and its evaluation.\n        \nWe used several approaches to assign kingdoms for GOS sequences. They are all\n          fundamentally based upon a strategy that takes into account top BLAST matches of a GOS\n          sequence to sequences in NCBI-nr, and then voting on a majority.\n\nWe evaluated a simple strict-majority voting scheme (of the top four BLAST matches) using\n          the NCBI-nr set. First, the redundancy in NCBI-nr was removed using a two-staged process.\n          A nonredundant set of NCBI-nr sequences was computed involving matches with 98% similarity\n          over 95% of the length of the shorter sequence (using the procedure discussed in Materials and Methods [Identification of nonredundant\n          sequences]). This set was made further nonredundant by considering matches involving 90%\n          similarity over 95% of the length of the shorter sequence. The nonredundant sequences that\n          remained after this step constituted the evaluation dataset S. For each\n          sequence in S, its top four BLAST matches to other sequences in\n            S (ignoring self-matches) were used to assign a kingdom for it (based\n          on a strict majority rule). This predicted kingdom assignment for the sequence was\n          compared to its actual kingdom. A correct classification is obtained for 93% of the\n          sequences. The correct classification rate per kingdom is given in Table 13.\n\nWhile this evaluation shows that the BLAST-based voting scheme provides a reasonable\n          handle on the kingdom assignment problem, there are caveats associated with it. The\n          kingdom assignment for a set of query sequences is greatly influenced by the taxonomic\n          groups from each kingdom that are represented in the reference dataset against which these\n          queries are being compared. If certain taxa are only sparsely represented in the reference\n          set, then, depending on their position in the tree of life, queries from these taxa can be\n          misclassified (using a nearest-neighbor type approach based on BLAST matches). This\n          explains why the archaeal classification rate is quite low compared to the others. Thus,\n          the true classification rate for the GOS dataset based on this approach will also depend\n          on the differences in taxonomic biases in the GOS dataset (query) and the NCBI-nr set\n          (reference).\n\nThe kingdom proportion for the GOS dataset reported in Figure 1 is based on a kingdom assignment of scaffolds.\n          Those GOS ORFs with BLAST matches to NCBI-nr were considered, and the top-four majority\n          rule was used to assign a kingdom to each of them. Using the ORF coordinates on the\n          scaffold, the fraction (of bp) of a scafffold assigned to each kingdom was computed. The\n          scaffold was labeled as belonging to a kingdom if the fraction of the scaffold assigned to\n          that kingdom was &gt;50%. All ORFs on this scaffold were then assigned to the same\n          kingdom.\n\n        Cluster size distribution, the power law, and the rate of protein family\n          discovery.\n        \nEarlier studies of protein family sizes in single organisms [137–139] have suggested that P(d), the frequency\n          of protein families of size d, satisfies a power law: that is,\n            P(d) ≈ d −\n          β with exponent β reported between 2.68 and 4.02. Power laws have been used to\n          model various biological systems, including protein–protein interaction networks and gene\n          regulatory networks [42,43]. Figure 12B illustrates the distribution of the cluster\n          sizes from our data on a log–log scale, a scale for which a power law distribution gives a\n          line. In contrast to family size distributions reported in single organisms, the cluster\n          sizes from our data are not well described by a single power law. Rather, there appear to\n          be different power laws: one governs the size distribution of very large clusters, and\n          another describes the rest. This behavior is observed both in the distribution of the core\n          set sizes and also in the distribution of the final cluster sizes. We identified an\n          inflection point for both the core set distribution and the final clusters at around size\n          2,500, and estimated the power law exponent β via linear regression separately in each\n          size regime. For the core set distribution, the exponent β = 1.99\n            (R2 = 0.994) for clusters of size ≤ 2,500, and β = 3.34\n            (R2 = 0.996) for clusters of size &gt; 2,500. For the\n          final cluster sizes, the exponent β = 1.72 (R2 = 0.995) for\n          clusters of size ≤ 2,500, and β = 2.72 (R2 = 0.995) for\n          clusters of size &gt; 2,500. The estimates for β are different for the core clusters\n          compared to the final clusters, reflecting a larger number of medium and large clusters in\n          the final clustering as a result of the cluster-merging and additional recruitment steps.\n          A similar dichotomy between the size distributions of large and small protein families was\n          observed in a study [140] of protein\n          families contained in the ProDom, Protomap, and COG databases, where the exponent β\n          reported was in the range of 1.83 to 1.98 for the 50 smallest clusters and 2.54 to 3.27\n          for the 500 largest clusters in these databases.\n\nOur clustering method was run separately on the following seven datasets: set 1 consisted\n          of only NCBI-nr sequences; set 2 consisted of all sequences in NCBI-nr, ENS, TGI-EST, and\n          PG; sets 3 through 6 consisted of set 2 in combination with a random subset of 20%, 40%,\n          60%, and 80% of the GOS sequences, respectively; set 7 consisted of set 2 in combination\n          with all the GOS sequences. On each of the seven datasets, the redundancy removal (using\n          the 98% similarity filter) was run, followed by the core set detection steps. Figure 2 shows the number of core sets of\n          varying sizes (≥3, ≥5, ≥10, and ≥20) as a function of the number of nonredundant sequences\n          for each dataset.\n\nThe observed linear growth in number of families with increase in sample size\n            n is related to the power law distribution in the following way. We\n          model protein families as a graph where each vertex corresponds to a protein sequence and\n          an edge between two vertices indicates sequence similarity between the corresponding\n          proteins. Consider a clustering (partitioning) of the vertices of a graph with\n            n vertices such that the cluster sizes obey a power law distribution.\n          Let C\n            d\n          (n) [respectively,\n            C≥d(n)] denote the number of clusters of\n          size d (respectively, ≥d). Since the distribution of\n          cluster sizes follows a power law, there exist constants α, β such that\n          for all x ≤ n,\n            Cx(n) =\n            αx−β.\n\nAs every vertex of the graph is a member of exactly one cluster, The number of clusters of size at least d is Combining the two equations, we obtain values (up to a multiplicative\n          constant) for C≥d(n) as\n          shown in Table 14. In all cases with\n          β &gt; 1, the number of clusters\n            C≥d(n) increases as\n            n increases, and as d decreases. Specifically, for β\n          &gt; 2, the growth is linear in n for all d, with\n          slope decreasing as d increases. For 1 &lt; β &lt; 2, the growth\n          is sublinear in n for all d. \n\nNote that while the observed distribution of protein family sizes is fit by two different\n          power laws, one for clusters of size less than 2,500 with β = 1.99 and another for\n          clusters of size greater than 2,500 with β = 3.34 for the current number of (nonredundant)\n          sequences, the contribution of large families to the rate of growth is negligible compared\n          to the small families.\n\nThe above formulas for\n            C≥d(n) also suggest the\n          dependence of the rate of growth of clusters on the cluster size d. For\n          example, in the case when β is very close to 2, for some constant m. Thus, the rate of growth of cluster\n          sizes is linear, and the slope m(d) of rate of growth is\n          given by m(d) = md1−β. Figure 13 shows how well the observed\n          rates of growth match the values predicted by this equation. A fit to a sublinear function\n          (not shown) also gives similar results as in Figure 13. \n\n        GOS versus known prokaryotic versus known nonprokaryotic.\n        \nExamples of top five clusters in the various categories (except GOS-only) are given\n          below. The cluster identifiers are in parentheses.\n\nKnown prokaryotic only: (Cluster ID 1319) outer surface protein in Anaplasma\n            ovis, Wolbachia, Ehrlichia canis; (Cluster ID 10911) nitrite reductase in\n          uncultured bacterium; (Cluster ID 1266) outer membrane lipoprotein in\n            Borrelia; (Cluster ID 8595) methyl-coenzyme M reductase subunit A in\n          uncultured archaeon; (Cluster ID 2959) outer membrane protein in\n            Helicobacter. Known nonprokaryotic only: (Cluster ID 2226) Pol\n          polyprotein HIV sequences; (Cluster ID 4023) maturase K; (Cluster ID 6257) NADH\n          dehydrogenase subunit 2; (Cluster ID 8644) HIV protease; (Cluster ID 12196) MHC class I\n          and II antigens. GOS and known prokaryotic only: (Cluster ID 3369) carbamoyl transferase;\n          (Cluster ID 688) apolipoprotein N-acyltransferase; (Cluster ID 3726) potassium uptake\n          proteins; (Cluster ID 300) primosomal protein N′; (Cluster ID 4605) DNA polymerase III\n          delta subunit. GOS and known nonprokaryotic only: (Cluster ID 186) seven transmembrane\n          helix receptors; (Cluster ID 2069) zinc finger proteins; (Cluster ID 3092) MAP kinase;\n          (Cluster ID 1413) potential mitochondrial carrier proteins; (Cluster ID 233)\n          pentatricopeptide (PPR) repeat-containing protein. Known prokaryotic and known\n          nonprokaryotic only: (Cluster ID 3510) immunoglobulin (and immunoglobulin-binding)\n          proteins; (Cluster ID 600) expansin; (Cluster ID 50) pectin methylesterase; (Cluster ID\n          6492) lectin; (Cluster ID 986) BURP domain-containing protein. GOS and known prokaryotic\n          and known nonprokaryotic: (Cluster ID 2568) ABC transporters; (Cluster ID 49) short-chain\n          dehydrogenases; (Cluster ID 4294) epimerases; (Cluster ID 1239) AMP-binding enzyme;\n          (Cluster ID 2630) envelope glycoprotein.\n\n        Neighbor functional linkage methods.\n        \nFor the sequences in each GOS-only cluster, we determined if neighboring ORFs occurring\n          on the same strand had a similar biological process in the GO [49]. If this shared biological process of the neighbors\n          occurred statistically more often than expected by chance, that inferred a potential\n          operon linkage and a biological process term for the GOS-only cluster. This approach\n          weighted ORFs by sequence similarity to reduce the skewing effect of sequences from highly\n          related organisms.\n\nFor definition of linked ORFs, we collected pairs of same-strand ORF protein predictions\n          with intergenic distances less than 500 bp. Negative distances were possible if the 5′ end\n          of the downstream ORF in the pair occurred 5′ to the 3′ end of the upstream ORF. We used a\n          probability function to estimate the probability that two putative genes belong to the\n          same operon given their intergenic distance [47]. Because sequences come from a variety of unknown organisms, the probability\n          distribution was created by averaging properties of 33 randomly chosen divergent genomes.\n          The exact choice of genomes did not greatly affect the ability of the distribution to\n          separate experimentally determined same-operon gene pairs from adjacent, same-strand gene\n          pairs in different known operons annotated in a version of RegulonDB downloaded on March\n          29, 2005 [141].\n\nWe measured the functional linkage between two protein clusters by searching for all\n          occurrences of nearby pairs of ORFs belonging to the two clusters of interest.\n          Sufficiently close pairs were more likely to be encoded in the same operon. We devised a\n          scoring mechanism to reward those pairs of clusters for which many divergent examples of\n          likely operon pairs existed in the set of ORF pairs. For each pair of clusters, a weight\n          was applied to the contribution of each pair of ORFs, and this was proportional to how\n          similar the pair of ORFs was to other example pairs. Thus, many near-identical pairs of\n          ORFs, likely from the same or similar species, are not overrepresented in the final\n          cluster pair score, while conserved examples of neighboring position from more divergent\n          sequences contribute an increased weight. The score for each cluster pair is calculated\n          as: where S(C1C2) is the linkage score\n          of clusters C1 and C2. The probability \n          \n          that any two genes \n          \n          from C1 and \n          \n          from C2 are in an operon is dependent on the distance between them as\n          calculated by [47], and is weighted\n          according to the sequence weights \n          \n          and \n          \n          described below, for all example pairs i. \n\nWe calculated sequence weights in a manner similar to that used in progressive multiple\n          sequence alignment [142]. Briefly,\n          neighbor-joining trees were built for all clusters using the QuickJoin [143] and QuickTree programs [144] based on a distance matrix\n          constructed from all-against-all BLAST scores within a cluster, normalized to self-scores.\n          For those few clusters with more than 30,000 members, trees were not built. Instead, equal\n          sequence weights for all members were assigned because of computational limitations. The\n          root of each tree was placed at the midpoint of the tree by using the retree package in\n          PHYLIP [145]. The individual sequence\n          weights were then computed by summing the distance from each leaf to the root after\n          dividing each branch's weight by the number of nodes in the subtree below it. Weights were\n          normalized so that the sum of weights in any given tree was equal to 1.0. This weighting\n          scheme is superior to one in which weights are normalized to the largest weight in the\n          tree, one that does not weight sequences according to divergence, and one that only\n          considers the number of example pairs seen (Figure 14). To compare the different scoring methods, pairs of clusters\n          annotated with GO terms that contained adjacent ORFs in the data were gathered. These\n          pairs were divided into into functionally related and unrelated clusters based on a\n          measure of GO term similarity (p-value ≤ 0.01) [146]. We evaluated scoring methods for the ability to\n          recover functionally similar pairs. In all analyses, linkages between clusters were\n          ignored if there were fewer than five examples of cluster member ORFs adjacent to each\n          other on a scaffold.\n\nFunction for novel families was inferred as follows. (1) Assignment of GO terms to\n          clusters. We downloaded the GO [49]\n          database on September 21, 2005, from http://www.geneontology.org, along with the files\n          gene_association.goa_uniprot and pfam2go.txt dated July 12, 2005. Only the biological\n          process component of the ontology was considered. If a cluster had at least 10% of its\n          redundant sequences annotated by the most abundant Pfam domain for that cluster, and that\n          Pfam domain had a GO biological process term provided by the pfam2go mapping, then we\n          assigned a cluster the GO term of its most abundant Pfam annotation. In addition, if a\n          cluster contained at least 20% of its Uniprot GO annotations the same, it was assigned\n          that GO term. For each cluster, redundant GO terms found on the same path to the root were\n          removed. (2) Identification of neighbors to GOS-only clusters. Neighbors of GOS-only\n          clusters were defined as those clusters that had a cluster linkage score above a\n          predetermined threshold (1 × 10−6) and had at least five examples of cluster\n          members adjacent to each other in the data. These neighbors were then screened for those\n          that had been annotated with a GO term by the process described above. (3)\n          Overrepresentation of neighbor GO terms. We attempted to define GO terms for a set of\n          GOS-only neighbors that were statistically overrepresented. Because of the highly\n          dependent nature of the terms in the GO, a simulation-based approach was chosen to\n          determine which terms might be overrepresented. Annotated neighbors to a cluster of\n          unknown function were identified as described above. For each annotated neighbor, counts\n          for the associated GO term and all terms on the path to the root of the ontology were\n          incremented. A total of 100,000 simulated neighbor lists of the same size as the true\n          neighbor list were computed by selecting without replacement from those clusters with\n          annotated GO terms, and an identical counting scheme was performed for each simulation.\n          Overrepresentation of neighbor terms was calculated for each term on the ontology by\n          asking how many times out of the 100,000 simulations the count for each GO term in the\n          ontology met or exceeded the observed count for the actual neighbors. This fraction of\n          simulations was interpreted as a p-value. If a term is unusually\n          prevalent in the true observed neighbors, it should be relatively infrequent in the\n          simulated data. For the purpose of the metric used here, “is-a” and “part-of”\n          relationships were treated equally. In cases where a cluster had more than one GO term\n          assigned to it, any redundant terms occurring on each other's path to the root were first\n          removed. For any remaining clusters with nonredundant, multiple GO annotations, all\n          possible lists of functions for each list of neighbor clusters were enumerated, and one\n          function from each cluster was chosen. Each node in the ontology was assigned the maximum\n          count observed from the enumerated function lists. We consistently applied this rule for\n          the observed and simulated data.\n\nThe following descriptive measures of the novel GOS-only cluster set were obtained.\n          Transmembrane helix prediction was carried out with the programs TMHMM [147] and SPLIT4 [148]. GC content was calculated as (G + C)/(G + C + A +\n          T) bases for each ORF in a cluster, and averaged for each cluster within a set. The GC\n          content, reported as the mean and standard deviation of the cluster averages, is as\n          follows for each cluster set: Group I, 36.7% ± 8.0%; Group II, 35.9% ± 7.9%. Group I\n          size-matched sample, 48.8% ± 11.1%; Group II size-matched sample, 49.5% ± 11.2%; Group I\n          viral fraction, 37.8% ± 5.1%; Group II viral fraction, 37.3% ± 4.6%. To address the\n          interconnectivity of the novel clusters within the context of all operon linkages, we\n          constructed a graph with clusters as nodes and inferred operon linkages (with score ≥ 1 ×\n            10−6) as edges. We then asked for every node in the set of novel clusters\n          what was the cumulative fraction of novel nodes that could be reached within a varying\n          edge distance from the starting node. The expectation of this fraction was calculated at\n          each distance, and the procedure was repeated for the set of size-matched clusters (Figure 15).\n\nWe tried three different BLAST-based approaches for kingdom assignment of ORFs. The first\n          method, used in the analysis, required a majority of the four top BLAST matches to vote\n          for the same kingdom (archaea, bacteria, eukaryota, or viruses; see Materials and Methods [Kingdom assignment strategy and its evaluation]).\n          The second method required all eight top BLAST matches to vote for the same kingdom. The\n          last method we used was the scaffold-based kingdom assignment described in Materials and Methods (Kingdom assignment strategy and\n          its evaluation). Figure 16 shows the\n          results of using these assignments to infer the kingdom of GOS-only clusters (Figure 16D–16F) and their neighboring ORFs (Figure 16A–16C). GOS-only clusters were assigned a kingdom only if &gt;50% of their\n          neighboring ORFs were assigned the same kingdom. The general trends observed are the same\n          for each method, though the coverage decreases slightly for the more stringent\n          methods.\n\n        Characteristics and kingdom distribution of known protein domains.\n        \nFor these analyses we used the predicted proteins from the public (NCBI-nr, PG, TGI-EST,\n          and ENS) and GOS datasets. The public dataset contains multiple identical copies of some\n          sequences due to overlaps between the source datasets. For example, many sequences in PG\n          are also found in NCBI-nr. We filtered the public set at 100% identity to avoid\n          overcounting these sequences. Because this filtering was necessary for the public dataset,\n          the GOS dataset was also filtered at 100% identity. If two or more sequences were 100%\n          identical at the residue level, but were of different lengths, only the longest sequence\n          was kept. The resulting datasets of nonredundant proteins are referred to as public-100\n          and GOS-100.\n\nWe assigned each protein in public-100 to a kingdom based on the species annotations\n          provided in the source datasets (NCBI-nr, Ensembl, TIGR, and PG). The NCBI taxonomy tree\n          was used to determine the kingdom of each species. Of 3,167,979 protein sequences in\n          public-100, 3,158,907 can be annotated by kingdom. The remaining 9,072 sequences are\n          largely synthetic.\n\nDetermining the kingdom of origin of an environmental sequence can be difficult; while an\n          unambiguous assignment can be made for some sequences, others can be assigned only\n          tentatively or not at all. Therefore, we took a probabilistic approach (kingdom-weighting\n          method), calculating “weights” or probabilities that each protein sequence originated from\n          a given kingdom.\n\nThe top four BLAST matches (E-value &lt; 1 × 10−10) of\n          GOS ORFs to NCBI-nr were considered. The kingdom of origin for each match was determined.\n          We pooled these “kingdom votes” for each scaffold, since (presuming accurate assembly)\n          each scaffold must come from a single species and hence from a single kingdom. Each ORF on\n          a scaffold contributed up to four votes. If an ORF had fewer than four BLAST matches with\n          an E-value &lt; 1 × 10−10, then it contributed fewer\n          votes. ORFs with no BLAST matches contributed no votes.\n\nIn many cases, the votes were not unanimous, indicating that some uncertainty must be\n          associated with any kingdom assignment. An additional source of uncertainty is the finite\n          number of votes. We accounted for these statistical issues by applying the following\n          procedure to each scaffold. First, two pseudocounts were added to the votes for the\n          “unknown” kingdom to represent the uncertainty that remains even when votes are unanimous\n          (especially when there are few votes). The frequency of votes for each kingdom was\n          calculated. The vote frequency for a kingdom provides the maximum likelihood estimate of\n          the kingdom probability (i.e., the vote frequency that would have been observed on a\n          scaffold of similar composition but with infinitely many voting ORFs). However, that\n          estimate may not be accurate or precise. Therefore, the multinomial standard deviation was\n          calculated for each vote frequency p as SQRT [p × (1 −\n            p)/(n − 1)], where n is the number of\n          votes. A distance of two standard deviations from the mean corresponds roughly to a 95%\n          confidence interval. Thus, two standard deviations were subtracted from each vote\n          frequency, and called the result (or zero, if the result was negative) the “kingdom\n          weight.” This “kingdom weight” is a conservative estimate. There is 95% chance that the\n          actual kingdom probability is greater.\n\nThe kingdom weights do not sum to one because of the standard deviation penalty. The\n          difference between the sum of the kingdom weights and unity is a measure of the total\n          uncertainty about the kingdom assignment. This is called the “unknown weight.”\n\nFinally, we assigned each ORF the kingdom weights calculated for the scaffold as a whole.\n          This procedure assigned kingdom weights to many ORFs with no BLAST matches. Overall,\n          4,745,649 (84%) of the 5,654,638 proteins in GOS-100 receive nonzero kingdom weights.\n\nThe kingdom weights calculated in this way provide a basis for estimating the proportion\n          of sequences originating from each kingdom, p\n            GOS\n          (K). The weights over all sequences in GOS-100 were summed for each\n          of the known kingdoms, and divided by the sum of the weights for all kingdoms (excluding\n          the unknown weight). This procedure suggested that 96% of the sequences are bacterial, a\n          somewhat higher proportion than is estimated by the method described in Materials and Methods (Kingdom assignment strategy and\n          its evaluation). Similarly, kingdom proportions,\n            pGOS–Pfam(K), were calculated for\n          the subset of GOS-100 sequences that have a significant Pfam hit, and 97% are found to be\n          bacterial.\n\nWe used the kingdom weights directly in the analyses where possible (e.g., to calculate\n          the expected kingdom distribution of a given set of proteins by summing the weights).\n          However, it was necessary in some cases to use discrete assignments of a single kingdom to\n          each ORF. A tentative assignment can be made for a given scaffold by choosing the kingdom\n          with the highest weight. The possibility remains, in this case, that a fraction of the\n          “unknown” weight should rightfully belong to a different kingdom. However, if a kingdom\n          weight is greater than 0.5, then this danger is averted, and a “confident” assignment of\n          the scaffold and its constituent ORFs to that kingdom can be made.\n\nGiven the uncertainty penalty above, achieving a kingdom weight greater than 0.5\n          generally requires overwhelming support for one kingdom over the others. In particular, on\n          a given scaffold, at least eight unanimous votes for a kingdom are needed (i.e., two ORFs\n          contributing four votes each) to make a confident assignment to that kingdom. Any\n          disagreement between the votes increases the required number rapidly: for instance, 15\n          votes for a single kingdom are required to override four votes for other kingdoms.\n\n“Confident” kingdom assignments were made for 2,626,178 (46%) of the 5,654,638 proteins\n          in GOS-100.\n\nIn the analysis that identified new multi-kingdom Pfams, we used the subset of\n          confidently kingdom-annotated proteins. Here, a Pfam model was designated as\n          “kingdom-specific” in public-100 if there were only matches to proteins in one particular\n          kingdom, and no “unknown” matches. A Pfam model that was kingdom specific in public-100\n          was further designated as newly “multi-kingdom” if it had matches to one or more GOS-100\n          proteins that were confidently labeled as belonging to a kingdom different from that found\n          in the public-100 matches. Also, we filtered Pfam matches with an E-value\n          cutoff of 1 × 10−10. In every case, the bit score is at least five bits greater\n          than the trusted cutoff for the model. In addition to passing the “confident” criteria,\n          the kingdom assignments were all confirmed by visual inspection of the BLAST kingdom vote\n          distributions for the respective scaffolds. Because the criteria for a “confident” kingdom\n          assignment were conservative, there were only one or a few confident assignments for each\n          domain to a “new” kingdom. The “confident” criteria are especially difficult to meet in\n          the case of kingdom-crossing due to the votes contributed by the crossing protein. For\n          instance, because the IDO domain itself always contributes four votes for “Eukaryota,” at\n          least 15 votes for “Bacteria” were required to call a scaffold “bacterial.” Thus, many\n          scaffolds have no confident kingdom assignment.\n\nWe compared the relative diversities of protein families between GOS-100 and public-100\n          as represented by Pfam sequence models. In order to do this, the number of matches\n          expected to be found for each Pfam model in the GOS-100 data was computed, assuming that\n          the matches were distributed among the models in the same proportions that they were in\n          the public-100 data. These “expected” match counts were compared with the observed counts\n          to identify domains that are more diverse in GOS-100 than in public-100 and vice\n          versa.\n\nBecause kingdoms differ in their protein usage, Pfam models match sequences from\n          different kingdoms with different frequencies, and some models match sequences exclusively\n          from one kingdom. Thus, to calculate the expected number of matches to a given Pfam in\n          GOS-100 based on the number of matches observed in public-100, we corrected for the\n          radically different kingdom composition of the two datasets.\n\nThe expected proportion of all Pfam matches in GOS-100 that are to a given model\n            M was calculated as follows. First, we made a simplifying assumption\n          that sequences from different kingdoms were equally likely to have a Pfam hit, and thus\n          that the Pfam matches in GOS-100 would be distributed among the kingdoms according to the\n          kingdom proportions calculated using the weighted method above (for instance, it is\n          assumed that 97% of the matches would be to bacterial sequences). Probability that a Pfam\n          hit in GOS-100 is from K ≈\n            pGOS-Pfam(K) (for sequences in GOS-100 with\n          at least one Pfam hit) for kingdoms K in {Archae, Bacteria, Eukaryotes,\n          Viruses}.\n\nSecond, we assumed that Pfam models match with the same relative rates within each\n          kingdom in GOS-100 as they do in public-100. For instance, since twice as many SH3 domains\n          as SH2 domains are found in public-100 eukaryotic sequences, the same ratio is expected to\n          be found in GOS-100 eukaryotic sequences. Using the public-100 data, we calculated the\n          frequency of matches for each Pfam model M within each kingdom, relative\n          to the total number of Pfam matches to that kingdom. Pseudocounts of one were added to\n          both the “match” and “no match” counts (i.e., using a uniform Dirichlet prior), to allow\n          proper statistical treatment of families with few or no matches in the public databases\n          for some kingdom. In Equation 5 below, Obspublic(M,K) is the\n          observed number of public-100 hits to M in K, and\n            Obspublic(K) is the observed number of public-100 hits to\n          all models in K. \n\nBy multiplying the conditional probability of each model given a kingdom by the\n          respective kingdom probability (pGOS-Pfam(K),\n          calculated as described above in “Kingdom annotation of GOS-100 proteins: kingdom\n          weighting method”), the proportions of Pfam matches in GOS-100 due to each combination of\n          kingdom and Pfam model were then predicted. Finally, these predictions were summed across\n          kingdoms to obtain the expected proportion of matches to each model. \n\nRelatively fewer GOS-100 sequences than public-100 sequences have a Pfam hit (likely\n          because Pfam is based on sequences in the public databases). To avoid systematically\n          overestimating the number of GOS-100 hits for each Pfam model due to this global effect,\n          the predicted counts were based on the observed total number of Pfam matches to all models\n          in GOS-100, and an attempt was made to predict only how these matches are distributed\n          among models. Thus, the expected number of Pfam hits to a given model in GOS-100 is equal\n          to the expected proportion of hits to that model, as calculated above, multiplied by the\n          total number of Pfam hits. In the equation below, ObsGOS is the total number of\n          Pfam hits to all models in GOS-100. \n\nIn summary, calculation of the expected number of Pfam hits to a model M\n          in GOS-100 for all kingdoms can be expressed in one equation as follows: where Obspublic(M,K) is the observed number of\n          public-100 hits to model M in K,\n            Obspublic(K) is the observed number of public-100 hits to\n          all models in K,\n          pGOS-Pfam(K) is the proportion of GOS-100\n          sequences that have at least one Pfam hit in K, and ObsGOS is\n          the total number of Pfam hits to all models in GOS-100. \n\nThe ratio of the observed to the predicted number of hits for each Pfam model is a\n          measure of the relative diversity of that Pfam family in GOS-100 compared to public-100,\n          corrected for the differing kingdom proportions in the two datasets. We computed the\n          significance of this ratio using the CHITEST function in Excel, which implements the\n          standard Pearson's Chi-square test with one degree of freedom and expresses the result as\n          a probability. For many protein families, the difference in diversity between the two\n          datasets was so pronounced that Excel reports a probability of zero due to numerical\n          underflow, indicating a p-value less than 1 × 10−303.\n\n        IDO analysis.\n        \nThe GOS-100 and public-100 sequences selected for the IDO family alignment matched the\n          PF01231 Pfam fs model with a score above the trusted bit-score cutoff at the sequence\n          level. In addition, the sequences were required to have the width of their matching region\n          spanning over 50% of the Pfam IDO HMM model length. Next, all sequence matches to the Pfam\n          IDO model from the NCBI-nr database downloaded on March 6, 2006, were added (these also\n          satisfied the trusted score cutoff and model alignment span criteria). An additional 26\n          IDO sequences were found in the new sequence database relative to the GOS public sequence\n          data freeze after filtering for identical and 1 aa different sequences and presence of\n          first and last residues in the final trimmed alignment. Jevtrace (version 3.14) [149] was used to assess alignment\n          quality, to remove sequences problematic for alignment, to remove sequence redundancy (at\n          the 0-aa and 1-aa difference levels) while allowing for redundant nonoverlapping\n          sequences, to trim the alignment to a block of aligned columns, to delete columns with\n          more than 50% gaps, and to remove sequences with missing first or last residues. One\n          sequence (GenBank ID 72038700) was likely a multidomain protein problematic for alignment\n          and was removed manually. This set of procedures produced a block sequence alignment of\n          144 sequences and 231 characters. We aligned sequences with MUSCLE (version 3.52) [134] using default parameters. The final\n          alignment was used to reconstruct phylogenies with a series of phylogeny reconstruction\n          methods: PHYML [150], Tree-Puzzle\n            [151], Weighbor [152], and the protpars program from the\n          PHYLIP package (version 3.6a3) [145].\n          Bootstrapping was performed with the protpars program using 1,000 bootstrap replicates,\n          each with 100 jumbles; the majority consensus tree was produced by the consense program in\n          the PHYLIP package.\n\n        Structural genomics implications.\n        \nThe Pfam5000 families used in this study were chosen from among the manually curated\n          (Pfam-A) families in from Pfam version 17. We added 2,932 families with a structurally\n          characterized representative as of October 27, 2005, to the Pfam5000 in descending order\n          by family size, followed by 2,068 additional families without a structurally characterized\n          representative, in descending order by family size. Pre-GOS family size was calculated as\n          the number of sequences in public-100 that had a match to the Pfam family. Post-GOS family\n          size was calculated as the number of sequences in public-100 and GOS-100 that matched each\n          family. We used the results of the HMM profiling effort (using Pfams) used for this\n          analysis.\n\nCoverage of GOS-100 and public-100 sequences by both versions of the Pfam5000 was\n          measured using the subset of families in Pfam 17 that were also in Pfam 16. This was done\n          in order to enable direct comparison of coverage results with a previous study of coverage\n          of fully sequenced bacterial and eukaryotic genomes [73]. The versions of Pfam are similar in size (Pfam 16\n          contains 7,677 families, and Pfam 17 contains 7,868 families).\n\n        Phylogeny construction for various families.\n        \nFor the UVDE family, sequences were aligned using MUSCLE [134] and a tree was built using QuickTree [144].\n\nFor the PP2C family, the catalytic domain portions of the sequences were identified and\n          aligned using the PP2C Pfam model. Sequences that contained ≥70% nongaps in this alignment\n          were used to generate a phylogenetic tree of all the PP2C-like sequences. The phylogeny\n          was inferred using the protdist and neighbor-joining programs in PHYLIP [145]. We used 1,941 total PP2C-like\n          sequences for the phylogenetic analysis. The breakdown was as follows: public eukaryotic\n          sequences, 73%; public bacterial sequences, 14%; GOS-eukaryotic sequences, 2%;\n          GOS-bacterial sequences, 10%; and GOS-viral and GOS-unknown sequences, less than 1%\n          combined.\n\nFor the type II GS family, sequences in GOS and NCBI-nr were searched with a type II GS\n          HMM constructed from 17 previously known bacterial and eukaryotic type II GS sequences.\n          Matching sequences from NCBI-nr and GOS were filtered separately for redundancy at 98%\n          identity; the combined set of sequences was aligned and a neighbor-joining tree was\n          constructed.\n\nFor the RuBisCO family, matching RuBisCO sequences from GOS and NCBI-nr were filtered\n          separately for redundancy at 90% identity, resulting in 724 sequences in total. The 724\n          RuBisCO sequences were then aligned and a neighbor-joining tree was constructed.\n\n        Identification of proteases.\n        \nWe clustered sequences in the MEROPS Peptidase Database [100] using CD-HIT [116,117] at 40% similarity level. This resulted in 7,081 sequences, which were then\n          divided into groups based on catalytic type and Clan identifier. These sequences were used\n          as queries to search against a clustered version of NCBI-nr (clustered at 60% similarity\n          threshold) using BLASTP (E-value ≤ 1 × 10−10). A similar\n          search was carried out against GOS (clustered at 60% similarity threshold). Figure 17 shows the content of protease\n          types in NCBI-nr and GOS together with the kingdom distributions. Figure 18 shows the content of bacterial protease\n          clans.\n\n        Metabolic enzymes in GOS.\n        \nHmmsearch from the HMMER package [105] was used to search the GOS sequences for different GS types. The GlnA\n          TIGRFAM model was used for finding GSI sequences. The HMMs built from known examples of 17\n          GSII and 18 GSIII sequences from NCBI-nr were used to search the GOS sequences.\n\n        Identification of ORFans in NCBI-nr.\n        \nORFans are proteins that do not have any recognizable homologs in known protein\n          databases. A straightforward way to identify ORFans is through all-against-all sequence\n          comparison using relaxed match parameters. However, this is not computationally practical.\n          An effective approach is to first remove the non-ORFans that can be easily found, and then\n          to identify ORFans from the remaining sequences.\n\nWe identified non-ORFans by clustering the NCBI-nr with CD-HIT [116,117], an ultrafast sequence clustering program. A multistep iterated clustering\n          was performed with a series of decreasing similarity thresholds. NCBI-nr was first\n          clustered to NCBI-nr90, where sequences with &gt;90% similarities were grouped.\n          NCBI-nr90 was then clustered to NCBI-nr80/70/60/50 and finally NCBI-nr30. After each\n          clustering stage, the total number of clusters of NCBI-nr was decreased and non-ORFans\n          were identified. A one-step clustering from NCBI-nr directly to NCBI-nr30 can be\n          performed. However, the multistep clustering is computationally more efficient.\n\nAt the 30% similarity level, all the NCBI-nr proteins were grouped into 391,833 clusters,\n          including 259,571 singleton clusters. The proteins in nonsingleton clusters are by\n          definition non-ORFans. However, proteins that remain as singletons are not necessarily\n          ORFans, because their similarity to other proteins may not be reported for two reasons:\n          (1) significant sequence similarity can be &lt;30%; and (2) in order to prevent a\n          cluster from being too diverse, CD-HIT, like all other clustering algorithms, may not add\n          a sequence to that cluster even if the similarity between this sequence and a sequence in\n          that cluster meet the similarity threshold.\n\nThe 259,571 singletons were compared to NCBI-nr with BLASTP [38] to identify real ORFans from them. The default\n          low-complexity filter was enabled in the BLAST comparisons, and similarity threshold in\n          the form of an E-value was set to 1 × 10−6. In the end, 84,911\n          proteins with at least 100 aa are identified as ORFans. About 100,000 short ORFans less\n          than 100 aa were removed from this study, because they may not be real proteins.\n\n        Genome sequencing projects and rate of discovery.\n        \nWe used Ensembl sequences for Homo sapiens, Mus musculus, Rattus norvegicus,\n            Canis familiaris, and Pan troglodytes. Their clustering\n          information is shown in Table 15.\n          When we considered the datasets in the order HS, HS + MM, HS + MM + RN, HS + MM + RN + CF,\n          and HS + MM + RN + CF + PT, the numbers of distinct clusters were 10,536, 12,731, 13,605,\n          14,606, and 14,993, respectively. These numbers were compared against a random subset of\n          NCBI-nr bacterial sequences (of a similar size) and also against a random subset of GOS\n          sequences. We also randomized the order of the mammalian sequences to produce a dataset\n          that was independent of the genome order being considered.\n\n      Supporting Information\n\n        Accession Numbers\n        \nAll NCBI-nr sequences from February 10, 2005 were used in our analysis. Protocol S1 lists the\n          GenBank (http://www.ncbi.nlm.nih.gov/Genbank) accession numbers of\n          (1) the genomic sequences used in the PG set, (2) the sequences used in building GS\n          profiles, and (3) the NCBI-nr sequences used in building the IDO phylogeny. The other\n          GenBank sequences discussed in this paper are Bacillus sp. NRRL B-14911 (89089741), Janibacter sp. HTCC2649\n          (84385106), Erythrobacter\n            litoralis (84785911), and Nitrosococcus oceani (76881875). The Pfam (http://pfam.cgb.ki.se) structures discussed in this paper are envelope\n          glycoprotein GP120 (PF00516), reverse transcriptase (PF00078), retroviral aspartyl\n          protease (PF00077), bacteriophage T4-like capsid assembly protein (Gp20) (PF07230), major\n          capsid protein Gp23 (PF07068), phage tail sheath protein (PF04984), IDO (PF01231),\n          poxvirus A22 protein family (PF04848), and PP2C (PF00481). The glutamine synthetase\n          TIGRFAM (http://www.tigr.org/TIGRFAMs) used in the paper is GlnA:\n          glutamine synthetase, type I (TIGR00653). The PDB (http://www.rcsb.org/pdb) identifiers and the names of the eight PDB ORFans\n          with GOS matches are: restriction endonuclease MunI (1D02), restriction endonuclease BglI\n          (1DMU), restriction endonuclease BstYI (1SDO), restriction endonuclease HincII (1TX3);\n          alpha-glucosyltransferase (1Y8Z), hypothetical protein PA1492 (1T1J), putative protein\n          (1T6T), and hypothetical protein AF1548 (1Y88)."
}