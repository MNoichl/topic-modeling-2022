{
  "schema": "https://data.sciveyor.com/schema",
  "version": 5,
  "id": "doi:10.1371/journal.pbio.1001841",
  "doi": "10.1371/journal.pbio.1001841",
  "externalIds": [
    "pii:PBIOLOGY-D-13-04969",
    "pmid:24756001",
    "pmcid:PMC3995663"
  ],
  "license": "This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.",
  "licenseUrl": "https://creativecommons.org/licenses/by/4.0/",
  "dataSource": "Public Library of Science",
  "dataSourceUrl": "https://data.sciveyor.com/source/plos",
  "dataSourceVersion": 1,
  "type": "article",
  "title": "Emergent Global Patterns of Ecosystem Structure and Function from a Mechanistic General Ecosystem Model",
  "authors": [
    {
      "name": "Michael B. J. Harfoot",
      "first": "Michael B. J.",
      "last": "Harfoot",
      "affiliation": "United Nations Environment Programme World Conservation Monitoring Centre, Cambridge, United Kingdom; Computational Science Laboratory, Microsoft Research, Cambridge, United Kingdom"
    },
    {
      "name": "Tim Newbold",
      "first": "Tim",
      "last": "Newbold",
      "affiliation": "United Nations Environment Programme World Conservation Monitoring Centre, Cambridge, United Kingdom; Computational Science Laboratory, Microsoft Research, Cambridge, United Kingdom"
    },
    {
      "name": "Derek P. Tittensor",
      "first": "Derek P.",
      "last": "Tittensor",
      "affiliation": "United Nations Environment Programme World Conservation Monitoring Centre, Cambridge, United Kingdom; Computational Science Laboratory, Microsoft Research, Cambridge, United Kingdom; Dalhousie University, Halifax, Nova Scotia, Canada"
    },
    {
      "name": "Stephen Emmott",
      "first": "Stephen",
      "last": "Emmott",
      "affiliation": "Computational Science Laboratory, Microsoft Research, Cambridge, United Kingdom"
    },
    {
      "name": "Jon Hutton",
      "first": "Jon",
      "last": "Hutton",
      "affiliation": "United Nations Environment Programme World Conservation Monitoring Centre, Cambridge, United Kingdom"
    },
    {
      "name": "Vassily Lyutsarev",
      "first": "Vassily",
      "last": "Lyutsarev",
      "affiliation": "Computational Science Laboratory, Microsoft Research, Cambridge, United Kingdom"
    },
    {
      "name": "Matthew J. Smith",
      "first": "Matthew J.",
      "last": "Smith",
      "affiliation": "Computational Science Laboratory, Microsoft Research, Cambridge, United Kingdom"
    },
    {
      "name": "Jörn P. W. Scharlemann",
      "first": "Jörn P. W.",
      "last": "Scharlemann",
      "affiliation": "United Nations Environment Programme World Conservation Monitoring Centre, Cambridge, United Kingdom; School of Life Sciences, University of Sussex, Falmer, Brighton, United Kingdom"
    },
    {
      "name": "Drew W. Purves",
      "first": "Drew W.",
      "last": "Purves",
      "affiliation": "Computational Science Laboratory, Microsoft Research, Cambridge, United Kingdom"
    }
  ],
  "journal": "PLoS Biology",
  "date": "2014-04",
  "dateAccepted": "2014-03-10",
  "dateReceived": "2013-12-19",
  "volume": "12",
  "number": "4",
  "pages": "e1001841",
  "tags": [
    "Behavioral ecology",
    "Biodiversity",
    "Biogeochemistry",
    "Community ecology",
    "Computer modeling",
    "Discipline-v2/Behavioral ecology",
    "Discipline-v2/Biodiversity",
    "Discipline-v2/Biogeochemistry",
    "Discipline-v2/Biology and life sciences",
    "Discipline-v2/Community ecology",
    "Discipline-v2/Computer and information sciences",
    "Discipline-v2/Computer modeling",
    "Discipline-v2/Earth sciences",
    "Discipline-v2/Ecology",
    "Discipline-v2/Ecology and environmental sciences",
    "Discipline-v2/Ecosystems",
    "Discipline-v2/Geochemistry",
    "Discipline-v2/Global change ecology",
    "Discipline-v2/Macroecology",
    "Discipline-v2/Marine biology",
    "Discipline-v2/Marine ecology",
    "Discipline-v2/Population biology",
    "Discipline-v2/Population dynamics",
    "Discipline-v2/Population ecology",
    "Discipline-v2/Spatial and landscape ecology",
    "Discipline-v2/Systems ecology",
    "Discipline-v2/Terrestrial ecology",
    "Discipline-v2/Theoretical ecology",
    "Ecology",
    "Ecosystems",
    "Geochemistry",
    "Global change ecology",
    "Macroecology",
    "Marine biology",
    "Marine ecology",
    "Population biology",
    "Population dynamics",
    "Population ecology",
    "Spatial and landscape ecology",
    "Systems ecology",
    "Terrestrial ecology",
    "Theoretical ecology",
    "Type/Research Article"
  ],
  "abstract": "This paper presents the first mathematical model that attempts to represent the biology and behavior of all individual organisms globally, taking us a step closer to holistic ecological and conservation science founded on mechanistic predictions.",
  "fullText": "Introduction\n\nThe pace and scale of anthropogenic environmental change has caused the widespread degradation of ecosystems and the services they provide that ultimately support human life on Earth [1]. Understanding and mitigating these impacts necessitates the development of a suite of tools, including policy instruments, practical conservation measures, and empirical research. At present, a variety of models are used to assist decision-making in relation to biodiversity and ecosystem services. Most are correlative, relying on statistical relationships derived from limited observational data without explicit reference to the underlying mechanisms; examples include the GLOBIO model, species distribution models, and models of local extinction based on species–area relationships [2]–[4]. All of these models are useful, for different purposes. However, what is urgently needed is mechanistic models, which explicitly represent the biological, physiological, and ecological mechanisms underlying the systems in question [5]. One of the key benefits of mechanistic models is that they are likely to make more accurate predictions under novel conditions [6]. For example, Earth System Models (ESMs), containing mechanistic descriptions of multiple interacting components of the climate, atmosphere, and ocean, are used to project properties and dynamics under future climate conditions that have not been observed previously (at least in relation to historical data) [7]. Similarly, mechanistic models of ecosystems would allow us to predict a given combination of human pressures on a given ecosystem, even when there is no or little historical data on which to rely. Mechanistic models can also improve our understanding of the systems being modelled, allowing predictions to be understood in relation to the underlying mechanisms that generate them [8]. This in turn might lead to novel ways to mitigate or even reverse the degradation of ecosystems.\n\nWe present the first process-based, mechanistic General Ecosystem Model (GEM) (called the Madingley Model). It is general in the sense that it strives to use a unified set of fundamental ecological concepts and processes for any ecosystem to which it is applied, either terrestrial or marine, and it can be simulated at any spatial resolution from local up to global scales. Applying a general modelling approach globally has three main advantages: (1) it allows testing of whether the same set of ecological mechanisms and concepts can adequately capture broad-scale ecosystem behaviour in both the marine and terrestrial realms; (2) it enables the development of a suite of predictive outputs common to both realms, from which standardised metrics of ecosystem health can be calculated; and (3) it enables links between marine and terrestrial ecosystems, both natural and human-driven, to be modelled. The model is also spatially explicit, with dynamics in a given location driven by the climate and other local factors, as well as by connections with other ecosystems through dispersal, and is mechanistic, with dynamics being driven by ecological processes defined at the level of individual organisms. Specifically, we model autotroph (plant) stocks, and individual herbivorous, omnivorous, and carnivorous animals of all body sizes, and their interactions. From these interactions, patterns emerge at larger spatial and temporal scales, including communities, ecosystems, and global macroecological gradients, without any direct model constraints imposed on those properties.\n\nSuch a GEM has great potential if it can, at a minimum, reproduce the observed properties of ecosystem structure and function, and enable the formation of valuable, novel hypotheses, and precise, testable predictions. Here, we test the model's ability to simulate ecosystems that persist over long time scales (1,000 y) by comparing model predictions with empirical data and test two theoretical predictions that to date have not been assessed empirically and have only been studied with simple trophic models: that the net primary productivity (NPP) of ecosystems determines the length of trophic chains [9],[10] and that herbivore pressure on autotrophs will reduce once a critical level of carnivore biomass is supported (“trophic release hypothesis” [11]). Finally, we provide a suite of other novel predictions that demonstrate the potential utility of the model as an operational tool with which the effects of human impacts on ecosystems can be explored.\n\nMechanistic models of specific ecosystems have been developed previously, and to date these have been constrained to particular spatial locations or to particular sets of organisms within ecosystems. For example, dynamic global vegetation models (DGVMs) are used to represent the physiological and ecological processes driving plant community dynamics on the global land surface, enabling investigations into how terrestrial vegetation interacts with climate [12]. However, these do not include animals or other heterotrophs, and so are limited in the extent to which they can be used to understand the roles of heterotrophs in ecosystems, or to address questions about the conservation of organisms other than plants. For the marine realm, “end-to-end” ecosystem models have been developed, which include most trophic levels for particular regions [13]. Examples are the Ecopath With Ecosim (EwE) [14] and Atlantis [15] models. But marine models tend to focus either on biogeochemical cycles or on organisms of economic importance, such as fish, rather than on the properties of the ecosystem as a whole. They also generally either use a stock-and-flow formulation [14],[15], making them unable to follow trajectories of individual organisms, or are restricted to simulating particular guilds of organisms [16].\n\nThere have also been previous theoretical examinations of the potential effect of select processes on select ecosystem metrics, such as the role of bioenergetics in determining size distributions [17]. Such theoretical studies have been very useful in providing insight into the potential mechanisms underlying ecosystem structure; but they have tended to be carried out for single, abstract locations that are not tied to any real geographical location and to omit most of the key processes affecting ecosystem structure and function in reality. We are not aware of any previous attempt to model emergent ecosystem structure and function by identifying a minimal, but putatively complete, set of key processes and then simulating these processes for all organisms globally, over the actual climate and geography of all marine and terrestrial environments. It is for these reasons that we refer to the model presented here as a GEM.\n\nMethods\n\nModel Scope\n\nWe identified a set of core biological and ecological processes necessary to predict ecosystem-level properties: primary production for autotrophs, and eating, metabolism, growth, reproduction, dispersal, and mortality for heterotrophs (Figure 1 and Box 1). We modelled both marine and terrestrial environments but excluded freshwater ecosystems. We included all photoautotrophs, and all heterotrophs that feed on living organisms (i.e., we did not include chemoautotrophs and detritivores). We generally represented only macroscopic organisms (&gt;1×10−3 g), except that we included plankton in the marine realm because of their known importance to the marine food web [18]. All plant biomass in the terrestrial realm was modelled, but only leaves, flowers, fruits, and seeds were available as a food source for herbivores and omnivores. The marine component included phytoplanktonic autotrophs, which provide more than 90% of primary productivity in the oceans [18]. Seagrasses, mangroves, macroalgae, and corals, which are important autotrophs in coastal systems, are not yet included. In this proof-of-concept model, we consider a world without any human impacts, except that we used modern-day climatic conditions. The model and user guide can be downloaded from www.madingleymodel.org, and simulation outputs for main manuscript figures can be downloaded from the Dryad Digital Repository: doi:10.5061/dryad.5m96v [19].\n\nBox 1. Running simulations within our GEM\n\nEach simulation is initialised with environmental information from multiple datasets (as described in the Methods section and in Table S1) and spatially distributed stocks and cohorts (see Methods) according to user specifications (functional groups and grid locations). During a simulation, the stocks and cohorts then interact through time and space. For each time step and each grid cell, the first computation is to increment the biomass of autotrophs according to the relevant growth function (Table 5). Next, the ecology of the heterotroph cohorts is modelled (see functions in Table 6). The order in which heterotroph cohorts act is randomised at each time step. Each heterotroph cohort performs multiple ecological processes per time step (Figure 1A): Individuals in the cohort (i) metabolise biomass to sustain their activities; (ii) eat biomass from either autotrophs if herbivorous or other heterotrophs if carnivorous, or from both if omnivorous; (iii) use net biomass gain to grow, if juvenile, or store biomass for future reproduction if they have reached sufficient body mass to be reproductively mature; (iv) give birth to a separate, offspring cohort if sufficient reproductive biomass has been accumulated; (v) suffer mortality as a result of being eaten by other cohorts feeding on them, or as a result of background mortality processes, starvation, or senescence; and (vi) disperse from their current grid cell to another grid cell. As a result of these interactions across space and time, communities of cohorts possessing different functional traits, individual biomasses, and abundances self-assemble (Figure 1B and 1C).\n\nTraits, Cohorts, and Stocks\n\nTraditional approaches to mechanistic modelling in community ecology focus on densities or abundances of individuals belonging to different species [16],[20]. These are well suited to modelling a small set of focal species, but are unfeasible for modelling whole ecosystems at a global scale, because the vast majority of the world's species remain to be described, or are at best represented by few data describing their distribution and ecology [21]–[23].\n\nInstead, we adopted a trait-based approach [24] where individuals are characterized by their functional traits: categorical traits, such as feeding mode, which determine the mechanisms by which organisms exist and which were used to define functional groups; and continuous traits, such as body mass, which modulate those mechanisms but do not determine functional grouping. Taxonomic identity of individuals is ignored for three reasons. First, there is insufficient species-level information to model whole ecosystems worldwide. Second, it is more feasible to model the role of individuals in ecosystems in terms of their traits than in terms of their taxonomic identity, because of limited taxonomic knowledge and data [21]–[23]. Third, in comparison to taxonomic identity, organisms' functional traits are more directly relevant to most ecosystem functions and ecosystem services [25],[26].\n\nA separate issue is whether to define the model in terms of population densities and biomasses within functional groups (i.e., “stocks” or “pools”), or as collections of interacting individuals each characterized by their combination of functional traits (individual-based). For all organisms except autotrophs, we used an individual-based approach, because this allowed the model to be more finely resolved, and because it enabled us to capture variation in body mass—one of the most important traits for determining the rates of ecological processes [27]–[29] over the lifetime of an individual. It also enabled us to follow the fates of individual organisms. Higher level ecosystem properties emerge from these individual-based rules. Capturing this emergence was a central aim of this initial work.\n\nAutotrophs were represented as stocks—that is, the total biomasses of such organisms—because either the definition of an individual was problematic (terrestrial plants) or rates of turnover were faster than the modelled time step (marine phytoplankton).\n\nFor heterotrophs, simulating every individual separately would have been computationally intractable given the vast number of individuals in global ecosystems. Therefore, we adopted a computational approach based on cohorts. A cohort consisted of a group of organisms occurring within the same grid cell, with identical traits—that is, in the same functional group and with identical continuous traits—but not necessarily belonging to the same taxon. This cohort-based approach allowed us to define the model in exactly the way that one would do in a fully individual-based model (i.e., processes defined at an individual level), but also allowed us to keep the number of computations low enough to be feasible.\n\nFunctional Groups\n\nAll stocks and cohorts belong to a functional group, defined according to the categorical traits of the individuals in that stock or cohort (Tables 1 and 2).\n\nIndividuals in the same functional group interact with one another and with their environment in a qualitatively similar manner. Therefore, cohorts within the same functional group are modelled using the same mathematical representations of the ecological processes, though the rates predicted by those functions differ according to continuous traits that differ between cohorts, such as body mass. Individuals belonging to different functional groups have at least one qualitatively different interaction with other individuals or with their environment. We use the same functional forms for analogous functional groups in the ocean and on land, but with different parameter values, where justified by previous research.\n\nBody mass affects many individual properties and interactions, including feeding preferences and rates, metabolic rates, and dispersal [27]–[29]. Therefore, body mass was included as a parameter in nearly all ecological processes of heterotrophs (Figure 1).\n\nThe Environment\n\nThe environment is defined as a two-dimensional layer representing the land surface and the upper mixed layer (top 100 m) of the oceans. This layer is divided into grid cells within which individuals and stocks are assumed to be well mixed. The ecological processes can be affected by the size of the grid cell, the physical environment at that cell, and dispersal of organisms among adjacent grid cells. The model can be employed for any number of grid cells, at any resolution, locally or globally, subject to computational limitations. For the results presented here, we used either simulations for individual 1°×1° grid cells, or a 2°×2° grid covering the whole globe (see below, and Tables 3 and 4) except for high latitudes (&gt;65°) because remotely sensed, exogenous environmental data currently used are not available for the polar regions. Each grid cell in the model is assigned to either the terrestrial or marine realm based on a land/ocean mask [30]. Environmental conditions for each grid cell are read as model inputs from publicly available datasets: for the terrestrial realm air temperature [31], precipitation [31], soil water availability [32], number of frost days [31], and seasonality of primary productivity [33]; and for the marine realm sea-surface temperature [34], NPP [35], and ocean current velocity (Table S1) [34]. The model is flexible with respect to the specific environmental data used, and future simulated environmental conditions can be used.\n\nThe Ecology\n\nWe provide a summary of how simulations are run in Figure 1 and Box 1, and an overview of how the ecological processes are modelled, with the main mathematical functions, is summarised in Tables 5 and 6. Full details are provided in Text S1.\n\nAutotroph Ecology\n\nIn the marine realm, one stock of phytoplankton per grid cell is modelled, characterised by a total wet matter biomass at time t, . For terrestrial autotrophs, we track two stocks of leaves, l, one deciduous and one evergreen, each characterized by a total biomass at time t, . The biomass of an autotroph stock s, which could be either phytoplankton (p) or leaves (l), is incremented in each time step (of length Δt) as follows:where  and  are the gain and loss of biomass from stock s over the time interval Δt, respectively.  includes losses due to herbivory. We use different approaches to model the gain and loss of biomass from marine and terrestrial autotroph stocks (Table 5).\n\nIn the marine realm, we model growth of the phytoplankton stock by incrementing the total biomass of phytoplankton in each cell using satellite-derived estimates of NPP (Table 5). This avoids us having to adopt computationally impractical time-steps (days) in order to accurately simulate the dynamics of phytoplankton, which have rapid turnover rates (in our opinion, an explicit nutrient–phytoplankton–zooplankton model would be a major improvement to the marine part of the model; see Table 7). Loss of phytoplankton arises directly from modelling grazing by marine organisms (Table 5; Equations 3 and 4 in Text S1).\n\nTerrestrial autotrophs are modelled using the climate-driven terrestrial carbon model of Smith et al. [36]. We selected this model because it has been parameterized and tested against empirical data on carbon stocks and flows more rigorously than similar models of which we are aware (Equations 5–19 in Text S1) [36]. Moreover, it has a similar level of complexity to that used to represent heterotrophic organisms. However, like the other model components we adopted, the vegetation model could be replaced by alternatives in future studies, including more complex models able to address particular issues like CO2 fertilization (e.g., [12],[37]). Terrestrial plant growth is modelled as a function of NPP, the proportion of NPP that is produced by evergreen or deciduous leaves, and the fraction of NPP allocated to structural tissues (Table 5), all of which depend on the local climate. The loss of plant biomass is determined by leaf mortality rate, which is also function of the climate, as well as the consumption of biomass by herbivorous terrestrial organisms (Table 5).\n\nHeterotroph Ecology\n\nHeterotrophs are modelled as cohorts. Each cohort i is characterized by a functional group (Table 2), by two traits that do not change through time—body mass at birth, , and body mass at reproductive maturity  (for cohort, i)—and by three state variables whose values do change through time—the abundance of individuals Ni,(t), the wet matter body mass of each individual within the cohort Mi,(t), and a stored reproductive mass of each individual, Ri,(t) (Figure 1). The values of these state variables are updated each time step according to the effects of ecological processes (Table 6). Individuals in each cohort are assumed to interact only with stocks and cohorts in the same grid cell.\n\nThe growth of individual body mass is modelled as follows:where  is the total biomass assimilated as food, which is the sum of the biomasses assimilated through herbivory and predation,  and , respectively;  is mass lost through metabolism; and  is mass lost by allocation to reproduction (Table 6, see also Figure 1).\n\nPredation and herbivory are modelled using a Holling's Type III functional response, which assumes that the number (or biomass) of prey (or plant material) eaten by an individual predator (or herbivore) is a sigmoidal function of prey density (or biomass density) (Table 6) [38]. The Holling's functions require definition of the attack rate and handling time for each predator (or herbivore) cohort on each prey cohort (or plant stock). Attack rates of herbivores on plants scaled according to the body mass of herbivore. Attack rates of predators on animals were derived from the size-structured model of Williams et al. [39], where the probability of predation is a Gaussian function around an optimal prey body size (as a proportion of predator size) (see Equations 35 and 36 in Text S1) estimated from large empirical datasets on feeding relationships [40]. This size-structured model is an extension of the long-standing niche model [41] but could be replaced with other predator–prey interaction models in future studies if desired. For carnivores and omnivores, the handling time of each predator on each prey increases linearly with prey body mass (larger prey take longer to eat) but decreases as defined by a power-law relationship with predator body mass (larger predators handle prey more quickly) (Equation 40 in Text S1). For herbivores, handling time depends on herbivore body mass only (a decreasing power-law relationship) (Equation 32 in Text S1).\n\nMetabolic costs are modelled as a power-law relationship with body mass, following Brown [29], using parameter values derived from field metabolic rates (Table 6) [42]. We assume that each cohort is active for some proportion of each time step according to ambient temperature (Equations 41–47 in Text S1). Endotherms are assumed to thermoregulate, and thus are active for 100% of each time step. Marine ectotherms are active for 100% of each time step. Terrestrial ectotherms do not thermoregulate, and thus are only active for the proportion of each time step during which ambient temperature was within their upper and lower activity temperature limits, estimated following Deutsch et al. [43].\n\nOnce an individual reaches its adult mass, we assume that all further mass gained is stored as reproductive potential. An individual's reproductive potential mass is incremented as follows:where  is the potential reproductive biomass lost by each individual of cohort i through reproductive events (Figure 1). Reproductive events occur when an individuals' stored reproductive potential reaches a threshold proportion of adult mass (Table 6). During reproductive events, iteroparous organisms devote all of their stored reproductive potential mass to producing offspring; semelparous organisms devote all of their stored reproductive potential mass, and also a proportion (Equations 50–52 in Text S1, Table S2) of their adult mass.\n\nThe number of individuals in each cohort is incremented as follows:where  is the number of individuals of cohort i lost to nonpredation mortality, and  is the total number of individuals of cohort i lost through predation, summed over all predator cohorts k as outlined above (Figure 1). We model three sources of nonpredation mortality: a constant proportional rate of background mortality, which applies to all individuals; starvation mortality, which is applied according to how much body mass has been lost compared to the maximum body mass ever obtained by an individual; and senescence mortality, which increases exponentially after maturity with a functional form similar to the Gompertz model (e.g., [44],[45]) (Table 6). Note that abundance only ever decreases within a cohort. New individuals generated through reproduction produced new offspring cohorts (see below) (Equations 52–54 in Text S1). For computational efficiency, once the number of cohorts exceeds a user-specified, computationally tractable threshold, a number of pairs of cohorts equal to the excess are merged together. On merging, the biomass of one of the cohort pair is converted into an equivalent number of individuals of the other cohort in the pair (Equations 68–69 in Text S1). The cohort pairs identified for merging are those lying closest together in continuous trait space, and belonging to the same functional group (Equation 67 in Text S1).\n\nIndividuals were exchanged among the grid cell via three types of dispersal: (1) random diffusive dispersal of newly produced (juvenile) cohorts, (2) active dispersal of individuals determined by the degree of starvation experienced, and (3) advective-diffusive dispersal driven by ocean currents (in the marine realm only) (Table 6). Dispersal occurred via the movement of whole cohorts, such that cohorts remained intact. This was necessary numerically to keep the number of cohorts manageable. We carried out some targeted simulations to explore the effects of allowing cohorts to split on dispersal, and found that could have quantitative effects, but does not fundamentally alter dynamics (Figure S1). Assumptions and functional forms about dispersal, and numerical schemes to implement them, are another potentially important area for future research.\n\nWhen the model was applied to a specific grid cell in isolation, dispersal into or out of the grid cell was not modelled.\n\nEmergent Properties\n\nThe properties of individuals and communities that we present below are “emergent”; that is, they are not prescribed, but instead emerge through time as a result of the large number of interactions that take place between individual organisms (approximated as cohorts). As a result of these interactions, life histories of individuals are formed over time and can be tracked, and communities and ecosystems of individuals self-assemble. Moreover, the dynamics of any one grid cell are affected by the exchange of individuals with other grid cells, which occurs due to dispersal. Thus macroscale predictions (e.g., over the generation length of an individual cohort, across functional groups, or across entire ecosystems) emerge from microscale biological mechanisms. The macroscale predictions differ for ecosystems in different climates, but only because the microscale biology is sensitive to the climate. Similarly, the macroscale predictions differ between the land and sea, but only because microscale biology differs between land and sea. We compared these emergent properties to empirical data.\n\nModel Simulations and Comparison to Data\n\nWe carried out four distinct types of simulations for different assessments of model capabilities (Table 3).\n\nTerrestrial grid cells were seeded with two autotroph stocks, deciduous and evergreen, as detailed above, and marine grid cells were seeded with a single phytoplankton stock. Grid cells were seeded with around 1,000 cohorts each, with 112 cohorts in each of nine functional groups in the terrestrial realm and 100 cohorts in each of 10 functional groups in the marine realm. Juvenile and adult body masses of cohorts were drawn at random from a prespecified range (Table 2), and initial abundance was scaled negatively with initial body mass to provide reasonable initial densities (see Text S1 for full details).\n\nDetailed numerical analyses were conducted on four focal grid cells (Study 1, Table 3) to investigate ecosystem dynamics over longer time scales. These simulations were used to check for the persistence of key community components (autotrophs, herbivores, carnivores, and omnivores), and to determine the typical time scales for the dynamics to reach some form of equilibrium. These analyses used the same climatological time series per year to remove the effects of interannual environmental variation. For each focal grid cell, we ran 10 model simulations for 1,000 y at a monthly time step. To test the effect of the cohort-merging regime on modelled dynamics, we repeated the simulation ensembles for each focal grid cell with the threshold number of cohorts at which merging is activated set at 500, 1,000, 5,000, and 10,000 cohorts and for a shorter period of 100 y.\n\nAdditional detailed simulations were carried out for the focal grid cells over a 100-y period to generate highly resolved predictions of emergent ecosystem properties at two levels of biological organisation: individual and ecosystem level (Study 2, Table 3).\n\nWe compared the properties of individual organisms with empirical data. Importantly, none of these properties were defined in the model as parameters, but rather they emerged as a result of the ecological interactions among individuals. The predicted relationship between body mass and growth rates was compared to estimates for reptiles, mammals, birds, and fish [46]–[48], and the relationship between body mass and time to reach maturity to estimates for invertebrates, reptiles, mammals, birds, and fish [49]–[57] (where necessary body masses were estimated from body lengths using relationships in [58]–[61]). The predicted relationship between body mass and mortality rates was compared with data for invertebrates, mammals, birds, and fish, taken from a single study [62]. The predicted relationship between body mass and lifetime reproductive success was compared with data for mammals, birds, and a few insect species [63]–[71]. Of these emergent properties, the growth rate of organisms derives most closely from the functional forms and input parameters. Specifically, growth rate could theoretically be a simple sum of food assimilation rates under conditions of saturating prey density minus metabolic costs. To test whether this was the case, we calculated the theoretical growth rate for organisms of a range of body masses under these conditions.\n\nWe compared our novel predictions of complete ecosystem structure in two grid cells (T1 and M1) (Table 4) to empirical data: the biomass density of large herbivores with an estimate for Uganda [72], and the predicted herbivore to autotroph biomass ratios with average observed ratios for similar ecosystems [73]. We further compared the modelled relationships between body mass and population density with empirical estimates derived from fish assemblages [74],[75].\n\nTo test the ability of our model to capture broad-scale patterns in the basic trophic structure of ecosystems, we compared our model predictions (Study 3, Table 3) to empirical estimates from the same dataset used to calculate the global average trophic structure ([73]; see above), but this time using specific values for 14 sites for which we could identify the spatial location (Table S3). This dataset is the most geographically wide-ranging dataset on ecosystem structure that we are aware of, including sites in both the terrestrial and marine realms.\n\nWe also generated model outputs at a global scale (Study 4, Table 3). These were used in two ways: firstly, to investigate the mechanisms giving rise to variation in ecosystem structure by assessing the relationship between trophic structure and productivity in the model along large gradients of autotroph productivity in both terrestrial (along a meridional transect from the low productivity Saharan desert to high productivity Congo Basin tropical forest region) and marine (along a meridional transect from low productivity Antarctic waters to high productivity East Atlantic upwelling zones) realms; and secondly, to make novel predictions of as-yet unmeasured global properties (e.g., latitudinal gradients in total biomass) and to compare to other modelled estimates of total biomass and density at a global scale [76]. We also compared modelled global average ratios of herbivore to autotroph biomass with the average ratios observed in the same dataset that we used to test the predictions made by individual cells [73]. Finally, we investigated how modelled marine ecosystem structure responded to mechanisms that have been proposed to cause inverted trophic biomass pyramids, such as dispersal [77], turnover rate of autotrophs, and turnover rate of consumers [77]–[79]. To do this, we simulated the global marine realm with no dispersal permitted between grid cells (Study 5, Table 3) and the effects of reducing the turnover rate of biomass through the ecosystem (Study 6, Table 3).\n\nResults\n\nGrid Cell: Dynamics\n\nFor the 1,000-y simulations (Study 1), model dynamics converged rapidly (&lt;100 y) to dynamic equilibria for all 10 replicates in all four focal grid cells (Figure 2). Autotrophs, herbivores, omnivores, and carnivores persisted in all simulations. The dynamics of total biomass by functional group differed markedly among the four grid cells. Terrestrial grid cells were dominated by autotroph biomass and, among heterotrophic organisms, by herbivores, with lower biomasses of omnivores and carnivores. Marine grid cells, in comparison, had much lower biomasses of autotrophs, and omnivorous and carnivorous organisms were more dominant. Unsurprisingly, the seasonal grid cells in both the terrestrial and marine realms (Figure 2B and 2D) exhibited much greater fluctuations in biomasses within years, particularly for lower trophic levels. The high-productivity marine grid cell exhibited large-amplitude, high-frequency variations in zooplankton abundance. Biomass dynamics were robust to the choice of the threshold number of cohorts at which to activate merging above a threshold of 1,000 cohorts (Figure S2).\n\nGrid Cell: Individuals\n\nThe power-law relationships between body mass and the properties of individual organisms that emerged from the model were generally consistent with empirical data (Figure 3). For growth rates and times taken to reach reproductive maturity, the modelled and empirical values were very similar, although the slope of the relationship between predicted growth rates and body mass was steeper. In absolute terms the predicted growth rates tended to be higher and the predicted times to maturity tended to be lower than those observed in the empirical data (Table S4).\n\nOur assumptions about underlying ecological processes, such as handling times and metabolic rates, place a fundamental limit on the growth rate of organisms of a given body mass (i.e., the net growth rate of individuals that are feeding at the maximum rate). If most individuals attained this maximum, then the growth rates would not be emergent, so much as defined by the model assumptions. But this was not the case. The emergent relationship between body mass and growth rate was not a simple function of maximum possible food assimilation and metabolic costs: modelled growth rates were typically one-tenth of theoretical maximum model growth rates and showed large variation for any given body mass (Figure S3). This variation resulted from the many other factors that affected growth rate, most notably the abundance and body masses of potential prey and predators competing for the same prey.\n\nPredicted mortality rates showed a negative power-law relationship with body mass (Figure 3C), qualitatively consistent with empirical data, although the relationship was generally shallower and absolute rates were higher (Table S4). Finally, predicted reproductive rates in the terrestrial realm showed a weak positive power-law relationship with body mass, broadly consistent with empirical estimates (Figure 3D, Table S4), whereas predicted reproductive rates in the marine realm were weakly negative. Predicted reproductive rates were substantially more variable than the empirical data (Figure 3D).\n\nGrid Cell: Community\n\nFor the four focal grid cells, terrestrial ecosystems exhibited a pyramid of biomass across the different trophic levels (Figure 4A), which is widely accepted to be present in terrestrial systems [80]. The predicted herbivore biomass as a proportion of producer biomass (0.98%) was consistent with empirical terrestrial estimates (median value = 0.93%) (Table S5) [73]. However, predicted biomass of large-bodied herbivores was four to six times higher than estimated from a field study [72]. Consistent with current opinion and observations [78],[81]–[84], marine ecosystems exhibited an inverted pyramid of biomass structure [73],[82], with the highest biomasses in the highest trophic levels (Figure 4C). Marine systems exhibited relatively faster flow rates of productivity from autotrophs to higher trophic levels compared with terrestrial ecosystems—and at rates much higher than those estimated to date (Figure 4A and 4C) [85]. Predicted herbivore biomass as a proportion of producer biomass for the marine grid cells was much higher than in terrestrial ecosystems (63%), and of a similar magnitude to empirical estimates (median value = 52%) (Table S5) [73].\n\nExpressed as abundance rather than biomass, and consistent with theoretical expectations [86],[87], trophic pyramids were not inverted in either realm: that is, communities contained a greater number of herbivores than carnivores (Figure S4).However, omnivores were more abundant than herbivores, by a factor of 3 in the terrestrial cell and by two orders of magnitude in the marine cell. This was because the average size of omnivores was smaller than the average size of herbivores or carnivores.\n\nIn both terrestrial and marine grid cells, densities of organisms showed a negative, approximately log-linear relationship with individual body mass (Figure 4B and 4D), the slopes of which fell within observed ranges in fish community assemblages from some sources (Figure S5) [75], although not from others (Table S6) [74].\n\nGeographical Patterns in Ecosystem Structure Across 14 Sites\n\nPredicted ratios of heterotroph to autotroph biomass were broadly consistent with empirical estimates in many of the terrestrial and marine locations (Figure 5). For terrestrial ecosystems, the model and empirical data were in closest agreement in the two savannah ecosystems (Figure 5J and N). For the other ecosystem types—desert, tundra, deciduous forest, and tropical forest—there was lower agreement between model and empirical estimates of trophic structure, with modelled heterotroph to autotroph biomass ratios generally greater than empirical estimates, sometimes by orders of magnitude (Figure 5).\n\nModelled ecosystems in the marine realm generally showed closer agreement with empirical estimates than in the terrestrial realm. However, in both Santa Monica Bay, San Francisco (Figure 5A), and the Swartkops estuary in South Africa (Figure 5F), median modelled herbivore to autotroph biomass ratios were three orders of magnitude larger than empirical estimates.\n\nTrophic Structure Along Productivity Gradients\n\nThe structure of both marine and terrestrial ecosystems showed marked changes along a gradient of increasing NPP (Figure 6). Marine ecosystems showed increasing biomass for all three heterotroph types (carnivores, omnivores, and herbivores), and flat then declining and highly variable autotroph standing biomass (Figure 6A). Terrestrial ecosystems also showed a trend of increasing heterotrophic biomass with productivity (Figure 6B). Carnivores increased in biomass with productivity more steeply than for other trophic levels, and were entirely absent from the lowest productivity desert ecosystem. In the most productive terrestrial ecosystems, carnivores typically had higher biomass densities than omnivores.\n\nGlobal Ecosystems\n\nGlobal patterns of total heterotroph biomass, averaged across the final year of the simulation (Figure 7A), were similar to patterns of primary productivity (Figure S6). In the marine realm, our modelled estimate of median heterotroph biomass density was 167,147 kg km−2, approximately 7–30 times greater than previous modelled estimates, which range from 5,500–25,000 kg km−2 [76],[88]–[90]. However, a recent empirical study into mesopelagic fish biomass suggests that some fish biomass densities are likely to be an order of magnitude higher than these previous estimates [90] and so our prediction is plausible. Global median ratios of herbivore to primary producer biomass estimated by the model were 0.8% for terrestrial and 189% for marine ecosystems, compared to 0.93% and 52% for empirical estimates (Table S5) [73]. Our modelled estimate of median total terrestrial heterotroph biomass density was 151,089 kg km−2, a prediction which, as far as we are aware, has never been made previously.\n\nIn the marine realm, high heterotroph biomass is predicted in upwelling systems and areas of high annual productivity (e.g., the North Atlantic). In the terrestrial realm, predicted heterotroph biomass was highest in naturally forested areas and lowest in deserts. There was no clear latitudinal gradient of biomass density in either system, but latitudinal variability was substantially greater in the terrestrial realm. At subtropical latitudes in the northern hemisphere in the terrestrial realm, there was a band in which carnivores had higher biomass density than omnivores, whereas elsewhere omnivores had greater biomass density. This switch in the relative dominance of omnivores in the northern hemisphere coincided with a decline in mean herbivore biomass density. No discernible decline in mean herbivore biomass densities was observed at subtropical latitudes in the terrestrial southern hemisphere.\n\nNot all grid cells conformed to the pattern of inverted biomass pyramids in the marine realm and noninverted biomass pyramids in the terrestrial realm. Out of all terrestrial cells modelled, 9% were predicted with more omnivore than herbivore biomass and 46% with greater carnivore than omnivore biomass (Figure S7). Conversely in the marine realm, 12% of cells had less herbivore than autotroph biomass, 10% of cells had less omnivore than herbivore biomass, and 0.4% of cells had less carnivore than omnivore biomass (Figure S7). The spatial extent and frequency of cells in the marine realm with noninverted pyramids was significantly higher when dispersal was prevented from occurring (Figures S8 and S9). There was also evidence that noninverted trophic structure was more likely when the turnover rate of phytoplankton was lower and when the rate and efficiency with which matter is transferred through the system were reduced (Figure S10).\n\nDiscussion\n\nWe have shown that it is possible to derive global predictions about the emergent properties of ecosystem structure and function from a GEM based on processes of, and interactions among, individual organisms, without any model-imposed constraints on those properties.\n\nStability of Emergent Dynamics\n\nThe model reached a dynamic steady state in all grid cells, with the persistence of all trophic levels, which is expected in the absence of perturbation [91]. Real ecosystems are not expected to exhibit such stable dynamics because they are subject to numerous interannual environmental fluctuations and perturbations. These were not incorporated for this study, but could be in the future. The global simulations (which included dispersal) converged to equilibria with similar characteristics to the focal grid cells, although with higher biomass densities. The higher biomass must have been a result of dispersal, as this is the only difference between the focal-cell simulations and may be owing to a rescue effect from neighbouring grid cells. Nonetheless, the similarity of the simulations with and without dispersal provides support for the use of isolated focal grid cells in more detailed studies.\n\nOne form of instability in the dynamics was the large temporal variation in biomasses in the high-productivity, seasonal marine grid cell. Plankton and zooplankton are known to exhibit marked biomass fluctuations, but the modelled variation was much greater, and has a different temporal signature (chaotic variation within the productive season, whereas real cycles are repeatable year to year). This appears to be an artefact of the long time step used, allowing massive unconstrained changes in biomass over a single time step. Model simulations carried out using a daily time step (only feasible over shorter time periods and for single grid cells due to the computational demand) produced substantially more stable dynamics. However, the mean predicted biomass was similar between simulations using different time steps, suggesting that most of the properties of our results are robust. Nevertheless, future research is needed into numerical and computational methods for more appropriately simulating small organisms in GEMs (see Table 7 and Text S2).\n\nEmergent Life Histories and Trophic Structure\n\nMany aspects of the life history of individuals emerge from the underlying ecological processes and interactions with other organisms. For example, growth rates are determined by a combination of food assimilation rates and metabolic losses, which themselves depend on the abundance and properties of the other individuals at the location, and are also constrained by the maximum possible rate of assimilation and environmentally determined metabolic rate. Modelled growth rates varied widely among cohorts, between the maximum and minimum theoretically possible rates (Figure S3), but showed good correspondence with observed values (Figure 3A). Predicted mortality rates were much higher than empirically observed rates, especially for larger organisms (Figure 3C). This may reflect a mismatch with the data, as discussed below; in this case, empirical mortality rates were observed in laboratory conditions in the absence of predation mortality. Comparing the empirical data and model predictions at a higher level of resolution, for example within functional groups or biomes, might help us to better diagnose discrepancies in the future.\n\nGrowth rates were slightly faster and times to maturity slightly shorter than those from observation. Modelled rates of biomass transfer calculated for the two focal grid cells were higher than empirically observed rates, particularly in the marine realm (Figure 4) [85]. At least in part, this discrepancy may result from a bias in the data toward larger organisms, leading to empirical estimates underestimating real biomass flow rates.\n\nSimilarly, the negative log-linear relationship between individual body mass and organism density is consistent with ecological theory [92], although uni- [93],[94] or multimodal [95],[96] relationships have been observed. The modelled slopes were shallower than empirical estimates for a log-linear relationship, which again might indicate that turnover rates in the model were overestimated, causing greater suppression of smaller organism abundance and higher abundance of larger organisms than in real ecosystems.\n\nAnother difference between the model and data was that the modelled biomass of large-bodied herbivores was several times higher than observations [72]. Modelled ratios of herbivore to autotroph biomass were also higher than empirical estimates in most cases, especially for terrestrial ecosystems. There are three potential explanations for this. The first is that herbivores, like predators, are eating too efficiently in the model, which might result from incorrect functional forms or missing processes. The second explanation is that because the available data are extremely sparse, the data are thus potentially not representative of the system. Thirdly, human impacts might have reduced large herbivore biomass in the empirical data compared to the undisturbed ecosystem assumed in these simulations of the model.\n\nThe closer match between modelled and empirical trophic structure for marine and savannah ecosystems, compared to forests, might be because these ecosystems conform much better to the assumption that individuals are well mixed. This assumption implies that herbivores can find all plant material and predators can find all prey. In all ecosystems, but most obviously in forests, many leaves are physically out of reach of many herbivores, and many prey are able to find refuge from predation. This may act to slow down biomass turnover in forests in comparison to the ocean and savannas, in a way that cannot be captured by a model that assumes complete mixing within a grid cell. On the other hand, the discrepancy could also be caused by incomplete empirical data. It is easier to estimate whole-ecosystem properties in savannas (where animals tend to be highly visible) and in the ocean (which can be trawled with nets) compared with forests. Alternatively, the terrestrial plant model might be inaccurately capturing the allocation of productivity to structural or nonstructural matter at these specific forest sites. However, this appears less likely, as the allocation function of this model has been rigorously constrained using a global dataset, and evaluation shows the model predicts well for this property [36]. We note, however, that at finer, site-level scales, plant allocation strategies will certainly be more heterogeneous and will certainly be different from the larger scale average predicted by the global model.\n\nIt is important to note that differences between the marine and terrestrial realms were not imposed on the model as top-down limits on the structure of ecosystems but rather emerged from individual-scale ecology. A necessarily different set of representative functional groups was defined for the marine environment compared to the terrestrial environment, but all functional groups in the model followed the same fundamental ecological functions. The only other encoded differences between marine and terrestrial cohorts were the proportion of total autotroph biomass available for consumption by a given herbivore cohort, the different optimal prey body sizes for predators, and the assumption that marine ectotherms are not thermally restricted in their capacity to function. The primary cause of the much lower ratio of herbivore biomass to autotroph biomass in the focal terrestrial cells versus in the oceans was the allocation by terrestrial plants of primary productivity to structural tissues, which are inedible to all herbivores in the model (Figure S11). This assumption probably made it more likely that terrestrial cells would exhibit a conventional pyramid of biomass structure. However, the model predicted considerable variation in the shape of the trophic biomass pyramid across terrestrial and marine cells, including an inverted structure in some terrestrial cells and a noninverted structure in some marine cells (Figure S7).\n\nEmergent Global Patterns: Model Results and Predictions\n\nThe modelled global estimates of biomass density represent the first attempt to assess the scaling of ecosystem properties from individuals to communities at a global level, and to apply a general ecological modelling methodology consistently across both the marine and terrestrial realms.\n\nSome of these properties have been estimated previously in specific locations, but none have been estimated globally using mechanistic models (although marine animal biomass and biomass densities have been predicted mechanistically [76],[88],[89]). In addition, we have calculated emergent properties that are, as far as we are aware, unprecedented (Table 8), and we discuss these below.\n\nHeterotroph Biomass and NPP\n\nAt a global scale, the spatial pattern of heterotroph biomass was broadly consistent with observed NPP [97], which is unsurprising, as NPP is the basal resource in all of the modelled ecosystems. However, the relationship between primary productivity and heterotroph biomass was not simple: a given level of primary productivity could result in a wide range of heterotroph biomass (Figure S6A–D). This variation arises from differences in climate, which lead to differences in biomass allocation to different plant tissues and to variation in animal metabolic rates and levels of activity. The predicted peak in terrestrial heterotroph biomass densities observed in locations with intermediate levels of NPP is also likely to result from these factors; for example, plants in the most productive areas allocate a greater proportion of biomass to structural tissues, whereas plants in intermediate productivity ecosystems such as grasslands have a greater relative allocation to nonstructural tissues. Autotroph biomass was also influenced by herbivory, as demonstrated by removing all heterotrophs from the model and representing mortality of plants through herbivory using a constant loss term (Figure S6E and F). This experiment suggests the impact of herbivory on plants varies significantly across the world, indicating the potential importance of explicitly considering herbivores in carbon cycle models, such as DGVMs, or models of ocean biogeochemistry, which is not done at present. Exploring the impacts of heterotrophs on carbon cycling and predicted carbon dynamics is an important avenue of research for future development of GEMs.\n\nEmergent Structure and Productivity\n\nModelled variation in trophic structure along gradients of productivity supported theoretical expectations that the NPP of systems will determine the length of trophic chains [9],[10],[98]. In low-productivity terrestrial systems, there is insufficient autotrophic biomass propagating to higher trophic levels to support carnivores, whereas in high-productivity ecosystems, carnivore biomass is greater than omnivore biomass. In the marine realm, autotroph biomass decreased with increasing primary productivity beyond NPP of 40,000 kg km−2 y−1, inconsistent with expectations from the trophic release hypothesis (Figure 6B) [11]. The model predicts for marine ecosystems that with increasing primary productivity herbivore biomass increases and carnivore biomass, as a proportion of total biomass, decreases. For terrestrial ecosystems, herbivore biomass increased to around 40,000 kg km−2 and then decreased, whereas the carnivore biomass proportion decreased only after around 550,000 kg km−2. The relationship predicted for marine ecosystems is in agreement with the general findings from available empirical data on changes in trophic structure associated with changes in productivity, derived from freshwater, intertidal, and reef fish communities [99]–[103]. However, our results indicate that a qualitatively different relationship between trophic structure and productivity appears to exist in the terrestrial realm. There are additional factors that influence modelled community structure along productivity gradients that will require detailed investigation in the future, including (i) seasonality, which will vary among different modelled locations with similar productivity; (ii) climatic differences, which might affect the composition of autotroph biomass in terrestrial ecosystems; and (iii) dispersal regimes.\n\nEmergent Latitudinal Patterns of Community Structure\n\nPredictions of latitudinal variation in community structure (as shown in Figure 7B and 7C) give an insight into the mechanistic basis of these patterns at a global scale. On land, there was greater variation in the biomass density of all trophic groups, both latitudinally and longitudinally, compared to in the oceans (Table 8). The greater variation in terrestrial biomass densities was likely driven by greater environmental heterogeneity in the terrestrial realm and the greater range and speed of dispersal processes (e.g., advective dispersal) in the oceans. For example, both temporal [104],[105] and spatial variability [106] in environmental temperature is higher on land versus the ocean.\n\nIn the mid to high latitudes of the terrestrial northern hemisphere, omnivorous organisms account for greater biomass than carnivores. However, in equatorial latitudes and extending to 30°S, carnivorous organisms constituted a greater fraction of the total ecosystem biomass than omnivores (Figure 7C and Table 8). The equatorial and low southern hemisphere latitudes correspond to more stable environmental conditions [106] compared with mid to high northern latitudes. Therefore, the model appears, in the terrestrial realm, to be selecting for generalist feeding strategies in more variable environments, while favouring specialism where the environment is more stable.\n\nMechanisms Giving Rise to Inverted Marine Trophic Structure\n\nThe model showed that dispersal of organisms plays an important role in the spatial extent and frequency of inversion of marine trophic structure (Figures S8 and S9), which is consistent with the hypothesis that the import of allocthonous organic matter supports relatively higher heterotrophic biomass in oligotrophic freshwater systems, which has been postulated previously but not investigated in detail [77]. Furthermore, we show that noninverted trophic biomass structure is more frequent when the turnover rate of phytoplankton is reduced and when the rate and efficiency of biomass transfer through the ecosystem is lower (Figure S10), in agreement with current theory [77]–[79]. The generality of inverted trophic pyramids in the marine realm remains unknown, but there are numerous examples of herbivore biomass being larger than producer biomass in ocean environments [73]. Inversion at the top of the trophic pyramid has apparently been observed in some near-pristine reef habitats [84], though this may simply be an overestimation artefact of the visual census approach used [107].\n\nFuture Model Development\n\nIn developing the first global GEM, our strategy was to start with a “simple” model that can be improved later. To keep it simple, we excluded numerous aspects of ecology—some of which are captured by existing models of particular ecosystems [14],[15]. Adding this ecology back into our model would, arguably, make it more realistic. Then again, attempting to include all known ecological processes occurring in every ecosystem around the world would not only be completely impractical but would also be excessive for most of the purposes for which a GEM is intended. Thus, we would expect the set of ecological processes represented in GEMs to evolve over time and to depend on the ways in which GEMs come to be used. Moreover, there are several other important ways in which our model could be improved, as outlined in Table 7, and discussed below.\n\nFuture Model Development: Ecology\n\nThe physical environment is currently represented very simply in the model. For example, in reality, variation in habitat structure within grid cells will alter interactions between organisms. And a fully integrated and explicitly resolved mechanistic model of phytoplankton is required in future iterations of the model, as is representation of nonphytoplanktonic coastal autotrophs (e.g., seagrass beds or coral reefs) and detritivores. The detrital loop in particular is important in “closing the system.” Other ecological processes that should be incorporated in future iterations of the model include ecological stoichiometry; intelligent behaviour, such as directed dispersal, hibernation, and stasis; and complex predator–prey and herbivore–plant interactions (Table 7).\n\nFuture Model Development: Data\n\nRobust data-constrained parameterisation of the model and rigorous evaluation of our novel but testable outputs was not possible because the necessary data were not generally available. Therefore, another set of developments are needed around the acquisition and collation of data for use in GEM modelling (Table 8 and Table 7), which are reflected by the biodiversity informatics community [108].\n\nFuture Model Development: Numerical and Mathematical Methods\n\nThe development of the Madingley Model was enabled by combination of numerical methods that is, far as we are aware, novel (e.g., the cohort approach to trait-driven interactions, combined with cohort merging, randomly ordered updating, the treatment of autotrophs as continuous state variables, and exponential differencing of loss rates within time steps; see Text S2 for further examples). Given the novelty of this modelling paradigm in ecology, at least five areas of development will be required: detailed analysis and understanding of the mathematical representations of ecology, analytical tractability of predicted ecosystem properties, the implications of alternative abstractions and numerical methods used to implement them, the infrastructure to allow flexibility in scale, and the infrastructure to constrain and evaluate the model so that the benefits of additional components or realism can be assessed objectively (Table 7). In addition, it would be interesting to explore the approach referred to as “parameterization” in the biogeosciences modelling community—that is, to fit phenomenological relationships to the output of GEMs, thus allowing approximate versions of them to be run much more quickly, or within the context of more general ESMs.\n\nFuture Model Development: Community\n\nThe further development of GEMs discussed above will be expedited by a community of researchers improving upon the model presented here or developing alternative GEMs. We call for such a community of ecologists, biologists, mathematicians, and computer scientists to form around the GEM concept so that this class of model can be rapidly advanced to better meet the pressing needs of conservationists and policymakers. In this spirit, we have developed our model architecture in such a way that it is relatively easy to alter the representation of ecological processes and have made our model code freely available to the community (www.madingleymodel.org).\n\nUse of GEMs\n\nOur model is the first step towards the development of a more ecologically refined GEM (and GEMs) that occupies a very different niche to the more specialised modelling approaches that have been used to inform biodiversity policy to date, and is more akin to the global climate models that inform global climate science and policy [8]. Our GEM necessarily made numerous simplifying assumptions in order to capture a broad range of ecological processes and organisms. This nevertheless provides a new approach to answering important outstanding questions in ecology and with which to begin to ask entirely new questions—questions that require an integrated, mechanistic understanding of whole ecosystems; the connections among them; and their response to environmental variation and natural or human perturbations. In the following sections, we briefly discuss how GEMs could be used to inform ecological science and conservation policy.\n\nUse of GEMs: Ecology\n\nGEMs will help in the development of ecological theory. The study of ecology is so broad that most pieces of ecological research necessarily focus on a small subset, whether in terms of scale, taxa, or the processes concerned. The implications of the findings in these disparate research areas for the longer term and larger scale dynamics of whole communities and ecosystems are hard to assess. This has led some ecologists to call for a renewed interest in “systems ecology,” which aims to study important ecological processes within the context of other important ecosystem and earth-system processes to enable a better understanding of the natural environment [109]. Models like ours provide one way to do this: new ecological findings can be used to modify the model, or different competing formulations of ecological theories (e.g., prey density or ratio-dependent predation functions [110]) can be represented in the model and the results assessed against known ecosystem structure. By doing so, the processes of critical importance for ecosystem structure and functioning could be identified and priorities for development of new ecological hypotheses or data-gathering determined. Our preliminary investigations of community trophic structure along productivity gradients and of the mechanisms giving rise to the inversion of marine cells illustrate the potential of GEMs in this regard.\n\nUse of GEMs: Conservation\n\nThe simulations presented here are not directly relevant to conservation decision-making, as the model currently does not directly include anthropogenic influences. In principle, a model of this kind could be used to better inform the management of the world's ecosystems, in much the same way that mechanistic ESMs are used to predict and explore scenarios of anthropogenic climate change [7]. Forcing the model with time-varying historic or future projections of environmental variables would provide the kinds of novel and highly relevant outputs that could enable a mechanistic approach to conservation decision-making.\n\nBy taking a system-level approach, GEMs are uniquely able to simulate the interacting relationships between various simultaneous human pressures (such as climate change, land use change, and harvesting of wild animals) and various metrics of ecosystem structure and function, exploring the trajectories derived from external scenarios of human pressure. For example, they could predict (1) static measures of ecosystem properties, such as the variation in the functional traits represented in ecosystems, an important measure of biodiversity thought to be related to ecosystem functioning [26]; (2) metrics that are currently used to monitor the state of ecological systems, such as the total abundance of large endotherms as an analogue of the Living Planet Index [111]; (3) metrics relating to focal species, by examining the fate of organisms with similar traits to those species, although important species-specific factors may not be captured that way; and (4) dynamic ecosystem measures, such as stability (the magnitude of temporal variation in ecosystem properties) or resilience (predicted time to recover from a perturbation). A unique advantage of GEM-like models relative to statistical modelling approaches is their capacity to model completely novel perturbation scenarios—that is, perturbations for which there are no data, experiments, or observations.\n\nThe structure of this type of model also allows for a wide set of anthropogenic perturbations to be considered simultaneously. For example, such models will be able to simulate how whole ecosystems respond to, and feed back upon, the effects of changes in atmospheric carbon dioxide concentrations on plants; altered climate on all organisms and ecological processes; harvesting of animals, land-use change, and harvesting of vegetation; invasive species; and toxic pollutants. The effects of these disparate perturbations could be measured using a common set of metrics. Considering these impacts together in a GEM should allow for much more holistic understanding, and management, of the world's ecosystems, which will make GEMs a powerful tool for bodies such as the Intergovernmental Platform on Biodiversity and Ecosystem Services.\n\nConclusions\n\nWe have developed the first General Ecosystem Model (GEM) that synthesizes fundamental aspects of ecological theory, to model, simulate, and predict how the structure and function of ecosystems at multiple scales emerges from the biology and interactions of individual organisms. Our model matches a broad range of empirical data well, to a first approximation. Where it departs from either observations or expectations, it does so in ways that afford interesting avenues for future ecological research, future model development, and empirical data collection. It also provides a set of novel predictions that can be independently assessed. We anticipate that this will be the beginning of a long-term exploration of GEMs, and we call upon ecologists, biologists, mathematicians, and computer scientists to join in creating a modelling community surrounding GEMs that can catalyse the development of more realistic, sophisticated, yet better understood models of ecosystems worldwide. Our hope is that GEMs will form the basis of new science in ecology and, in particular, science that proves actionable to those charged with conserving the biosphere on which we all depend.\n\nSupporting Information"
}