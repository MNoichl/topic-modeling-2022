{
  "schema": "https://data.sciveyor.com/schema",
  "version": 5,
  "id": "doi:10.1371/journal.pbio.0040088",
  "doi": "10.1371/journal.pbio.0040088",
  "license": "This is an open-access article distributed under the\n        terms of the Creative Commons Attribution License, which permits unrestricted use,\n        distribution, and reproduction in any medium, provided the original author and source are\n        credited.",
  "licenseUrl": "https://creativecommons.org/licenses/by/4.0/",
  "dataSource": "Public Library of Science",
  "dataSourceUrl": "https://data.sciveyor.com/source/plos",
  "dataSourceVersion": 1,
  "type": "article",
  "title": "Relaxed Phylogenetics and Dating with Confidence",
  "authors": [
    {
      "name": "Alexei J Drummond",
      "first": "Alexei J",
      "last": "Drummond",
      "affiliation": "Department of Zoology, University of Oxford, Oxford, United Kingdom"
    },
    {
      "name": "Simon Y. W Ho",
      "first": "Simon Y. W",
      "last": "Ho",
      "affiliation": "Department of Zoology, University of Oxford, Oxford, United Kingdom"
    },
    {
      "name": "Matthew J Phillips",
      "first": "Matthew J",
      "last": "Phillips",
      "affiliation": "Department of Zoology, University of Oxford, Oxford, United Kingdom"
    },
    {
      "name": "Andrew Rambaut",
      "first": "Andrew",
      "last": "Rambaut",
      "affiliation": "Department of Zoology, University of Oxford, Oxford, United Kingdom"
    }
  ],
  "journal": "PLoS Biology",
  "date": "2006-05",
  "dateElectronic": "2006-03-14",
  "dateAccepted": "2006-01-23",
  "dateReceived": "2005-05-16",
  "volume": "4",
  "number": "5",
  "pages": "e88",
  "tags": [
    "Discipline/Computational Biology",
    "Discipline/Ecology",
    "Discipline/Evolutionary Biology",
    "Discipline/Evolutionary Biology/Paleontology",
    "Discipline/Genetics and Genomics",
    "Discipline/Mathematics/Statistics",
    "Discipline/Virology",
    "System Taxonomy/Animals",
    "System Taxonomy/Eubacteria",
    "System Taxonomy/Plants",
    "System Taxonomy/Primates",
    "System Taxonomy/Yeast and Fungi",
    "Type/Research Article"
  ],
  "abstract": "In phylogenetics, the unrooted model of phylogeny and the strict molecular clock model\n          are two extremes of a continuum. Despite their dominance in phylogenetic inference, it is\n          evident that both are biologically unrealistic and that the real evolutionary process lies\n          between these two extremes. Fortunately, intermediate models employing relaxed molecular\n          clocks have been described. These models open the gate to a new field of\n          “relaxed phylogenetics.” Here we introduce a new approach to\n          performing relaxed phylogenetic analysis. We describe how it can be used to estimate\n          phylogenies and divergence times in the face of uncertainty in evolutionary rates and\n          calibration times. Our approach also provides a means for measuring the clocklikeness of\n          datasets and comparing this measure between different genes and phylogenies. We find no\n          significant rate autocorrelation among branches in three large datasets, suggesting that\n          autocorrelated models are not necessarily suitable for these data. In addition, we place\n          these datasets on the continuum of clocklikeness between a strict molecular clock and the\n          alternative unrooted extreme. Finally, we present analyses of 102 bacterial, 106 yeast, 61\n          plant, 99 metazoan, and 500 primate alignments. From these we conclude that our method is\n          phylogenetically more accurate and precise than the traditional unrooted model while\n          adding the ability to infer a timescale to evolution.",
  "fullText": "Introduction\n      \nFrom obscure beginnings, phylogenetics has become an essential tool for understanding\n        molecular sequence variation. In the past decade, huge progress has been made in developing\n        methods for inferring phylogenies and estimating divergence dates. This development has been\n        characterized by increases, both in the complexity of the models used to describe molecular\n        sequence evolution, and in the sophistication of the methods for analyzing these new models.\n        Nevertheless, a well-known problem that has persistently troubled phylogenetic inference is\n        that of substitution rate variation among lineages. In order to infer divergence dates, it\n        is convenient to assume a constant rate of evolution throughout the tree [1, 2]. This practice has been regularly challenged by\n        results from datasets showing considerable departures from clocklike evolution\n          [3–5], and rate variation among\n        lineages can seriously mislead not only divergence date estimation [6] but also phylogenetic inference\n        (e.g., [7, 8]). \n\nSuch problems with the molecular clock hypothesis have resulted in it being abandoned\n        almost entirely for phylogenetic inference in favor of a model that assumes that every\n        branch has an independent rate of molecular evolution. Under such an assumption, it is\n        possible to infer phylogenies (e.g., [9, 10]), but not to\n        estimate molecular rates or divergence times, because the individual contributions of rate\n        and time to molecular evolution cannot be separated. If the rate and time along each branch\n        can only be estimated as their product, then the position of the root of the tree cannot be\n        estimated without additional assumptions such as an outgroup or a non-reversible\n        substitution process. This unrooted alternative to the molecular clock was first suggested\n        by Felsenstein [10]\n        and has formed the basis of all modern phylogenetic inference and is implemented in all\n        major phylogenetic packages (e.g., PHYLIP [11], PAUP* [12], and MrBayes [9]). \n\nRecently, it has been realized that less drastic alternatives to the unrooted model of\n        phylogeny may exist. Instead of dispensing with the molecular clock entirely, attempts have\n        been made to relax the molecular clock assumption by allowing the rate to vary across the\n        tree [13–15]. For example, local molecular\n        clock models estimate a separate molecular rate for each user-circumscribed group of\n        branches in the tree [6, 13, 16]. However, assigning branches to different\n        groups can be a difficult exercise if the number of sequences is large or if there is\n        considerable uncertainty about the phylogenetic relationships among the taxa. Essentially,\n        such models are only useful in cases in which there is a strong prior hypothesis that the\n        rate of specific taxa will differ from the rest of the tree [6]. \n\nBayesian relaxed-clock methods, including those published by Thorne et al. [15] and Aris-Brosou and Yang\n          [17], present an\n        enticing alternative to local clock models. These model the molecular rate among lineages as\n        varying in an autocorrelated manner, with the rate in each branch being drawn (a priori)\n        from a parametric distribution whose mean is a function of the rate on the parent branch.\n        For example, a lognormal distribution can be employed with the variance scaled relative to\n        the length of the branch in units of time, implying that the evolutionary rate changes\n        continuously along the branch. Alternatively, the use of an exponential distribution would\n        imply that changes occurred at the nodes, with the size of the change being independent of\n        the branch length. \n\nAutocorrelation of rates from ancestral to descendant lineages will occur whenever the\n        largest component of rate variation is due to inherited factors, whether these are\n        life-history traits or biochemical mechanisms. As one looks over smaller and smaller\n        timescales, the differences in such inherited factors become smaller relative to the\n        variance caused by stochastic and uninherited factors (such as environmental or chance\n        events). An alternative way of considering this is that the autocorrelation is so strong\n        that very little of the variation in rate can be attributed to inherited factors. At the\n        other extreme, over very long timescales, we might expect so much variation in the inherited\n        determinants of rate that the autocorrelation from lineage to lineage begins to break down,\n        especially with sparse taxon sampling. However, it is difficult to predict where the\n        boundaries between these effects are and thus to specify what the degree of autocorrelation\n        will be.\n\nRelaxed-clock models present a potentially useful method for removing the assumption of a\n        strict molecular clock, but a major shortcoming of the methods that have been proposed thus\n        far is that they require the user to specify the tree topology. This is a problem because in\n        many cases, important parts of the tree may be uncertain or unresolved, resulting in a\n        number of plausible tree topologies. Furthermore, a molecular clock may have been assumed\n        when estimating the input tree (for example to find a root), but rate variation among\n        lineages can adversely affect phylogenetic inference (e.g., [7, 8]). In some settings, the tree topology may actually be a nuisance\n        parameter and some other aspect of the model (such as the variance in evolutionary rate, the\n        effective population size, or the age of the most recent common ancestor) is the object of\n        interest. Lastly, the assumption of a relaxed clock will alter the posterior probabilities\n        of alternative tree topologies, so that the best tree under a relaxed-clock model may differ\n        from the best tree under an unrooted or strict molecular clock model. For these reasons, a\n        “relaxed phylogenetics” approach, in which the phylogeny and the\n        divergence dates are co-estimated under a relaxed molecular clock, is preferred\n          [18]. \n\nHere we present a Bayesian Markov chain Monte Carlo (MCMC) [19, 20] method for performing relaxed phylogenetics that is able to co-estimate\n        phylogeny and divergence times under a new class of relaxed-clock models. Its utility is\n        demonstrated through simulation and on 871 real datasets. When absolute rates and divergence\n        dates are estimated, we use probabilistic calibration priors, rather than point\n        calibrations, since these more appropriately incorporate calibration uncertainties. We have\n        implemented this method in the application BEAST [21] in which they can be used in conjunction with\n        a wide range of other evolutionary models. \n\n      Results\n      \n        Simulations\n        \nWe generated alignments of nine nucleotide sequences, each 1,000 nucleotides in length,\n          on the rooted tree in Figure 1. The\n          outgroup sequence, O, is only used for rooting; otherwise, the tree is symmetric.\n          Simulations were performed using the program RateEvolver v1.0 [22], which can simulate\n          nucleotide substitution under different rate conditions, including constant (molecular\n          clock), autocorrelated, and uncorrelated rates. \n\nFifty sequence alignments were generated under each of five sets of rate variation\n          models: (1) Rates were fixed at 0.01 average substitutions per site per time unit\n          throughout the tree (i.e., rates conformed to a molecular clock) (CLOC); (2) rates were\n          lognormally autocorrelated among branches, with an ancestral rate of 0.01 average\n          substitutions per site per time unit and a variance parameter (\n            S2) of 0.1, so that S2\n          t = 0.5 (ACLN); (3) rates were exponentially autocorrelated among\n          branches, with an ancestral rate of 0.01 average substitutions per site (ACED); (4) rates\n          were uncorrelated, with the rate in each branch independently drawn from a lognormal\n          distribution with mean 0.01 and variance parameter of 0.5 (UCLN); and (5) rates were\n          uncorrelated, with the rate in each branch independently drawn from an exponential\n          distribution with mean (and therefore standard deviation) of 0.01 (UCED). \n\nA normally distributed calibration prior with mean 20.0 and standard deviation 1.0 was\n          specified for the age of the root of the tree, and the tree topology was fixed. Each\n          alignment was analyzed using BEAST [21] with 5,000,000 steps, following a discarded burn-in of 500,000\n          steps. In each analysis, convergence of the chain to the stationary distribution was\n          confirmed by inspection of the MCMC samples using the program Tracer 1.2 [23]. This application analyses\n          posterior samples of continuous parameters from Bayesian MCMCs to allow visual inspection\n          of the chain behavior, estimating of the effective sample size of parameters and the\n          plotting of marginal posterior densities. The effective sample size is the number of\n          independent samples that would be the equivalent to the autocorrelated samples produced by\n          the MCMC. This provides a measure of whether the chain has been run for an adequate length\n          (for example, if the effective sample sizes of all continuous parameters are greater than\n          200). \n\nIn four of the five cases, the uncorrelated relaxed-clock approach to estimating rates\n          performed well (Table 1). In all\n          cases, the rate estimates made under the UCED had the largest 95% highest\n          posterior densities (HPDs). This can be most clearly seen in the rates estimated from\n          sequences generated under a molecular clock, with the average 95% HPD size\n          under the UCED model exceeding that under the UCLN model by an order of magnitude. \n\nWhen the sequences were simulated under a molecular clock, the 95% HPD\n          interval of the posterior rate estimate almost always contained the true rate under all\n          three analysis models (Table 1). For\n          sequences simulated under any of the other models, CLOC did extremely poorly, with the\n          true rates included in the 95% HPDs between only 3% and\n          11% of the time. Clock estimates of rates from data generated under exponential\n          rate models (ACED and UCED) were poorer than those from data generated under lognormal\n          rate models (ACLN and UCLN); this was expected, since the variance of the exponential\n          distribution is larger than those of the lognormal distributions in our simulations. \n\nFor the data generated under lognormal models (ACLN and UCLN), both of the uncorrelated\n          models (UCED and UCLN) performed well with respect to coverage, with the 95%\n          HPD containing the true rate between 93% and 100% of the time for\n          individual branches. However, for the UCED model this was at the expense of power, with\n          the average size of the HPDs being twice as large as those for the UCLN model.\n\nFor data generated under UCED, the UCED model performed better than UCLN with both models\n          giving the same average size of HPDs, but with the latter model including the true rates\n          in the HPDs slightly less often (82%). Neither model performed as well when the\n          data were generated under an ACED model, with the true rate in the 95% HPD\n          between 36% and 90% of the time.\n\nThe accurate estimation of molecular rates is important because it has a direct impact on\n          the estimation of branch lengths, which can in turn affect the inferred tree topology.\n          Collectively, the results provide a strong recommendation against assuming a molecular\n          clock when analyzing data that have not evolved under clocklike conditions, but the\n          uncorrelated relaxed-clock models also perform well when the data are clocklike. The\n          results favor the use of the UCLN model in that it has an accuracy comparable to the UCED\n          model, but it results in considerably smaller HPDs. In particular, because the UCLN model\n          has the variance of the lognormal distribution as a parameter, it can better accommodate\n          data that are close to being clocklike. This is not contradicting the findings of a\n          previous simulation-based study [22], which suggested that the autocorrelated exponential model\n          outperformed the lognormal model in rate estimation, because the uncorrelated models\n          presented here are fundamentally different from autocorrelated models. Moreover, the\n          previous simulation study considered only the accuracy of the estimates, and not their\n          precision. \n\n        Dengue Virus Type 4 and Human Influenza A Virus\n        \nWe selected two virus datasets that were matched in the number of sequences (\n            n = 69) and the time span over which the data had been sampled (17 y).\n          The first dataset was a previously published sequence alignment of the E\n          gene of dengue-4 virus (1,485 base pairs [bp]) from Puerto Rico\n            [24]. The second\n          dataset was an alignment of hemagglutinin sequences from human influenza A virus selected\n          to have a similar time frame (1981–1998; see Protocol S1 for details). In both\n          of these datasets, each sequence in the alignment represents a consensus of the viral\n          population within a single infected human host at the time of sampling. Therefore, both\n          genealogies represent the ancestral relationships between the virus populations in a\n          sample of 69 infected people spanning a 17-y period. These two viral datasets,\n          particularly influenza A virus, are expected to exhibit the effects of natural selection,\n          given the nature of their life histories [24–26]. \n\nBoth datasets were analyzed under the strict molecular clock and the UCLN and UCED\n          models. For all analyses the HKY (Hasegawa-Kishino-Yano) model of nucleotide substitution\n            [27] was used\n          with gamma-distributed rate heterogeneity among sites [28]. Calibration information for the rate of\n          evolution stems from the fact that each sequence has a date of sampling associated with it\n            [29]. A\n          constant-population coalescent prior was assumed [30]. For each combination of data and model, two\n          independent MCMC analyses were each run for 10,000,000 steps, resulting in acceptable\n          mixing as determined by Tracer 1.2 [23]. Given adequate sampling, these two runs were combined to obtain an\n          estimate of the posterior distribution. The resulting estimates for the overall rate of\n          evolution and coefficients of variation from the six analyses are presented in Table 2. \n\nThe estimated coefficient of variation, σ \n            r\n          , was 0.39 for the dengue virus dataset under the UCLN model. This compares with\n          0.51 for the influenza A dataset, suggesting that the dengue virus sequences are evolving\n          in a more clocklike manner than the influenza virus sequences. Under the UCED model, both\n          datasets produce an estimated σ \n            r\n           of 0.99. Under the exponential distribution σ \n            r\n           should be equal to 1.0 by definition, and the small discrepancy arises because\n          of the discretization procedure described in Materials and\n            Methods. In both datasets the estimated average rate was higher under the UCED\n          model, especially in the internal branches. This elevated rate also corresponded with a\n          lower estimate of the effective population size. Figure 2 shows a tree topology sampled from the posterior\n          of the UCLN analysis of the influenza A virus dataset. \n\n        Marsupials\n        \nIn addition to the viral sequences, we analyzed a marsupial dataset. The alignment\n          contained concatenated nuclear protein–coding genes ( APOB, RAG1, IRBP,\n            vWF, and BRCA1; 3,772 bp) for 17 marsupials and seven\n          (outgroup) placental mammals, obtained from Amrine-Madsen et al. [31]. \n\nThe extensions to BEAST for inferring divergence times, described here, are well suited\n          to the marsupial dataset. It possesses some phylogenetic uncertainty, so it is more\n          reasonable to integrate over the posterior distribution of topologies than to assume a\n          single true topology. Furthermore, the dataset includes taxa that have evolved to\n          substantially different sizes, life histories, and niches, which are all hypothesized\n          predictors of molecular rate variation [32, 33]. \n\nThe early fossil record of marsupials [34] is poorly known. As a result, point\n          calibrations that utilize the oldest fossils that mark divergences of one group from\n          another are likely to be substantial underestimates, whereas simply defining wide\n          calibration bounds can poorly represent our understanding of the fossil record. We\n          selected prior probability distributions as calibration priors (Table 3) with the intention of providing realistic\n          assessments of the uncertainty associated with the fossil record [35]. \n\nFirst, to ascertain the joint prior distribution on the nodes of interest, the four\n          calibration points, the Yule prior, and the reciprocal monophyly constraints were analyzed\n          without any sequence data. The combined results of two runs of 10,000,000 steps are given\n          in Table 3. \n\nIn order to analyze the marsupial data, we assumed a general time-reversible\n            [36] model of\n          nucleotide substitution with gamma-distributed rate heterogeneity among sites\n            [28] and a\n          proportion of invariant sites. In addition, we assumed a UCLN model of rate variation\n          among branches in the tree. A Yule prior on branching rates was employed and the\n          reciprocal monophyly of the ingroup and outgroup was assumed a priori. Four independent\n          MCMC analyses were each run for 10,000,000 steps, resulting in acceptable mixing as\n          determined by Tracer 1.2 [23]. These four runs were combined to obtain an estimate of the posterior\n          distribution (Table 3). The\n          95% credible set of the marsupial analysis included 12 unique tree topologies,\n          and the maximum a posteriori (MAP) tree topology accounted for 0.32 of the total posterior\n          probability. The estimated rate of the fastest branch in the MAP topology was 2.7 times\n          faster than that of the slowest branch. The mean rate of evolution was 0.944 substitutions\n          per site per billion years (95% HPD: 0.817–1.073). The birth rate of\n          the Yule prior was estimated to be 0.0133 (95% HPD: 0.0035–0.0234). \n\nThere was a slight tendency toward a positive correlation in the rate of parent and child\n          branches but this was not significant (zero was included in the 95% HPD). The\n          coefficient of variation was estimated to be 0.32 (95% HPD:\n          0.23–0.43), suggesting that the marsupial dataset is more clocklike than both of\n          the virus datasets. Figure 3 shows the\n          (A) prior and (B) posterior distributions of the clades present in the MAP tree topology. \n\n        Autocorrelation of Rates amongst Lineages\n        \nWe see no autocorrelation for the viruses we analyzed (the HPD interval of the covariance\n          of parent and child branches was [−0.17,0.15] and\n          [−0.18,0.15] for influenza and dengue-4 datasets respectively\n          under the lognormally distributed model of rate variation and\n          [−0.2,0.13] and [−0.19,0.13] for\n          the exponentially distributed model of rate variation). For the marsupial dataset there is\n          a small degree of autocorrelation suggested by the mean estimate, but it is not\n          significantly different from zero (mean: 0.07, HPD: [−0.256,\n          0.4]). We would expect that larger datasets, particularly of diverse organisms\n          that vary considerably in life-history traits or proofreading mechanisms, might exhibit\n          substantial autocorrelation.\n\n        Assessing Accuracy and Precision with Five Large Datasets\n        \nFive large datasets were obtained from previous studies: (1) amino acid alignments of 102\n          genes from eight bacterial species; (2) nucleotide alignments of 106 genes from eight\n          yeast species [37];\n          (3) nucleotide alignments of 61 genes from nine plants; (4) amino acid alignments of 99\n          genes from nine metazoans; and (5) 500 nucleotide alignments of non-coding sequence from\n          nine primates. The bacterial dataset was a subset of a larger dataset comprising 730 genes\n          representing 45 species of bacteria [38]. Eight species of Proteobacteria were\n          selected due to their close phylogenetic relationship, as well as representation among the\n          730 genes. A total of 102 genes spanned all eight of the species that were retained for\n          analysis. The plant dataset was taken from a larger dataset comprising 61 genes from 12\n          taxa [39]. Nine\n          species were selected in accordance with the stipulation that their phylogeny was known\n          with almost complete certainty. The metazoan alignment was a subset of a larger dataset\n          comprising 123 genes from 36 eukaryotes [40]. Nine metazoan taxa were selected from this\n          dataset so that the tree relating the selected taxa was not in dispute. Genes that were\n          unavailable for one or more of the nine selected taxa were removed, leaving 99 genes in\n          the final dataset used for phylogenetic analysis. The primate dataset was a subset of a\n          2,160,276 bp alignment of non-coding DNA from 19 mammals [41, 42]. The non-primates were removed from the alignment, and sites with a\n          gap in any sequence were removed. The remaining alignment was broken up into 500\n          alignments of equal length (632 bp). These individual alignments were each intended to\n          represent the data produced by an ordinary phylogenetic study in which a gene fragment has\n          been sequenced from a number of organisms. The question being asked is if we only have one\n          such alignment, how well are we able to reconstruct the phylogenetic relationships of the\n          organisms? \n\nTo assess the accuracy of the phylogenetic methods being tested, estimates of the\n          phylogeny need to be tested against the true phylogeny for each dataset. In order to\n          obtain the best possible estimates of the phylogeny for each dataset, the alignments in\n          each of the five datasets were concatenated. The five concatenated alignments were\n          analyzed under the HKY model of nucleotide substitution with gamma-distributed rate\n          variation among sites and a proportion of invariant sites. Each analysis was run for\n          5,000,000 MCMC steps, with a discarded burn-in of 500,000 steps. Identical trees were\n          obtained using BEAST with a UCLN model and with MrBayes (Figure 4). The trees inferred from the plant, metazoan,\n          and primate datasets agree well with the established trees for these groups. However, the\n          bacterial and yeast phylogenies are relatively uncertain [37, 43], and the trees inferred from the concatenated alignments are\n          probably the best estimates currently available. Even if these trees turn out to be\n          different from the true evolutionary histories of the studied organisms, we can at least\n          assume that the trees used in this analysis are very near in tree space to the truth, and\n          therefore we would expect our results to be little affected. The yeast tree inferred in\n          this study from concatenated data agreed with that published by Rokas et al.\n            [37], also\n          confirmed by Phillips et al. [43] under different phylogenetic models. \n\nFor each of the five groups of data, each alignment was analyzed using MrBayes (unrooted\n          Felsenstein [UF] model), BEAST with a molecular clock (CLOC); and\n          uncorrelated lognormal relaxed clock (UCLN). The HKY model of nucleotide substitution was\n          assumed, with gamma-distributed rate variation among sites and a proportion of invariant\n          sites. Most analyses were run for 500,000 MCMC steps with 50,000 burn-in steps, although\n          some datasets required 1,000,000 steps with 100,000 burn-in steps. All analyses were\n          checked for convergence using the program Tracer 1.2 [23]. The 95% credible set of trees\n          was obtained for each alignment and compared with the “true” trees\n          obtained using the method described above. The accuracy of the methods was considered to\n          be the frequency with which the true tree was contained in the 95% credible\n          set, whereas the average size of the credible sets was taken to represent precision. These\n          terms have statistical definitions, but we take liberties here to facilitate easier\n          interpretation. \n\nAll three methods performed poorly in analyses of the bacterial and metazoan datasets.\n          This result is not surprising, however, considering the substantial time depth of these\n          trees. The uncorrelated relaxed-clock method produced the most accurate estimates of\n          phylogeny overall (Table 4). It\n          outperformed other methods in analyses of the bacterial, yeast, metazoan, and primate\n          data, but the molecular clock method was the most accurate in the analysis of the plant\n          data. A large proportion (76%) of the yeast alignments were significantly\n          non-clocklike (as measured by a likelihood ratio test [10] on the true tree topology), which explains\n          the considerable difference in accuracy between the uncorrelated relaxed-clock method\n          (85.8% of the credible sets contain the true tree) and the molecular clock\n          method (67.9% of the credible sets contain the true tree). The superior\n          performance of the molecular clock in the analysis of the plant data, for which the\n          molecular clock was rejected for 67% of the alignments, may be due to the\n          sensitivity of the likelihood ratio test to even small departures from the clock\n          assumption. \n\nIn the case of the primate data, all three methods were similarly accurate in estimating\n          phylogenies. This is probably because the data were relatively clocklike, with the\n          molecular clock assumption rejected for less than a third of the alignments. For all of\n          the datasets that were analyzed, the phylogenetic estimates made using a strict molecular\n          clock were the most precise. As expected, the average size of the 95% credible\n          set of trees was always the smallest for the molecular clock method, and nearly always\n          greatest for the unrooted method. Under conditions in which the data more or less conform\n          to a molecular clock, such as the primate data examined in this study, the molecular clock\n          method should be used due to its superior precision.\n\n      Discussion\n      \nThe relaxed phylogenetics methods described here co-estimate phylogeny and divergence times\n        under a relaxed molecular clock model, thus providing an integrated framework for biologists\n        interested in reconstructing ancestral divergence dates and phylogenetic relationships. The\n        method presented here naturally incorporates the time-dependent nature of the evolutionary\n        process without assuming a strict molecular clock. One of the byproducts of estimating a\n        phylogeny using a relaxed clock is an estimate of the position of the root of the tree, even\n        in the absence of a non-reversible model of substitution [44, 45] or a known outgroup. \n\nRecently, a number of authors have begun to investigate the impact of various forms of\n        model misspecification on the accuracy of posterior probabilities of clade support\n          [46–48]. In a Bayesian framework, the\n        absence of a molecular clock assumption (either strict or relaxed) represents a prior belief\n        that the tree topology provides no information about relative branch lengths. We suggest\n        that this represents a poor prior belief, and that Bayesian estimation of phylogeny from\n        short sequences may be biased when the time-dependency of the evolutionary process is not\n        modeled. We would argue that the complex time-dependency of the evolutionary process should\n        not be ignored a priori as has been common practice, but should instead be carefully\n        modeled. This paper represents a first attempt at incorporating a relaxed-clock model into a\n        Bayesian method of phylogenetic inference. \n\nWe have presented a large analysis of 102 bacterial, 106 yeast, 61 plant, 99 metazoan, and\n        500 primate alignments that overall suggests the relaxed-clock models are both more accurate\n        and more precise at estimating phylogenetic relationships than current unrooted methods\n        implemented in MrBayes and other programs. Overall, these initial results suggest that a\n        relaxed phylogenetic approach may be the most appropriate even when phylogenetic\n        relationships are of primary concern and the rooting and dating of the tree are of less\n        interest.\n\n      Materials and Methods\n      \nThe molecular clock assumption can be relaxed in a variety of ways [13–15, 17, 49–52]. In Bayesian treatments of the\n        relaxed clock, there is a vector of rates R={\n          r1, r2,…,\n          r2 n−1 } and a\n        corresponding vector of node heights t={\n          t1, t2,…,\n          t2 n−1 } in units of time.\n        The node height vector, in conjunction with an edge graph, E, define an\n        ancestral tree g = { E, t} in units of time.\n        To convert this tree from units of time to molecular evolutionary units, the rates are\n        either assigned to branches [15, 17] or to nodes\n          [53, 54]. In both types of models, the prior\n        probability of the rates fR\n        ( R| g) can be calculated by the product of the\n        probability of each rate r2 in the tree given the ancestral rate\n            rA\n        ( i)  and the time Δ ti\n         between the ancestral and derived rate: \n\nThe first such model to be described [15] assigned rates to the midpoints of branches\n        and the assumed lognormal prior distribution relating the midpoint of the ancestral branch\n        to the midpoint of the derived branch. Another interesting model is the exponential\n        distribution model of Aris-Brosou and Yang [17], which employed an exponential prior\n        distribution on rate r with a mean (and therefore standard deviation) equal\n        to the ancestral rate rA,  and with no dependence on the time\n        between the two rates. This second model represents a more punctuated view of change in\n        evolutionary rate, so that only the number of branching events, and not the length of time\n        between events, determines the amount of change in evolutionary rate. In all autocorrelated\n        relaxed-clock models, an additional assumption must be made about the rate at the root. For\n        models that assign rates to nodes, it is necessary to treat the root node in a special way,\n        as it does not have a parent node [15]. For models that assign rates to branches, a branch above the root is\n        implied and must be assigned a rate. \n\nIn the autocorrelated relaxed-clock models that have been described, including the commonly\n        used lognormal model [15,\n          17, 55], it is also necessary to specify the degree of\n        autocorrelation as a prior. Other prior models of rate change, such as the gamma\n        distribution model and the Ornstein-Uhlenbeck process [55], require more than one hyperparameter to be\n        specified, so that selecting suitable values for a particular dataset may be an even more\n        difficult exercise. The effects of varying these hyperparameters are poorly understood\n          [22], but there is\n        likely to be a considerable impact on posterior estimates of rates. \n\n        Uncorrelated relaxed clocks\n        \nWe present an alternative to the autocorrelated prior in which there is, a priori, no\n          correlation of the rates on adjacent branches of the tree. Instead we propose a model in\n          which the rate on each branch of the tree is drawn independently and identically from an\n          underlying rate distribution. We investigate two candidates for the rate distribution\n          among branches:\n\nThese uncorrelated priors can be framed in a hierarchical Bayesian framework, as with the\n          autocorrelated priors. In this scenario the exponential version of uncorrelated relaxed\n          clock would have a prior probability on the rate vector of:\n\nThis model corresponds to an exponential prior distribution on rate ri\n           with a mean (and therefore standard deviation) equal to\n            λ−1 and no dependence on either the rate of the previous\n          branch or the time between the two rates. The parameter λ is a hyperparameter\n          that is fixed and not estimated via MCMC, and represents a prior statement about both the\n          mean and the variance of branch rates. This prior reflects a punctuated view of change in\n          evolutionary rate, so that the prior expectation of the rate at all branches is the same,\n          with no autocorrelation between adjacent branches. Notice that the posterior distribution\n          of rates among branches need not be the same as the prior in this setup and that\n          autocorrelation may exist in the posterior, even though it is not specified in the prior. \n\nInstead of framing Equations 2 and 3 as prior\n          distributions in a hierarchical Bayesian framework, they can instead be reformulated as a\n          full likelihood model. In this case, the branch rates are not independent random variables\n          with a prior distribution, but are instead constrained so as to fit one of the\n          distributions in Equations 2\n          and 3 exactly. The parameters\n          of the rate distribution are no longer hyperparameters of a prior distribution, but are\n          instead parameters of the likelihood model. This is closely analogous to the common way in\n          which rate heterogeneity among sites is treated [28]. \n\n        Priors on phylogeny\n        \nA particular requirement of Bayesian phylogenetic inference is the responsibility given\n          to users to specify a prior probability distribution on the shape of the phylogeny (node\n          ages and branching order). This can be either a benefit or a burden, largely depending on\n          whether an obvious prior distribution presents itself for the data at hand. For example,\n          the coalescent prior [56,\n            57] is a commonly used\n          prior for population-level data and has been extended to include various forms of\n          demographic functions [58,\n            59], sub-divided\n          populations [60],\n          and other complexities. Traditional speciation models such as the Yule process\n            [61] and various\n          birth–death models [62, 63] can also\n          provide useful priors for species-level data. Such models generally have a number of\n          hyperparameters (for example, effective population size, growth rate, or speciation and\n          extinction rates), which, under a Bayesian framework, can be sampled to provide a\n          posterior distribution of these potentially interesting biological quantities. \n\nIn some cases, the choice of prior on the phylogenetic tree can exert a strong influence\n          on inferences made from a given dataset [64]. The sensitivity of inference results to the\n          prior chosen will be largely dependent on the data analyzed and few general\n          recommendations can be made. It is, however, good practice to perform the MCMC analysis\n          without any data in order to sample wholly from the prior distribution. This distribution\n          can be compared to the posterior distribution for parameters of interest in order to\n          examine the relative influence of the data and the prior (Figure 3). \n\n        Bayesian inference\n        \nThe full Bayesian sequence analysis with an uncorrelated relaxed-clock model allows the\n          co-estimation of substitution parameters, relaxed-clock parameters, and the ancestral\n          phylogeny. The posterior distribution is of the following form:\n\nThe vector Φ contains the parameters of the relaxed-clock model (e.g., μ\n          and σ2 in the case of lognormally distributed rates among branches).\n          The term Pr D|g,Φ,Ω is the standard Felsenstein\n          likelihood, where g is a tree with branch length measured in units of\n          time. For the purposes of calculating this likelihood, branch lengths are converted to\n          units of substitutions by multiplying the rates defined by Φ with the internode\n          distance between node i and parent node j in tree\n            g. The tree prior, fG\n          ( g|Θ), can either be a coalescent-based prior\n            [30, 65] for within-population data or some other\n          appropriate prior if the sequences come from multiple populations/species [55]. The vector Θ\n          contains the hyperparameters of the tree prior. The vector Ω contains the\n          parameters of the substitution model (such as transition/transversion ratio, κ;\n          shape parameter for gamma-distributed rates among sites, α; and proportion of\n          invariant sites, pinv\n          ). \n\nWe summarize the posterior density in Equation 5 using samples (\n          g,Θ,Φ,Ω) ∼ f\n          obtained via MCMC. If, for example, the divergence times are of primary interest then the\n          other sampled parameters can be thought of as nuisance parameters, and vice versa. \n\nThe formulation in Equation\n            5 implies that the branch-rates could be integrated analytically in the\n          Felsenstein likelihood. Although this could be accomplished relatively easily by\n          discretizing the rate distribution and averaging the likelihood over the rate categories\n          on each branch, we elected to do the integration using MCMC. This was achieved by\n          assigning a unique rate category c ∈ 1,2,…,2\n            n−2 to each branch j of the tree. During the\n          calculation of the likelihood the rate category c is converted to a rate\n          by the following method: \n\nThe function D−1( x) is the\n          inverse function of the probability distribution function, D(\n            x)= P( X≤ x),\n          of the relaxed-clock model specified by Equations 2 and 3. This discretization of the underlying rate\n          distribution is illustrated in Figure\n            5 for a lognormal distribution with 12 rate categories (sufficient for a tree of\n          seven tips). To integrate the branch rates out, the assignment of rate categories\n            c to branches was sampled via MCMC. \n\n        Model selection\n        \nOne issue that remains largely unresolved in this piece of work is the issue of model\n          comparison and model selection. Within a Bayesian framework, Bayes factors are usually\n          regarded as the correct way to deal with model selection. Typically this involves a\n          technique known as reversible-jump MCMC. We have not implemented this, but we do plan on\n          developing a reversible-jump MCMC version of this framework in the future. Typically model\n          selection is easy when one model produces a much better fit. Because all of the models for\n          rate variation examined here differ by one free parameter at most, a simple comparison of\n          the average log posterior probabilities will usually be revealing. It is only when the log\n          posteriors are very similar and the results are qualitatively different between the two\n          models that model selection becomes an issue. This combination of conditions did not occur\n          in any of our real datasets.\n\n        Proposing new states in the MCMC kernel\n        \nThe MCMC must sample the tree topology, the divergence times, and the individual\n          parameters of the substitution model and tree prior(s). Therefore, a series of proposal\n          distributions (often called “moves”) needs to be employed. Our MCMC\n          implementation employs an array of moves, each of which is designed to explore a certain\n          subspace in the overall parameter/model space being explored. For example, some moves\n          propose local changes to the tree topology while keeping the coalescent interval and all\n          the other parameters constant. Some moves propose a change to a single substitution\n          parameter (such as the shape parameter of the gamma distribution) while keeping everything\n          else constant. The general scheme is to (1) choose a random move with a probability\n          proportional to a specified weight, then (2) apply the move to the current state, and (3)\n          assess the relative score of the new state. The new state is adopted if it has a higher\n          posterior probability; otherwise it is adopted with probability equal to the ratio of its\n          posterior probability to the posterior probability of the previous state. The weights\n          allow the researcher to favor certain moves which can help with the performance of the\n          MCMC, but generally the default weights give good results. Most of the moves used in our\n          MCMC implementation have been previously described [30]. The two new moves involve sampling the rate\n          categories of the branches (a random pair of branches are chosen and their categories are\n          swapped) and dealing with rate categories of branches when a change to the tree topology\n          is made. (We implement two alternatives: keeping all the rate categories the same when a\n          subtree is moved or performing a single rate swap simultaneously with a tree topology\n          change.) These moves are very simplistic, and we suspect that better proposal\n          distributions exist. We have found a small number of datasets in which our current\n          proposal distribution does not work well. Nevertheless, for a large number of datasets\n          including the ones presented in this paper, our scheme performs more than adequately as\n          assessed by repeated runs and estimation of integrated autocorrelation times. \n\n        Summarizing the posterior distribution\n        \nThe output of an MCMC analysis is a set of samples from the posterior distribution. In\n          the case of the uncorrelated relaxed-clock models described above, the posterior\n          distribution is a distribution over tree topologies, dates of divergence, branch rates,\n          and parameters of the rate and substitution models. This complex set of samples can be\n          summarized in many ways. One of the simplest summaries of the branch rate distribution is\n          to sample the coefficient of variation (σ \n            r\n          ; the standard deviation divided by the mean) of the branch rates. Under the\n          exponential model, σ r = 1  by definition; under the\n          lognormal model, σ \n            r\n           gives a measure of the degree of clocklikeness of the data. If σ \n            r\n           = 0 then the data are perfectly clocklike, whereas larger values correspond to\n          increasing rate heterogeneity among branches. A posterior estimate of σ \n            r\n           can be easily calculated: \n\nThis is the simple average of the calculated \n          \n          over all L samples in the estimated posterior distribution. In addition,\n          95% HPD limits can also be calculated. In a similar manner, marginal posterior\n          estimates can be calculated for \n\nSome subtlety in the interpretation of the posterior distribution of rates is required\n          because both the amount of time a branch represents, tj,  and\n          the rate of evolution along the branch, rj\n          , are random variables in the MCMC analysis. For example, in general,\n            E[ rjtj\n          | D] ≠ E[\n              rj\n          | D]· E[\n              tj\n          | D]. For the purposes of this paper, when we refer to\n          the average rate for a set of branches B (such as the set of external\n          branches or the set of internal branches), we define it as the weighted average: \n\nrather than the simple unweighted average \n          .\n          Thus the posterior estimate of average rate over the whole tree is\n          E[ r( T) |\n            D], where T = {1,2,…,2\n            n−2}. In general, this will be different from the\n          mean of the underlying rate distribution because the rate at each branch is weighted by\n          the time represented by the branch. The justification for this is that the overall rate is\n          best summarized by the total amount of substitutions over the total amount of time, which\n          is what Equation 8\n          calculates. \n\n        Calibrating the rate of evolution\n        \nIn the above discussion on rate models, it was assumed that it is possible to estimate\n          absolute rates of evolution and the variance in absolute rates. In fact, even under a\n          molecular clock assumption, the divergence times and the overall substitution rate can\n          only be separately estimated if there is a source of external calibration information. In\n          the framework described here, this information can come from one of three sources: (1)\n          Prior information on the age of internal nodes: In a phylogenetic context, calibration\n          information is often obtained by assigning the age of a known fossil to a particular\n          internal node [2].\n          Uncertainty in the association between an internal node and the fossil record can be\n          accommodated by providing a prior probability distribution for the age of the node.\n          Previous studies have used a uniform distribution with upper and lower bounds on the age\n            [54], although\n          other distributions may be suitable [35]. In the above Results section, we presented\n          examples in which calibration times are treated with parametric prior distributions\n          (normal and lognormal). Assigning an age to a particular node is only possible when the\n          tree itself is assumed to be known and fixed, a limitation of previous relaxed-clock\n          implementations [15, 17, 54]. In the framework presented here, the tree\n          itself is being sampled and thus we cannot define the age of a particular internal node.\n          Instead we specify the age, or the prior distribution of age, for the most recent common\n          ancestor of a set of taxa. Every time a new tree is proposed in the MCMC chain, the most\n          recent common ancestor of the specified taxa is located in the tree, and the prior\n          probability of the age of this node is used to assess the acceptance probability of the\n          proposed tree. (2) Known ages of the sequences: Recently it has also been demonstrated\n          that calibrations can be associated with the sequences at the tips of the tree if they are\n          sampled at significantly different times [29, 30, 66] with\n          respect to their rate of evolution. Again, there may be uncertainty in calibration dates\n            [67]. The RNA\n          virus data in this study provide examples of this form of calibration information. (3) A\n          strong prior on the substitution rate: If the mean substitution rate is known from a\n          previous study on independent data, then this can be incorporated as prior knowledge. In\n          the simplest case this can be achieved by fixing the rate of evolution to a known value.\n          It is also straightforward to sample the rate from a parametric distribution obtained from\n          a previous (independent) analysis [68, 69]. If there\n          is no prior information about the mean substitution rate, then it can be fixed to 1,\n          resulting in time being in units of substitutions per site. \n\nAll of these forms of calibration information can be incorporated into our MCMC\n          implementation either on their own or in any combination, as appropriate.\n\n      Supporting Information",
  "externalIds": [
    "pmid:16683862",
    "pii:05-PLBI-RA-0392R4",
    "pmcid:PMC1395354"
  ]
}