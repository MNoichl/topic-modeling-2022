{
  "schema": "https://data.sciveyor.com/schema",
  "version": 5,
  "id": "doi:10.1371/journal.pbio.2000640",
  "doi": "10.1371/journal.pbio.2000640",
  "externalIds": [
    "pii:pbio.2000640",
    "pmid:28027308",
    "pmcid:PMC5189937"
  ],
  "license": "This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.",
  "licenseUrl": "http://creativecommons.org/licenses/by/4.0/",
  "dataSource": "Public Library of Science",
  "dataSourceUrl": "https://data.sciveyor.com/source/plos",
  "dataSourceVersion": 1,
  "type": "article",
  "title": "Cell Fate Decision as High-Dimensional Critical State Transition",
  "authors": [
    {
      "name": "Mitra Mojtahedi",
      "first": "Mitra",
      "last": "Mojtahedi",
      "affiliation": "Department of Biological Sciences, University of Calgary, Calgary, Alberta, Canada; Institute for Systems Biology, Seattle, Washington, United States of America"
    },
    {
      "name": "Alexander Skupin",
      "first": "Alexander",
      "last": "Skupin",
      "affiliation": "Institute for Systems Biology, Seattle, Washington, United States of America; Luxembourg Centre for Systems Biomedicine, Esch-sur Alzette, Luxembourg"
    },
    {
      "name": "Joseph Zhou",
      "first": "Joseph",
      "last": "Zhou",
      "affiliation": "Institute for Systems Biology, Seattle, Washington, United States of America"
    },
    {
      "name": "Ivan G. Castaño",
      "first": "Ivan G.",
      "last": "Castaño",
      "affiliation": "Department of Biological Sciences, University of Calgary, Calgary, Alberta, Canada; Corporación Parque Explora, Department of innovation and design, Medellin, Colombia"
    },
    {
      "name": "Rebecca Y. Y. Leong-Quong",
      "first": "Rebecca Y. Y.",
      "last": "Leong-Quong",
      "affiliation": "Department of Biological Sciences, University of Calgary, Calgary, Alberta, Canada"
    },
    {
      "name": "Hannah Chang",
      "first": "Hannah",
      "last": "Chang",
      "affiliation": "5AM Ventures, Menlo Park, California, United States of America"
    },
    {
      "name": "Kalliopi Trachana",
      "first": "Kalliopi",
      "last": "Trachana",
      "affiliation": "Institute for Systems Biology, Seattle, Washington, United States of America"
    },
    {
      "name": "Alessandro Giuliani",
      "first": "Alessandro",
      "last": "Giuliani",
      "affiliation": "Environment and Health Department, Istituto Superiore di Sanità, Roma, Italy"
    },
    {
      "name": "Sui Huang",
      "first": "Sui",
      "last": "Huang",
      "affiliation": "Department of Biological Sciences, University of Calgary, Calgary, Alberta, Canada; Institute for Systems Biology, Seattle, Washington, United States of America"
    }
  ],
  "journal": "PLOS Biology",
  "date": "2016-12-27",
  "dateAccepted": "2016-11-22",
  "dateReceived": "2016-07-25",
  "volume": "14",
  "number": "12",
  "pages": "e2000640",
  "tags": [
    "Animal cells",
    "Cell biology",
    "Cell differentiation",
    "Cell potency",
    "Cellular types",
    "Computational biology",
    "Cytokines",
    "Cytophotometry",
    "Developmental biology",
    "Discipline-v3/Animal cells",
    "Discipline-v3/Biology and life sciences",
    "Discipline-v3/Cell biology",
    "Discipline-v3/Cell differentiation",
    "Discipline-v3/Cell potency",
    "Discipline-v3/Cellular types",
    "Discipline-v3/Computational biology",
    "Discipline-v3/Computer and information sciences",
    "Discipline-v3/Cytokines",
    "Discipline-v3/Cytophotometry",
    "Discipline-v3/Developmental biology",
    "Discipline-v3/Dynamical systems",
    "Discipline-v3/Flow cytometry",
    "Discipline-v3/Gene expression",
    "Discipline-v3/Genetics",
    "Discipline-v3/Genome analysis",
    "Discipline-v3/Genomics",
    "Discipline-v3/Immune physiology",
    "Discipline-v3/Immune system",
    "Discipline-v3/Immunology",
    "Discipline-v3/Innate immune system",
    "Discipline-v3/Mathematics",
    "Discipline-v3/Medicine and health sciences",
    "Discipline-v3/Molecular development",
    "Discipline-v3/Multipotency",
    "Discipline-v3/Physical sciences",
    "Discipline-v3/Physiology",
    "Discipline-v3/Research and analysis methods",
    "Discipline-v3/Spectrophotometry",
    "Discipline-v3/Spectrum analysis techniques",
    "Discipline-v3/Stem cells",
    "Discipline-v3/Systems science",
    "Discipline-v3/Transcriptome analysis",
    "Dynamical systems",
    "Flow cytometry",
    "Gene expression",
    "Genetics",
    "Genome analysis",
    "Genomics",
    "Immune physiology",
    "Immune system",
    "Immunology",
    "Innate immune system",
    "Mathematics",
    "Molecular development",
    "Multipotency",
    "Physiology",
    "Spectrophotometry",
    "Spectrum analysis techniques",
    "Stem cells",
    "Systems science",
    "Transcriptome analysis",
    "Type/Research Article"
  ],
  "abstract": "Cell fate choice and commitment of multipotent progenitor cells to a differentiated lineage requires broad changes of their gene expression profile. But how progenitor cells overcome the stability of their gene expression configuration (attractor) to exit the attractor in one direction remains elusive. Here we show that commitment of blood progenitor cells to the erythroid or myeloid lineage is preceded by the destabilization of their high-dimensional attractor state, such that differentiating cells undergo a critical state transition. Single-cell resolution analysis of gene expression in populations of differentiating cells affords a new quantitative index for predicting critical transitions in a high-dimensional state space based on decrease of correlation between cells and concomitant increase of correlation between genes as cells approach a tipping point. The detection of “rebellious cells” that enter the fate opposite to the one intended corroborates the model of preceding destabilization of a progenitor attractor. Thus, early warning signals associated with critical transitions can be detected in statistical ensembles of high-dimensional systems, offering a formal theory-based approach for analyzing single-cell molecular profiles that goes beyond current computational pattern recognition, does not require knowledge of specific pathways, and could be used to predict impending major shifts in development and disease.",
  "fullText": "Introduction\n\nA multipotent stem cell or a progenitor cell is in a state that poises it to be able to commit to one of multiple available options of predestined cell lineages and to differentiate. However, its state-characteristic gene expression profile is stably maintained because the cell is in a stable (or meta-stable) attractor (potential well) [1,2] generated by the gene regulatory network (GRN) in the high-dimensional gene expression state space. An attractor state represents a local minimum or, as sometimes referred to, a ground state [3], the lowest point in the basin of attraction of the attractor. The high-dimensional attractor guarantees that the state-characteristic genome-wide gene expression pattern is self-stabilizing, withstanding the stochastic molecular fluctuations. Therefore, as cells differentiate and alter their gene expression pattern in a coordinated manner to ultimately implement the expression pattern of the new cell type, they must first overcome this stabilization of the progenitor ground state imposed by the GRN.\n\nIndividual multipotent progenitor cells can, due to the stochastic gene expression fluctuations, temporarily and by chance, approach the border of the basin of attraction of their attractor and thereby be transiently primed to exit the progenitor state in a random direction, giving rise to the occasionally observed spontaneous, apparently stochastic differentiation into one of a set of alternative lineages. It is thought that the associated (unlikely) chance configurations of expression in the appropriate set of regulatory genes could place an outlier cell so as to facilitate its jump over basin boundaries into the neighboring basin of attraction of a destination lineage [4–6]. Once in the new basin, the cell will robustly establish the new gene expression pattern of the respective destination cell type as it enters the new attractor state [2].\n\nIn the qualitative parlance invoking gene regulatory circuitries, a committed cell’s robust, self-sustained, and apparently irreversible move toward a new (differentiated) state once it has left the old (undifferentiated) state is often explained by the reinforcing activity of a positive feedback control loop. By contrast, the formal approach that treats complex regulatory networks in an integrative manner as a high-dimensional dynamical system posits that stable cell states (cell types) are attractor states. This formalism naturally explains, without invoking specific gene regulatory circuitries, why spontaneous differentiation without instructive signal can produce the highly specific gene expression patterns of existing cell types [1, 2].\n\nUnder physiological conditions, spontaneous differentiation is rare. But appropriate tissue signals can trigger an efficient exit from the progenitor attractor and the commitment to a specific cell lineage. Here, the fundamental question remains as to how such signals overcome the stability of the progenitor attractor state and direct the fate decision toward another attractor representing a particular cell type. One possibility is that differentiation signals operate simply by coordinating gene expression changes in a deterministic manner so as to place the cells either at a specific site on the border of the basin of attraction of the progenitor cell, thus priming the cell to be susceptible to noise-driven entry into the desired destination attractor of the new lineage, or already at a state within the basin of attraction of that destination cell type. This older view [7], schematically intuited in Fig 1 (right panels), does not involve any distortion of the attractor basins. The alternative possibility is that the differentiation signal may cause a destabilization of the (high-dimensional) gene expression attractor state, thereby drastically facilitating the (noise-driven) exit from the progenitor attractor and entry into a new attractor state. The destabilization can be imagined as a flattening of the potential well. Then, a bias (tilt) in the direction of destabilization (asymmetric flattening of the attractor well) would allow the differentiation signal to influence the fate decision toward a given lineage [8].\n\nA destabilization that results in the disappearance of an attractor state constitutes a bifurcation event in a nonlinear dynamical system: a “sudden” qualitative shift of a system’s configuration of steady states x(t) (here, from existence to nonexistence of the progenitor attractor) while a control parameter, the bifurcation parameter μ in the systems equations that describe the dynamics of the system, ẋ(t) = F(x(t), μ), is continuously altered [9–10]. Here, however, the system equations of the high-dimensional system (see S1 Fig), notably, the bifurcation parameters μ, are typically not known. In such cases, a phenomenological description of the bifurcation behavior is more appropriate, in which the bifurcation appears as a critical state transition [11–12]. Herein, a presumed stable attractor state is observed to gradually destabilize until the system (cell) suddenly passes a tipping point. At this critical point, the attractor basin is completely flattened (at least with respect to one state space dimension), and a new neighboring attractor state that is discretely distinct from the initial one becomes accessible. The system (the cell) can then rapidly descend into it.\n\nCritical state transitions have been implicated in abrupt shifts in ecosystems, climates, and social systems, and also in disease transitions [13]. The preceding destabilization of the system is equivalent to a weakening of the stabilizing forces. Hence, it is manifest in increased (noise-driven) excursions of the system state x(t) away from its stable steady-state (equilibrium) point x*, as well as in a slowed return to it. These manifestations are plausible within the permissive image of a flattening attractor basin. Such observables of a system approaching a bifurcation event are the early warning signals of an impending critical transition and can often be quantified as an increase in the amplitude and temporal autocorrelation of the stochastic fluctuations of the systems variable x(t) around x* [11–12].\n\nWhile critical transitions have been widely studied in systems whose system state can be described by a one-dimensional state variable x(t) [11–13], cell states are defined by a high-dimensional state vector x(t) [14], which, for practical purposes, can be defined by the reliably measurable transcript abundance of a set of m genes that participate in the shift of gene expression patterns associated with the cell state transition. Systems equations that describe the change in time of a GRN state x(t) could, in principle, be formulated to model all the regulatory interactions of the relevant regulatory genes and predict the existence of a bifurcation in the dynamics of x(t). However, because the specification of the regulatory interactions required for such dynamical models are typically not available in sufficient detail despite our increasing knowledge of the topology of GRNs (S1 Fig), the identity of the relevant bifurcation parameter whose gradual change would drive the differentiation process remains elusive. Nevertheless, numerous generic mathematical models of the dynamics of small GRNs driving cell differentiation for specific cell types have been proposed and successfully predict attractor states and bifurcations that map to the observed cell state behaviors [8,15–20].\n\nGiven the uncertainties in GRN specification for cell fate decisions, we depart from such explicit modeling of GRN dynamics and study them within the phenomenological framework of critical state transitions. This is warranted because cell lineage commitment by a multipotent cell is, in fact, characterized by a sudden, discontinuous shift of a stable cell state to another state. But instead of monitoring a single state variable x(t) continuously, we measure a set of m = 17 transcripts that serve as components of the high-dimensional state vector x(t) and are members of a core regulatory network that is involved in the commitment of a multipotent progenitor cell to either the myeloid or erythroid lineage (S1 Fig). Because high-dimensional gene expression profiles can currently only be measured in a destructive manner, their changes cannot be monitored in a continuous way but only at discrete time points in replicate systems. High-dimensional critical state transitions have been studied for global shifts in microarray-based transcriptomes [21], but this type of data on x(t) is an aggregate of heterogeneous mixtures of dynamical systems (i.e., cells).\n\nHere we take advantage of single-cell resolution measurements of the state vector x(t) representing the GRN state of an actual system (a cell), defined by its abundance of the m species of transcripts but for a population of cells that represents a statistical ensemble of n systems (cells). We derive a generic quantity, the index IC(t), that is computed from the (n × m) data matrix X(t) at discrete time points t during the differentiation process. Thus, in essence, we make up for the lack of a continuous time series that captures the fluctuations of cell state by exploiting the availability of the individual states in a statistical ensemble of n cells, measured as time snapshots. We show formally and experimentally that a (relative) increase of IC(t) serves as an early warning signal of a critical transition that coincides with lineage commitment following a gradual destabilization of the multipotent progenitor state. Thus, we exploit high-dimensionality and the new granularity afforded by single-cell gene expression analysis of a cell population and take into consideration first principles from the theory of nonlinear dynamical systems to predict, without explicit modeling of the underlying regulatory interactions, an impending qualitative phenotype shift. Our theory also explains the observation of “rebellious cells” during binary fate decisions and, together with the findings, unites the old dichotomy between selection and instruction in cell fate determination.\n\nResults\n\nSingle-Cell Resolution Gene Expression Analysis Suggests Preexisting Stable Attractor States\n\nTo determine if differentiation goes through a tipping point in high-dimensional gene expression state space, we studied the commitment of the murine multipotent hematopoietic precursor cell line EML [22] into an erythroid or a myeloid fate when released from the progenitor state and stimulated either with EPO (erythropoietin) or with GM-CSF (granulocyte macrophage colony-stimulating factor) / IL-3 (interleukin 3), respectively [4]. In a third experiment, we treated EML cells with a combination of EPO and GM-CSF/IL-3 to separate destabilization from fate choice, because we reasoned that the latter should be neutralized by the conflicting combination treatment. To ensure that heterogeneity of the starting cell population is strictly due to dynamic fluctuations and not due to preexisting, differentially preprimed cells of unknown developmental history (which then would merely be selectively enriched for particular fates by the respective growth factors) [23], we used a clonal cell line as opposed to purified primary cells. This permitted the study of the actual phenotypic diversification in maximally uniform cell populations of cells recently derived from a single common ancestor under invariant and homogenous conditions to assure common history and maximal phenotypic homogeneity. While such a progenitor cell line may not reflect biological reality because the cells are likely trapped in a ground state attractor not necessarily present in vivo [3, 24], as readily revealed by molecular profiling, it offers a robust model system to expose and study fundamental principles of dynamical systems that do not depend on idiosyncrasies of the specific biology.\n\nWe monitored transcript expression patterns at single-cell resolution using qPCR to acquire information about the stability of a nominal cell state x(t) presented by the cell population, which constitutes a statistical ensemble of (randomly distinct) replicates of a system. For instance, increase in cell state diversity would suggest destabilization of the nominal cell state. We found that qPCR was far more sensitive than single-cell RNA-seq in the detection of low abundance transcripts (S1 Appendix, A.7). The problem of low sensitivity is amplified by the low capture rate of transcripts in single cell–gene expression analysis (typically 60% to 90% of transcripts of a given cell are lost) and by technical (sampling) noise [25–27]. This can lead to false-positive sets of mutually exclusive expression of transcripts and thereby inflate cell-cell diversity, which is a crucial quantity in our analysis (S1 Appendix, A.8) [28].\n\nExit from the progenitor state was first verified by flow cytometry measurement of the downregulation of the stem-cell markers Sca1 and c-kit. The induction of a bimodal distribution with a new discrete subpopulation with lower Sca1 (and c-kit) surface protein expression confirmed the switch-like state transition to a committed state (Fig 1A). Fig 1B shows the time course of single-cell transcript patterns of 17 selected genes known to be functionally involved in or to mark the fate commitment of EML cells, plus two “housekeeping genes” (S1 Fig and S1 Table).\n\nThe single-cell states were visualized by plotting each cell as a point in the Cartesian space spanned by the three principal components (PC) from a principal component analysis (PCA) of concatenated expression data across all time points to reduce the 19-dimensional state space (17 genes of interest + 2 reference genes; see S1 Appendix). As seen in Fig 1B, the “cloud” of untreated cells (grey, depicted for reference for each time point) spread upon treatment (colored balls; where red and blue colors are a priori labels, indicating treatment with EPO or GM-CSF/IL-3, respectively), and reached highest diversity at day 3 (d3). The cells then coalesced into two distinct dense clusters at day 6 (d6), representing the cells committed to the erythroid (red) and myeloid (blue) lineages, which were identified by the characteristic expression of erythroid or myeloid transcript levels (S2 Fig and S1 Table). As shown in S3 Fig, in this single-cell qPCR, measurement noise was only a small fraction of biological cell-to-cell variability; thus, the dispersion of points in state space predominantly reflects biological diversity of cells. Loading of gene scores show that PC1 captures the erythroid–myeloid dichotomy, whereas PC2 reflects the stemness–differentiation axis (S4 Fig). For visualization purposes, single-cell resolution measurement, which provides the local cell density for each position in state space, can be depicted as the elevation of an approximate (fixed) quasipotential landscape (Fig 1C, legend) [29], which serves as visual guide and shows the three attractor states as minima (potential wells) compressed into one landscape.\n\nInterestingly, progenitor cells receiving a combined treatment also diverged at d3 but stayed in an intermediate, undecided region of the state space before consistently joining the myeloid cluster (Fig 1B). Thus, the conflict of signals delayed the fate decision, but a uniform decision was eventually made. This decision-making, in view of ambiguous signals, corroborates the notion that gene expression change during lineage determination is not simply instructed by external growth factors but also governed by intrinsic constraints that channel cells toward predestined fates—the attractors of the GRN. Importantly, this model does not allow for stable intermediates, as Waddington first observed [30]. In this case, it appears that the attractor for the myeloid fate is more readily accessible or that, in our combined differentiation protocol, the myeloid signal somehow dominates, although the cells that resolved the conflict still remained distinguishable from the pure myeloid cells.\n\nDestabilization of the Progenitor State and the Critical State Transition Index IC\n\nIndependent of the (unknown) detailed dynamics of the underlying GRN, a destabilization and disappearance even of a high-dimensional attractor state is a bifurcation event and, therefore, should display the signatures of an approach to a critical state transition [11] at which cells would undergo a discontinuous switch toward the destination state. While the bimodal distribution of Sca1 (Fig 1A) after d3 indeed suggests a quasi-discrete transition, it cannot reveal a destabilization of a high-dimensional state x(t) prior to the switch. Recently reported cases of critical transitions in stressed ecosystems and disease processes (refs. in [13]) pertain to low-dimensional systems in which, typically, one system variable x(t) was observed longitudinally over time. By contrast, here we examine time snapshots of states of a high-dimensional system (m = 17-dimensional cell state vector) embodied by the GRN.\n\nBased on theoretical consideration, we showed that a critical destabilization and transition to a new attractor will be manifest in two changes in the correlation statistics (as explained and derived in S2 Appendix, B.1–B.3) of the (n × m) data matrix X(t) [31]:\n\nThe first change is (trivially) a decrease of cell–cell correlation R(cell k, cell l) between all pairs of the n cell state vectors in the m = 17-dimensional gene space. This reflects the expected increase of amplitudes of random fluctuation of gene expression due to the weakening attracting force in the flattening basin of attraction prior to the bifurcation [32]. This decrease in the coefficients of correlation R between all pairs of n cell state vectors captures an increase in cell–cell diversity.\n\nThe second change is the concomitant increase of gene–gene correlation R(gene i, gene j) between all pairs of the m gene vectors that describe the gene expression values of each gene across all the cells. Unlike the former, this change is less intuitive. The increase in the correlation coefficients between all pairs of the m gene vectors (with n components each), as mathematically derived in S2 Appendix, arises because of the symmetry-breaking destabilization in a high-dimensional attractor. In short, this can be made plausible from two different perspectives:\n\nIn statistical terms, this change is a consequence of the range restriction effect on correlation, when the dominance of the symmetric stochastic fluctuations of gene expression around the attractor state, which minimizes gene–gene correlations, yields to the nonsymmetric, regulated change of gene expression (S2 Appendix, B.2) [31,33].\n\nIn the dynamical system description, this change is a formal consequence of the appearance of a saddle point in the m-dimensional state space through which the individual cells pass during the bifurcation, and in doing so align along a reaction coordinate, thus occupying a subspace of reduced dimensionality (see S2 Appendix, B.3).\n\nNote that here, “correlation” (between cells or genes) does not simply have the usual function of indicating an association between two variables but is derived from elementary principles of the constraints in data and of dynamical systems theory. The above considerations concerning the two opposite changes in the two correlation statistics then motivate an index for critical transitions, IC:\n\nwhere g are gene vectors, S are the cell state vectors at sampling time t, and 〈R(…,…)〉 denotes the average of all Pearson’s correlation coefficients of respective pairs of vectors. We postulate that IC increases toward a maximum when cells go through the critical state transition (S2 Appendix). Recently, Chen et al. proposed a similar index for full transcriptome time courses, which, for lack of single-cell resolution state vectors, has to estimate state diversification and requires a separate explicit selection of a subset of genes among which the correlation is computed [21]. Here we start from a predefined set of m = 17 selected genes that are known to change significantly (as actuator or as marker) during fate commitment in order to demonstrate the signature of a high-dimensional critical state transition.\n\nFig 2A shows the n × n heat map for cell–cell correlation coefficients R(Sk, Sl) for all pairs of the n = 1,600 cells for the three treatments (EPO, GM-CSF/IL-3 and combined) at each time point t. The diagonal shows that correlation of cells within the populations decreases at d1 and notably at d3, compared to d0, and increases again at d6, indicative of a transient diversification of cell states and a return to a more homogenous population consistent with an attractor state. Because we also recorded the cells’ position with respect to the Sca1 surface marker expression (roughly partitioning the population into three fractions, Sca1-high (H), Sca1-medium (M) and Sca1-low (L) [see Fig 1A]), one can see that the decrease of correlation was not due to comparing cells across subpopulations in bimodal populations (Fig 1A). The higher correlation among the cells within the extreme-low Sca1 fraction (Lʹ) in both EPO and GM-CSF/IL-3 treatment is consistent with advanced commitment of cells that are enriched in the Sca1-low fraction toward the erythroid fate, as previously reported [4]. By contrast, the high correlation among the H cells at the end of EPO treatment reflects “rebellious” cells that became myeloid under EPO treatment (see below).\n\nThe second criterion of a critical state transition, the increase in gene–gene correlation 〈R(gi, gj)〉, is shown in Fig 2B. Both EPO and GM-CSF/IL-3 treatment resulted in almost a doubling of 〈R(gi, gj)〉 at d3, which returned toward baseline at d6. The heat maps (Fig 2C) show that the increase of 〈R(gi, gj)〉 resulted from correlated (red) as well as anticorrelated gene pairs (blue) at d1 and, more pronounced, at d3. By contrast, genes were mostly uncorrelated in the progenitor state, consistent with the dominance of random fluctuations around the attractor state (explained in S2 Appendix).\n\nTogether, the cell–cell and gene–gene correlation computed from the single-cell gene expression level data matrix X(t) indeed gave rise to a temporal course of the index IC that increased toward (and culminates around) d3 after induction of both fate commitments, as predicted by theory if the cell population approaches a critical transition. The maximum of IC at d3 coincided roughly with the beginning of lineage separation in state space (Fig 1B). The decrease after d3 is plausible if one considers that cells enter a new attractor hereafter. However, this decrease is not strictly predicted by the theory because the assumption of ergodicity is not necessarily met if cells in distinct attractors are considered (S2 Appendix, B.2).\n\nRobustness of the Index IC\n\nWe next analyzed published single-cell gene expression data to further examine the robustness of index IC. Due to the intrinsic structure of the formula for IC, which is the ratio of the result of applying the same operation (averaging of all Pearson correlation coefficients) to a data matrix and to its transpose, it is expected that significant deviations of the value of IC from 1 in random data is extremely improbable, as bootstrap analysis of our data confirms (p &lt; 10−10; see S2 Appendix, B.1).\n\nWe first examined whether the increase of IC precedes discontinuous cell phenotype transitions in other systems. Few studies monitor a cell developmental process at multiple time points prior to the key phenotype transition event, but one publicly available dataset [34] used single-cell RNA-seq for whole transcriptome profiling of the differentiation of bipotent lung epithelium progenitor cells into the AT1 and the AT2 subtypes during embryonic development and appeared to be suited for our purpose. The fate commitment to AT2 cells takes place between E16.5 and E18.5. Computing IC for all reported transcripts at the various time points showed that IC indeed increased significantly between E16.5 and E18.5, which was indeed due to concomitant decrease of cell–cell correlation and increase of gene–gene correlation (S3 Appendix, C.1).\n\nBecause, in this case, transcriptome-wide data was available, we next asked whether the number m of genes analyzed could affect IC. Note that IC is derived under the assumption that the genes defining the cell state vector are members of the dynamical system (the core GRN) that drives or is affected by the critical transition at study, and that only the change of IC but not its absolute value has a biological meaning. Thus, we examined a situation similar to the problem in reference [21], when the core set of genes is not known a priori. What can be expected when a transcriptome-wide gene set is considered? Because the majority of genes in the transcriptome are not members of the relevant core GRN, one possibility is that including a larger number of genes for computing IC would decrease the sensitivity of IC. On the other hand, because the expression behavior of all genes in the transcriptome are already largely correlated overall, this could, due to increased possibility of the range restriction effect (S2 Appendix, B.2) [35], boost the changes in 〈R(gi, gj)〉 and increase sensitivity of IC when more genes are considered. We thus compared randomly selected subsets of 2,000, 200, and 20 genes in the lung cell differentiation data for computing IC and performed bootstrap analysis to determine the significance of change of IC. As shown in the Supporting Information (S3 Appendix, C.1), in all cases, IC increased significantly toward the point of fate commitment (and also decreased afterwards as cells terminally differentiated to virtually the same extent for all three cases); however, the error was smaller when the number of genes considered was larger. Thus, the fact that, in our data from the EML cells, we see a drastic and significant increase of IC by more than two-fold (Fig 2B) suggests that considering a small number of genes as we did here—entailed by the use of the more sensitive qPCR—sets the bar higher for statistical significance.\n\nTo test a case in which the range restriction effect does not hold because of large cell–cell variability (minimal baseline cell-cell correlation), we analyzed the single-cell transcriptome data of the most heterogeneous natural cell population we could find: glioblastoma cells [36]. Random sampling of increasingly larger sets of genes to compute IC indeed showed that, with increasing number of genes considered, the average cell–cell correlation 〈R(Sk, Sl)〉 decreased—the opposite of the above cases. This elevated the absolute value of IC as well as its statistical fluctuations. Thus, in case of low inherent cell–cell correlation, increasing the number of (randomly chosen) genes increases noise. However, even with 2,000 genes used and higher variance of IC, a change of IC by two-fold as we observe (Fig 2B) would still have been significant at p &lt; 0.01 (S3 Appendix, C.2).\n\nIn summary, IC is robust to varying the number of genes m used for its computation and for a wide range of preexisting intrinsic correlation between the cells. But sensitivity is higher in less heterogeneous cell populations (as are cell lines) and is increased by the use of a selected set of genes known to participate in the phenotype transition.\n\nAn Alternative Projection of Differentiation Trajectory Also Shows Evidence of Critical Transition\n\nTo exclude the possibility that the observed pattern of gene expression changes indicating a critical transition is an idiosyncrasy linked to monitoring the exit from the progenitor attractor along the particular state space direction of decreasing Sca1 expression, we also monitored and dissected differentiation along the axis of the increase of differentiation marker CD11b, a reliable indicator of myeloid differentiation (Fig 3A). Following GM-CSF/IL-3 treatment, first CD11b surface expression increased and then Sca1 decreased; that is, the cells moved from the CD11bLOW/Sca1HIGH to the CD11bHIGH/Sca1LOW state. We observed that at d3, the time around which maximal destabilization was expected, the entire cell population split into three subpopulations with respect to CD11b: Sca1HIGH/CD11bLOW (termed α), Sca1HIGH/CD11bHIGH (β), and, unexpectedly, Sca1LOW/CD11bVERY-LOW (γ) (Fig 3A). Single-cell transcript analysis suggests that the α-subpopulation corresponds to the destabilized but not yet fully committed cells because it displays the highest cell–cell diversity and high correlation of the gene vectors (Fig 3B, S5 Fig). The cells of subpopulation β were most advanced toward the myeloid lineage (high expression of Gfi1, CEBPα and cJun transcripts), consistent with the high CD11b expression, whereas cells of subpopulation γ correspond to rebellious cells that moved in the opposite direction from that intended by the treatment with GM-CSF/IL-3 (see below) and, thus, displayed erythroid gene expression patterns, including a large number of EpoR positive cells (S5A–S5D Fig). The index IC is drastically increased in all three cell populations at d3 (Fig 3B, inset), indicating a destabilization of the progenitor attractor. Because IC was computed separately for each subpopulation, this also suggests that its increase was not driven by the increase in gene–gene correlation as a trivial consequence of separation into distinct cell types.\n\nAt d6, the γ population disappears (Fig 3A), consistent with the rebellious cells in the PCA analysis of Fig 1B. However, addition of EPO to sorted subpopulations in growth factor–free cultures rescued the γ cells (Fig 3C) and, to a lesser extent, the α cells, but not the myeloid committed β cells. This finding not only confirms that the γ cells have aberrantly moved toward the erythroid lineage despite instruction for commitment to the myeloid lineage but also corroborates the notion of cell selection in fate control in which cytokines act as growth factors to determine lineage by providing the survival and mitogenic signals to the early committed cells that express the cognate receptor, in this case the EpoR [37–41].\n\nCritical Slowing Down of Relaxation of Outlier Subpopulations\n\nWe next examined a dynamical signature (early warning signal) of an approach to a critical transition used in low-dimensional systems: the slowing down of relaxation back to the original attractor states due to reduced attracting force [13, 41]. Here, critical slowing down was exposed by measuring the relaxation of sorted outlier cells, which are (transiently) in an extreme state with respect to projection into just one dimension, that of Sca1 [4]. We thus isolated the Sca1LOW tail of populations either treated for 1 d with GM-CSF/IL3 to destabilize the progenitor state, or in untreated populations. As previously shown, the Sca1LOW fraction re-establishes the parental distribution within 5 to 6 d [4]. By contrast, cells exposed to GM-CSF/IL-3 for just 1 d (which had not yet visibly altered Sca1 expression) required at least 9 d to reconstitute the parental Sca1 expression distribution (Fig 4). Although there could be many reasons for the impaired relaxation, including any nonspecific, nonphysiological perturbation of the progenitor state by the cytokines, these reasons may themselves be seen as a manifestation of attractor destabilization, and this finding is at least phenomenologically in line with a critical slowing down.\n\nRebellious Cells as Manifestation of Noise at Bifurcation\n\nIntriguingly, in both projections of monitoring differentiation along the axis of decreasing Sca1 (Fig 1B) as well as increasing CD11b (Fig 3A, the γ-cells), at d3 in both cases some cells consistently went in the “wrong” direction, opposite to the instruction by the respective cytokines (i.e., some EPO-treated cells were associated with the myeloid cell cluster and vice versa). Consistent with previous observations [4], the lineage of rebellious cells mirrored their Sca1 expression levels in the untreated population: EPO-treated cells moving toward the myeloid fate at d3 stemmed from the Sca1HIGH fraction in the progenitor population, whereas GM-CSF/IL3-treated cells fated toward the erythroid cells originated in the Sca1LOW fraction (S6 Fig). This suggests that the priming of cells in the progenitor population toward the erythroid or myeloid fate (as reflected in the Sca1 surface expression [4]), respectively, predisposes the cells to react in a rebellious way if the differentiation signal is opposed to their priming. This is consistent with an initially more or less symmetrical destabilization of the progenitor attractor state, such that wrongly primed cells are pushed toward the opposite lineage as the basin of attraction flattens and vanishes. Note that the rebellious cells disappeared at d6, possibly by transdifferentiating to the correct lineage or by dying out (if they are not rescued by providing the commensurate growth factor; Fig 3C). The existence of rebellious cells may correspond to the observation of mixed colonies in early colony assays for hematopoietic differentiation [8,42,43].\n\nThe repeated observation of rebellious cells is consistent with a bifurcation at which two new attractors become accessible, representing the dichotomy between the two sister lineages [18]. The destabilization of the progenitor attractor, unlike in the canonical saddle-node bifurcation [11], opens up a choice of two attractors, and despite a bias toward either one imposed by the lineage-determining growth factors, this still allows cells to spill into the “wrong” attractor if molecular noise overcomes the instructive bias toward the intended lineage. Thus, the existence of rebellious cells is also a signature of a critical transition.\n\nTo show that this polarized behavior is not an artifact of projection in one state space dimension (in this case, with respect to Sca1 or CD11b surface expression) but holds in the high-dimensional state space, we measured the transcriptomes of the subpopulations that have either responded to the growth factor or appeared to have not responded, at least with respect to change in Sca1 expression (Fig 5). As shown earlier (Fig 1), all three treatments, with either cytokines as well as combined, triggered a split of the population into two distinct subpopulations with respect to the progenitor marker Sca1 (bimodal distribution at d3, Fig 5A).\n\nIntriguingly, cells from the Sca1HIGH subpopulation that appeared to have not responded after 3 d in EPO because Sca1 stayed high (fraction #3 or H-Sca1 in Fig 5A) had a transcriptome that resembled that of the cells that had responded to GM-CSF/IL-3 treatment and had down-regulated Sca1 (fraction #8 or L-Sca1 in Fig 5A). Conversely, Sca1HIGH cells that had apparently not responded yet at d3 to GM-CSF/IL-3 (fraction #9 in Fig 5A) displayed a more pronounced change of the transcriptome that was remarkably similar to that of Sca1LOW cells (fraction #2) that had responded to EPO (for quantitative analysis of transcriptome similarities, see S2 Table). Extraction of those 17 genes in the microarray that were used in the single-cell qPCR analysis and hierarchical cluster analysis with these genes (Fig 5B) recapitulated these relationships, confirming that this set of genes represented the genome-wide high-dimensional dynamics well. In the combined treatment cells exhibited a transcriptome behavior similar to that of the nominally myeloid fated (i.e. GM-CSF/IL-3 treated) cells, in agreement with the single-cell transcript analysis (Fig 1).\n\nThus, transcriptome measurements of subpopulations that appear to have not responded to the differentiation signal with respect to downregulating the progenitor state marker suggest that they actually had responded but by altering gene expression in the non-observed state space dimensions, underscoring the importance of considering high-dimensional dynamics. The intriguing crosswise similarity of the transcriptome changes in the non-responders in one treatment to that of the responders in the other treatment strongly supports the model of a constrained dynamics with a finite number (here: two) of fate options. These are embodied by attractor states that establish the predestined developmental potentials, and they become accessible once the progenitor state is destabilized. The aberrant but highly defined behavior of rebellious cells exposes the poised instability and a stochastic, non-instructive component in fate determination.\n\nWe suspect that the rebellious cells represent those cells that, following the flattening of the progenitor attractor initiated by the external differentiation signal, erroneously enter the non-intended attractor because the stochastic gene expression fluctuations may, in some cells, overcome the instructive signal that biases the destabilization toward a specific lineage attractor. Nevertheless, the rebellious cells, being in the “wrong” fate, should eventually die because the lack of survival signals provided by the presence of the respective growth factor, as their disappearance in the measurement in Fig 1 implies. The rescue of the rebellious cells by the opposite cytokines confirms this model (Fig 3C).\n\nThus, instruction (extrinsic determination) and selection (driven by intrinsic stochasticity of responsiveness) synergize in fate control in a two-step scheme: cells must both be instructed and be selected for by the differentiation signal in order to adopt a particular phenotype [38–40]. This two-step process increases the fidelity of fate determination in the tissue. The attractor destabilization concept unites these two mechanisms of lineage commitment that has historically been opposed to each other but logically are not mutually exclusive [37,42,45].\n\nDiscussion\n\nHere we present a novel use of single-cell gene expression analysis that is phenomenological but informed by dynamical systems theory to make predictions (Fig 6). We show that exit from the multipotent progenitor state and commitment to a particular cell lineage exhibit signatures of a critical state transition that can be exposed by single-cell resolution gene expression analysis of a cell population undergoing cell fate commitment. This phenomenological approach does not require detailed modelling of the dynamics of the underlying gene regulatory pathways and a definition of a bifurcation parameter, which is currently not realistic given our insufficient knowledge of the GRN architecture. The key formal assumption is only that the GRN state change implementing the cell fate decision and commitment is due to a monotonical gradual alteration of the value of an (unidentified) bifurcation parameter that drives the change of the attractor landscape through a bifurcation (without specifying which type). Its chief consequence, the destabilization of a high-dimensional attractor state, can be observed. To do so, we treat the cell population as a statistical ensemble that (ergodically) explores the structure of a high-dimensional gene expression state space. The assessment of the latter directly confirmed that the notion of a critical state transition and associated early warning signals also extends to high-dimensional dynamics, as recently suggested [20,22]. Single-cell resolution analysis of a statistical ensemble at discrete time points makes up for the technical challenge of measuring the temporal fluctuations in cells, and the phenomenological but formal framework of critical transitions obviates the need for explicit modeling of the stochastic dynamics of gene regulatory circuits.\n\nWe show that high-dimensional critical dynamics of mammalian GRN can be captured by measuring the transcript levels of a set of 17 genes in individual cells at multiple time points t and by computing from such data the index IC(t), a quantity derived from the theory of non-linear dynamical systems that measures concomitant changes in cell–cell diversity and gene–gene coordination. Ideally, the genes considered for computing IC will encompass those that undergo coordinated changes during the critical transition, as dictated by the GRN that drives the critical transition. However, we show that 20 randomly selected genes from the transcriptome may also suffice, likely because of the basal genome-wide coordination of gene expression.\n\nIC is particularly useful for single-cell resolution snapshots of molecular profiles provided by burgeoning RNA-seq and CyTOF technologies and taken in statistical ensembles of cells (i.e. cell populations) at multiple time points during a biological time course. IC captures the information immanent in both the m gene vectors (the expression level of a gene across a large number n of individual cells) and the n cell vectors. Thus, IC does not require time-continuous monitoring of fluctuations as in many studies of critical state transitions because the information needed is in the high dimensionality (m) and in the statistical ensemble (n). Although the decrease of cell–cell correlation (denominator of IC) as a sign of attractor destabilization is intuitively obvious, IC is not an ad hoc statistical measure that identifies patterns in the data but is grounded in first principles of non-linear dynamical systems [46], as is particularly evident in the numerator, the gene–gene correlation. Conceptually, it is possible to speculate on a correspondence between the increase of gene–gene correlation to the appearance of long-range correlations of state variables in time (autocorrelation) and/or space used in the classical phenomenological analyses of critical state transitions [11] or of stressed populations [31], although such an equivalence has yet to be formally shown. A recent study also examined the approach to the bifurcation as a critical transition and its phenomenological manifestation in the presence of stochastic fluctuations, albeit in a continuous two-dimensional system representing a version of the canonical toggle switch with two mutually suppressing genes. The authors found that not only the cell diversity increases but also the anticorrelation of the two genes [20].\n\nOn the biology of cell fate commitment, we show that bifurcation dynamics and single-cell expression analysis naturally integrate the two opposing classical models of cell fate determination [38]: instruction by extrinsic factors that explicitly regulate the gene expression change in each cell so as they adopt a particular cell fate [42] and selection of cells that have entered an intrinsically predestined gene expression state (attractor) [37] by promoting their survival and proliferation. Both models are supported by our observations. The deterministic bias toward a prospective lineage in the destabilization of the progenitor state, as manifest in the early changes of the transcriptome (Fig 5A), confirms that instruction plays a role in fate determination. Conversely, the survival of the rebellious cells when the appropriate growth factors are later provided (to promote the non-intended fate) exposes a role for selection in cell lineage determination (Fig 3C).\n\nIn the case of selection, the promotion of one differentiation fate over the other is straightforward. But how does instruction steer a cell toward the desired state if leaving the multipotent state is driven by attractor destabilization? What causes the asymmetry of outcome that ensures that cells in the desired lineage dominate over the rebellious cells? The term “biased destabilization” used herein is more than a metaphoric explanation. It is grounded in the underlying bifurcation dynamics and could be elaborated in formal ways if one were able to explicitly model the dynamics of the relevant gene circuit for which many generic theoretical models have been proposed [8,15–20]. In the simplest case, binary lineage branching has often been modeled as a symmetrical supracritical pitchfork bifurcation [47]; here, the instructive signal could alter the values of other parameters in addition to the bifurcation parameter, such that one of the two post-bifurcation stable steady states (depending on the signal) is more stable than the other. In an alternative class of models, the bifurcation is inherently asymmetric, e.g., modelled as an imperfect pitchfork bifurcation [48]. Such models are more realistic because these nonsymmetrical bifurcations are structurally robust. Here, one of the two post-bifurcation stable states is detached from the destabilizing progenitor attractor state and, thus, is less accessible (requiring stronger gene expression noise) than the other, which can be directly accessed from the vanishing progenitor attractor, as depicted in landscape diagrams, as in Fig 6 and references [11–13]. The instructive signal could introduce the imperfection, such that either one of the new attractors becomes separated. Future detailed analysis using measurements of single cell states at much higher time-resolution could address these questions and distinguish between these possibilities.\n\nIn this study, we did not consider cell-to-cell communication mediated by local and soluble signals, which can modulate the internal GRN dynamics and, hence, affect phenotype transitions. This is an important aspect because the nonlinear, high-dimensional dynamics of cell states driven by a GRN poises cell populations at metastable states, making them akin to an excitable medium that, upon external perturbation, can respond in nonintuitive ways, as most lucidly epitomized by the rebellious cells. This response introduces cell population heterogeneity, underscoring the importance of cell population dynamics in which subpopulations coexist and shift their relative abundances in many ways that are affected by cell–cell communication between cells of distinct types. Indeed, a transition from cell type A to cell type B often does not follow first-order kinetics, suggesting non-cell autonomous effects (S.H., unpublished observation). For instance, cells that have reached an attractor state may secrete signals that can either promote or suppress the transition into it. A cell–cell interaction network would add an additional layer of dynamics to that of the intracellular GRN. The resulting (multiscale) cell population dynamics would be manifest as an accentuated modulation of the attractor landscape (Fig 6) but could still be captured using the phenomenological framework of critical transitions because attractor destabilization preceding the phenotype switch does not depend on the specific (physical) implementation of the bifurcation.\n\nAs single-cell resolution molecular profiling of cell states become routine, it will be important to analyze this new type of data, embodied by the matrix X(t), in a fashion that is hypothesis-driven or is informed by the underlying first principles of dynamical systems (Fig 6), as opposed to solely using the current palette of ad hoc computational data analytics tools to find cell clusters and reduce dimensionality [46]. Although still phenomenological, invoking concepts of critical transitions provide a formal link to the fundamental principles.\n\nIt remains to be seen whether critical transitions can be as readily detected in other cell systems as in the few examples examined in this study. Moreover, the significance for diseases and response to drugs of cell population dynamics with instabilities and critical behaviors could be further elucidated as single-cell analysis becomes commonplace and we move beyond descriptive data analysis. The notion of critical behaviors could be of practical utility for predicting major shifts in cell populations and tissues relevant in development and disease using data from single-resolution measurements at multiple discrete time points.\n\nNOTE ADDED IN PROOF: During the submission of this manuscript we became aware of the work of Richard, et al., 2016 (doi: 10.1371/journal.pbio.1002585) which was motivated by a different conceptual framework and used different analysis methods but arrived at a similar conclusion.\n\nMaterials and Methods\n\nCulture and Differentiation of EML Cells\n\nBlood progenitor EML cells (ATCC CRL-11691) were cultured and maintained as described previously [26]. Multipotent EML cell population was stimulated with either EPO (to differentiate into erythroid cells), GM-CSF/IL-3 and ATRA (to obtain myeloid cells), or a mixture of all cytokines for the “combined” treatment as previously reported [4,26]. Wright-Giemsa staining was performed with some modification following a reported protocol [27]. In brief, 60,000 cells in 250 μl of PBS + 1% FBS buffer were cytospun at 350 rpm for 5 min per slide and allowed to air dry for 10 min. Slides were subjected to five 1-second dips in methanol, followed by Wright-Giemsa staining solution (0.4% [w/v], Sigma). After a final rinse with water, slides were allowed to air dry for 30 min. Colored phase contrast images were obtained using a Zeiss Axiovert 200M microscope.\n\nFlow Cytometry and Fluorescence-Activated Cell Sorting (FACS)\n\nCell surface protein immunostaining and flow cytometry measurements were performed using established methods [4]. Briefly, the antibodies Sca1-PE (BD Pharmingen #553335), ckit-FITC (BD Pharmingen #553355), and CD11b-FITC (BD Pharmingen #557396) were used at 1:1,000 dilutions in ice-cold PBS containing 1% fetal calf serum with (flow cytometry) or without (FACS) 0.01% NaN3. Appropriate unstained and single-color controls were used for gate definition and compensation setup. Isotype control antibodies (BD Pharmingen #553988 for FITC and #553930 for PE isotype) were used to establish the background signal caused by nonspecific antibody binding. Propidium iodide (Roche #11348639001) staining was used to identify dead cells that were removed from analyses. Flow cytometry analysis was performed on a BD FACSCalibur cell cytometer with 10,000 viable events for each sample. Data were acquired using CellQuest Pro (BD) software and analyzed in FlowJo.\n\nFor FACS sorting, the Sca1 protein distribution was measured and the expression distribution was gated into three regions according to the Sca1 expression level as Sca1-Low, Mid, and High on day 0, 1, and 6 or four regions on day 3 after differentiation initiation (Fig 1A). Single cell sorting was conducted on a BD Biosciences FACSAria III in lysis buffer (see below). For myeloid differentiation, cells were stained with antibodies for both Sca1 and CD11b protein markers, and cell subpopulations were gated as illustrated in Fig 3A. For studies involving the dynamics of sorted subpopulations, antibodies were removed after sorting using brief incubation in a low-pH buffer [4].\n\nSingle-Cell Gene-Expression Analysis Using OpenArray qPCR\n\nSingle cells were directly sorted into 5.0 μl of lysis buffer (CellsDirect kit, Invitrogen) containing 4.25 μl Resuspension Buffer and 0.25 μl Lysis Enhancer using a FACSAria III (BD Biosciences). 0.5 μl RNaseOut (Invitrogen) was added to the lysis solution to protect the RNA from degradation. To ensure that liquid droplets containing single cells were deposited at the center of the well and not at the wall, the position was checked on the plastic film covering the PCR plate. To reduce the possibility of cells sticking to the wall of the PCR well plate, we used low-binding PCR plates (Axygen, #6509). As control sample, a small population of 100 cells were sorted into a single well for qPCR analysis. To test for contamination of sorted cells with mRNA from lysed dead cells, 5.5 μl liquid from the FACS instrument was collected and analyzed. After sorting, the samples were heated to 75°C for 10 min to accelerate the lysis process, and samples were stored at -80°C. From these single-cell lysate samples, cDNA was directly synthesized as described previously [26]. The obtained cDNA was preamplified by 18 cycles [26] and subsequently diluted with Tris-EDTA buffer at a ratio of 1:10, resulting in templates for the real-time PCR analysis. This protocol led to fewer than 30 quantification cycles (Cq) during the single-cell qPCR analysis on an OpenArray system (Life Technologies). On this system, each qPCR plate consists of 12×4 subarrays and each subarray contains 8×8 reaction chambers of 33 nl volume (S7A Fig) [28]. Each sample was divided into a subarray with 64 reaction chambers prior to qPCR quantification. No-template (water) control was also run on each plate to check for nonspecific products and/or presence of contaminants in the master mix. Following the amplification, the corresponding curves and Cq values were processed using the OpenArray Real-Time qPCR Analysis software (version 1.0.4) with a quantification threshold of 100(+/-5). Specific PCR primers were preimmobilized in the chambers (S7B Fig) and released in the first cycle by heat. For each subarray, 2 μl of target sample was loaded into each well of a 384-well plate (Applied Biosystems); subsequently, 3 μl of the master mix reaction consisting of TaqMan OpenArray Real-time PCR Master Mix (Applied Biosystems) was added to each well. Target and master mix were combined and centrifuged, and the 384-well plate was processed in the OpenArray AccuFill system (Applied Biosystems). During processing, 2.1 μl of the reaction solution was transferred automatically from each well into the corresponding subarrays of a qPCR plate, where the reaction solution retains into the reaction wells due to the differential hydrophilic–hydrophobic coating between wells and surface of the qPCR array [28]. The qPCR step was performed using thermocycling conditions of 50°C for 2 min, 95°C for 10 min, 40 cycles of 95°C for 15 sec, and 60°C for 1 min.\n\nTesting Taman qPCR Assays\n\nWe used off-the-shelf primers designed by Applied BioSystems (Life Technologies) for the analysis. The primers are usually designed to span exon–exon junction to target multiple splice variants of one transcript and to target only and specifically the gene of interest, avoiding amplification of genomic DNA. S3 Table lists all genes of interest, the inventoried TaqMan assay IDs (Applied Biosystems), and further relevant information when the manufacturer does not provide primer and probe sequences. To evaluate qPCR assay performance, calibration (standard) curves were generated by performing qPCR on a serial dilution of a prepared template. Each of these dilutions was dispensed into two subarrays of OpenArray plate, leading to six technical qPCR replicates for each single cell sample. To minimize the effect of sampling errors on quantification precision, only sample/assay combinations with at least three quantifiable replicates were considered for preparing the standard curves. The GAPDH assay was not preimmobilized on OpenArray plate but was independently tested on BioRad qPCR platform.\n\nAnalysis of Single-Cell Gene Expression Data\n\nData analysis is described in more details in S1 Appendix. Single-cell expression data were initially analysed with OpenArray qPCR analysis software. For quality control, amplification curves were quality filtered and Ct thresholds were set for each assay with the same thresholds used across all experiments and cell populations. Data were subsequently exported to Excel as csv files. All of Cq values are available in S1 Data. Samples not expressing any gene were excluded from the analysis. Experimentally determined LODs were used as cutoff Cqs (S3 Table). Each assay was performed in triplicates, and the median of the triplicates was used for subsequent analysis. After this preprocessing, ΔCq was calculated as previously described [29]. Higher level of analysis such as correlation, clustering, and PCA was performed on log2-transfromed expression data.\n\nGene Expression Profiling with Microarrays and Data Analysis\n\nMicroarray analyses were performed by the Vancouver Prostate Centre. EML progenitor cell population was stimulated with EPO alone, IL-3/GM-CSF alone, or a combination of all cytokines. On d3 and d6 after stimulation with different cytokines, the main “peaks” in the Sca1 distribution were gated and cell subpopulations were sorted using FACSAria III. Fig 5A illustrates the experimental design for the microarray experiments. Total RNA was extracted from 1×106 of sorted subpopulations using mirVana miRNA Isolation Kit (Ambion) following the manufacturer’s instructions. Genomic DNA was removed from the isolated and purified RNA using DNase I. Total RNA quality was assessed with the Agilent 2100 Bioanalyzer prior to microarray analysis. Samples with a RIN value equal to or greater than 8.0 were deemed acceptable for microarray analysis. Samples were prepared following Agilent’s One-Color Microarray-Based Gene Expression Analysis Low Input Quick Amp Labeling v6.0. An input of 100 ng of total RNA was used to generate Cyanine-3 labeled cRNA. Samples were hybridized on Agilent SurePrint G3 Mouse GE 8x60K Microarray (Design ID 028005). Arrays were scanned with the Agilent DNA Microarray Scanner at a 3 μm scan resolution, and data was processed with Agilent Feature Extraction 11.0.1.1. To filter out genes that were not expressed above the background noise, a raw intensity cutoff value of 25 was applied because the correlation between the technical replicates decreases for higher levels. Green processed signal was quantile-normalized using the “normalize.quantiles” function in R that takes care of inter-chip variability. To filter out genes which did not change between the samples, the distribution of each gene across all samples was analyzed. Therefore, the standard deviation (STD) distribution was calculated and only genes with STD &gt; 10% were selected. As a result, 6,297 genes passed the criteria and were selected as the top 10% of genes among the samples. Self-organising maps (SOM) of the top 10% of most varied genes (6,297 genes) were generated using the Gene Expression Dynamics Inspector program (GEDI) [44]. Cluster analysis was performed using the “clustergram” function in Matlab R2012a Bioinformatics toolbox using hierarchical clustering with Euclidean distance metric and average linkage to generate the dendrogram. Input data was log2-tranformed values of normalized fluorescent intensity signals for genes of interest extracted from the samples and plotted as a heatmap. Data represented the average of n = 2 independent biological replicates. The normalized fluorescent intensity values of 17 genes of interest in the curated network were extracted from each sample.\n\nSupporting Information"
}